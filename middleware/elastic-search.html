<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://topjf.github.io/middleware/elastic-search.html"><meta property="og:site_name" content="topjf"><meta property="og:title" content="ElasticSearch å…¨æ–‡æ£€ç´¢"><meta property="og:description" content="1. ElasticSearchæ¦‚å¿µ 1.1 ESä»‹ç» åº”ç”¨ç¨‹åºæœç´¢	ç½‘ç«™æœç´¢	ä¼ä¸šæœç´¢	æ—¥å¿—å¤„ç†å’Œåˆ†æ åŸºç¡€è®¾æ–½æŒ‡æ ‡å’Œå®¹å™¨ç›‘æµ‹	åº”ç”¨ç¨‹åºæ€§èƒ½ç›‘æµ‹ åœ°ç†ç©ºé—´æ•°æ®åˆ†æå’Œå¯è§†åŒ–	å®‰å…¨åˆ†æ	ä¸šåŠ¡åˆ†æ å®˜æ–¹æ–‡æ¡£ : https://www.elastic.co/guide/en/elasticsearch/reference/current/index.htm..."><meta property="og:type" content="article"><meta property="og:image" content="https://topjf.github.io/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2022-12-16T06:02:03.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="ElasticSearch å…¨æ–‡æ£€ç´¢"><meta property="article:tag" content="ElasticSearch"><meta property="article:published_time" content="2020-05-15T00:00:00.000Z"><meta property="article:modified_time" content="2022-12-16T06:02:03.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"ElasticSearch å…¨æ–‡æ£€ç´¢","image":["https://topjf.github.io/"],"datePublished":"2020-05-15T00:00:00.000Z","dateModified":"2022-12-16T06:02:03.000Z","author":[]}</script><script type="text/javascript" src="/script/demo.js"></script><link rel="stylesheet" href="/iconfont/iconfont.css"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>ElasticSearch å…¨æ–‡æ£€ç´¢ | topjf</title><meta name="description" content="1. ElasticSearchæ¦‚å¿µ 1.1 ESä»‹ç» åº”ç”¨ç¨‹åºæœç´¢	ç½‘ç«™æœç´¢	ä¼ä¸šæœç´¢	æ—¥å¿—å¤„ç†å’Œåˆ†æ åŸºç¡€è®¾æ–½æŒ‡æ ‡å’Œå®¹å™¨ç›‘æµ‹	åº”ç”¨ç¨‹åºæ€§èƒ½ç›‘æµ‹ åœ°ç†ç©ºé—´æ•°æ®åˆ†æå’Œå¯è§†åŒ–	å®‰å…¨åˆ†æ	ä¸šåŠ¡åˆ†æ å®˜æ–¹æ–‡æ¡£ : https://www.elastic.co/guide/en/elasticsearch/reference/current/index.htm...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-41a36a5c.css" as="style"><link rel="stylesheet" href="/assets/style-41a36a5c.css">
    <link rel="modulepreload" href="/assets/app-30d3d221.js"><link rel="modulepreload" href="/assets/framework-ed4f969a.js"><link rel="modulepreload" href="/assets/elastic-search.html-1f0faae5.js"><link rel="modulepreload" href="/assets/elastic-search.html-6feeb709.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="topjf"><!----><span class="site-name hide-in-pad">topjf</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="é¦–é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/home.html" class="nav-link" aria-label="å¿«é€Ÿå¯¼èˆª"><span class="font-icon icon iconfont icon-arrow" style=""></span>å¿«é€Ÿå¯¼èˆª<!----></a></div><div class="nav-item hide-in-mobile"><a href="/all/all.html" class="nav-link" aria-label="é¢è¯•å®å…¸"><span class="font-icon icon iconfont icon-overflow" style=""></span>é¢è¯•å®å…¸<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ä¸ªäººä¸­å¿ƒ"><span class="title"><span class="font-icon icon iconfont icon-anonymous" style=""></span>ä¸ªäººä¸­å¿ƒ</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article" class="nav-link" aria-label="æ–‡ç« "><span class="font-icon icon iconfont icon-note" style=""></span>æ–‡ç« <!----></a></li><li class="dropdown-item"><a href="/category" class="nav-link" aria-label="åˆ†ç±»"><span class="font-icon icon iconfont icon-categoryselected" style=""></span>åˆ†ç±»<!----></a></li><li class="dropdown-item"><a href="/tag" class="nav-link" aria-label="æ ‡ç­¾"><span class="font-icon icon iconfont icon-list" style=""></span>æ ‡ç­¾<!----></a></li><li class="dropdown-item"><a href="/encrypted" class="nav-link" aria-label="åŠ å¯†æ–‡ç« "><span class="font-icon icon iconfont icon-command" style=""></span>åŠ å¯†æ–‡ç« <!----></a></li><li class="dropdown-item"><a href="/star" class="nav-link" aria-label="æ”¶è—æ–‡ç« "><span class="font-icon icon iconfont icon-like" style=""></span>æ”¶è—æ–‡ç« <!----></a></li><li class="dropdown-item"><a href="/timeline" class="nav-link" aria-label="æ—¶é—´çº¿"><span class="font-icon icon iconfont icon-time" style=""></span>æ—¶é—´çº¿<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç½‘ç«™ç›¸å…³"><span class="title"><span class="font-icon icon iconfont icon-info" style=""></span>ç½‘ç«™ç›¸å…³</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/about/about-this.html" class="nav-link" aria-label="å…³äºæœ¬ç«™"><span class="font-icon icon iconfont icon-people" style=""></span>å…³äºæœ¬ç«™<!----></a></li><li class="dropdown-item"><a href="/history/history.html" class="nav-link" aria-label="ç½‘ç«™å†å²"><span class="font-icon icon iconfont icon-time" style=""></span>ç½‘ç«™å†å²<!----></a></li><li class="dropdown-item"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress Theme Hope æ–‡æ¡£" class="nav-link"><span class="font-icon icon iconfont icon-creative" style=""></span>VuePress Theme Hope æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/topjf/topjf" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-tool" style=""></span><span class="title">æ¶ˆæ¯ä¸­é—´ä»¶</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/middleware/mq/mq-active.html" class="nav-link sidebar-link sidebar-page" aria-label="ActiveMQ"><span class="font-icon icon iconfont icon-edit" style=""></span>ActiveMQ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/middleware/mq/kafka.html" class="nav-link sidebar-link sidebar-page" aria-label="Kafka"><span class="font-icon icon iconfont icon-edit" style=""></span>Kafka<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/middleware/mq/mq.html" class="nav-link sidebar-link sidebar-page" aria-label="MQä¸­é—´ä»¶"><span class="font-icon icon iconfont icon-edit" style=""></span>MQä¸­é—´ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/middleware/mq/mq-rabbit.html" class="nav-link sidebar-link sidebar-page" aria-label="RabbitMQ"><span class="font-icon icon iconfont icon-edit" style=""></span>RabbitMQ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/middleware/mq/mq-rocket.html" class="nav-link sidebar-link sidebar-page" aria-label="RocketMQ"><span class="font-icon icon iconfont icon-edit" style=""></span>RocketMQ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><!--[--><a href="/middleware/nginx.html" class="nav-link sidebar-link sidebar-page" aria-label="Nginx"><span class="font-icon icon iconfont icon-nginx" style=""></span>Nginx<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-redis" style=""></span><span class="title">Redis</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/middleware/redis/redis.html" class="nav-link sidebar-link sidebar-page" aria-label="linuxå®‰è£…Redis"><span class="font-icon icon iconfont icon-redis" style=""></span>linuxå®‰è£…Redis<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/middleware/redis/RedisTemplate.html" class="nav-link sidebar-link sidebar-page" aria-label="é…ç½®Rediså·¥å…·ç±»"><span class="font-icon icon iconfont icon-redis" style=""></span>é…ç½®Rediså·¥å…·ç±»<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><!--[--><a aria-current="page" href="/middleware/elastic-search.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ElasticSearch å…¨æ–‡æ£€ç´¢"><span class="font-icon icon iconfont icon-edit" style=""></span>ElasticSearch å…¨æ–‡æ£€ç´¢<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_1-elasticsearchæ¦‚å¿µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1. ElasticSearchæ¦‚å¿µ"><!---->1. ElasticSearchæ¦‚å¿µ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_1-1-esä»‹ç»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.1 ESä»‹ç»"><!---->1.1 ESä»‹ç»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_1-2-åŸºæœ¬æ¦‚å¿µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.2 åŸºæœ¬æ¦‚å¿µ"><!---->1.2 åŸºæœ¬æ¦‚å¿µ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_2-å®‰è£…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2 å®‰è£…"><!---->2 å®‰è£…<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#æŸ¥çœ‹-elasticsearch" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æŸ¥çœ‹ elasticsearch"><!---->æŸ¥çœ‹ elasticsearch<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#æŸ¥çœ‹-kibana" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æŸ¥çœ‹ kibana"><!---->æŸ¥çœ‹ kibana<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_3-ç´¢å¼•æ“ä½œ-indices" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3 ç´¢å¼•æ“ä½œï¼ˆindicesï¼‰"><!---->3 ç´¢å¼•æ“ä½œï¼ˆindicesï¼‰<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_3-1-æŸ¥è¯¢ç´¢å¼•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.1 æŸ¥è¯¢ç´¢å¼•"><!---->3.1 æŸ¥è¯¢ç´¢å¼•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_3-2-åˆ›å»ºç´¢å¼•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.2 åˆ›å»ºç´¢å¼•"><!---->3.2 åˆ›å»ºç´¢å¼•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_3-3-get-æŸ¥è¯¢æ–‡æ¡£-ä¹è§‚é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.3 get æŸ¥è¯¢æ–‡æ¡£&amp;ä¹è§‚é”"><!---->3.3 get æŸ¥è¯¢æ–‡æ¡£&amp;ä¹è§‚é”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_3-4-post-æ›´æ–°æ–‡æ¡£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.4 post æ›´æ–°æ–‡æ¡£"><!---->3.4 post æ›´æ–°æ–‡æ¡£<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_3-5-åˆ é™¤æ–‡æ¡£-ç´¢å¼•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.5 åˆ é™¤æ–‡æ¡£&amp;ç´¢å¼•"><!---->3.5 åˆ é™¤æ–‡æ¡£&amp;ç´¢å¼•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_3-6-post-bulkæ‰¹é‡å¯¼å…¥-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.6 post bulkæ‰¹é‡å¯¼å…¥ API"><!---->3.6 post bulkæ‰¹é‡å¯¼å…¥ API<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_4-æ˜ å°„é…ç½®-mapping" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4 æ˜ å°„é…ç½®ï¼ˆ_mappingï¼‰"><!---->4 æ˜ å°„é…ç½®ï¼ˆ_mappingï¼‰<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_4-1-put-åˆ›å»ºæ˜ å°„å­—æ®µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.1 PUT åˆ›å»ºæ˜ å°„å­—æ®µ"><!---->4.1 PUT åˆ›å»ºæ˜ å°„å­—æ®µ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_4-2-get-æŸ¥çœ‹æ˜ å°„å…³ç³»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.2 GET æŸ¥çœ‹æ˜ å°„å…³ç³»"><!---->4.2 GET æŸ¥çœ‹æ˜ å°„å…³ç³»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_4-3-put-æ·»åŠ ç´¢å¼•å­—æ®µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.3 PUT æ·»åŠ ç´¢å¼•å­—æ®µ"><!---->4.3 PUT æ·»åŠ ç´¢å¼•å­—æ®µ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_4-4-æ˜ å°„-put-æ•°æ®è¿ç§»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.4 æ˜ å°„ PUT æ•°æ®è¿ç§»"><!---->4.4 æ˜ å°„ PUT æ•°æ®è¿ç§»<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_5-æ–°å¢æ–‡æ¡£-document" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5 æ–°å¢æ–‡æ¡£ï¼ˆdocumentï¼‰"><!---->5 æ–°å¢æ–‡æ¡£ï¼ˆdocumentï¼‰<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_5-1-åŸºæœ¬ç©æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1 åŸºæœ¬ç©æ³•"><!---->5.1 åŸºæœ¬ç©æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_5-2-æ™ºèƒ½åˆ¤æ–­" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2 æ™ºèƒ½åˆ¤æ–­"><!---->5.2 æ™ºèƒ½åˆ¤æ–­<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_6-åˆ é™¤æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6 åˆ é™¤æ•°æ®"><!---->6 åˆ é™¤æ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_7-åˆ†è¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7 åˆ†è¯"><!---->7 åˆ†è¯<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_7-1-é»˜è®¤åˆ†è¯å™¨-å¯¹ä¸­æ–‡ä¸å‹å¥½" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.1 é»˜è®¤åˆ†è¯å™¨ï¼Œå¯¹ä¸­æ–‡ä¸å‹å¥½"><!---->7.1 é»˜è®¤åˆ†è¯å™¨ï¼Œå¯¹ä¸­æ–‡ä¸å‹å¥½<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_7-2-ik-åˆ†è¯å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.2 ik åˆ†è¯å™¨"><!---->7.2 ik åˆ†è¯å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_7-3-è‡ªå®šä¹‰åˆ†è¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.3 è‡ªå®šä¹‰åˆ†è¯"><!---->7.3 è‡ªå®šä¹‰åˆ†è¯<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-æŸ¥è¯¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8 æŸ¥è¯¢"><!---->8 æŸ¥è¯¢<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-1-2ç§æŸ¥è¯¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.1 2ç§æŸ¥è¯¢"><!---->8.1 2ç§æŸ¥è¯¢<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-2-æ•°æ®å‡†å¤‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.2 æ•°æ®å‡†å¤‡"><!---->8.2 æ•°æ®å‡†å¤‡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-3-åŒ¹é…æŸ¥è¯¢-match-match-all" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.3 åŒ¹é…æŸ¥è¯¢ï¼ˆmatch &amp;&amp; match_allï¼‰"><!---->8.3 åŒ¹é…æŸ¥è¯¢ï¼ˆmatch &amp;&amp; match_allï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-4-è¯æ¡æŸ¥è¯¢-ç²¾ç¡®å€¼åŒ¹é…-term" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.4 è¯æ¡æŸ¥è¯¢ï¼Œç²¾ç¡®å€¼åŒ¹é…ï¼ˆtermï¼‰"><!---->8.4 è¯æ¡æŸ¥è¯¢ï¼Œç²¾ç¡®å€¼åŒ¹é…ï¼ˆtermï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-5-èŒƒå›´æŸ¥è¯¢-range" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.5 èŒƒå›´æŸ¥è¯¢ï¼ˆrangeï¼‰"><!---->8.5 èŒƒå›´æŸ¥è¯¢ï¼ˆrangeï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-6-å¸ƒå°”ç»„åˆ-bool" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.6 å¸ƒå°”ç»„åˆï¼ˆbool)"><!---->8.6 å¸ƒå°”ç»„åˆï¼ˆbool)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-7-è¿‡æ»¤-filter" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.7 è¿‡æ»¤ï¼ˆfilterï¼‰"><!---->8.7 è¿‡æ»¤ï¼ˆfilterï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-8-æ’åº-sort" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.8 æ’åºï¼ˆsortï¼‰"><!---->8.8 æ’åºï¼ˆsortï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-9-åˆ†é¡µ-from-size" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.9 åˆ†é¡µï¼ˆfrom/sizeï¼‰"><!---->8.9 åˆ†é¡µï¼ˆfrom/sizeï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-10-é«˜äº®-highlight" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.10 é«˜äº®ï¼ˆhighlightï¼‰"><!---->8.10 é«˜äº®ï¼ˆhighlightï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_8-11-ç»“æœè¿‡æ»¤-source" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.11 ç»“æœè¿‡æ»¤ï¼ˆ_sourceï¼‰"><!---->8.11 ç»“æœè¿‡æ»¤ï¼ˆ_sourceï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_9-èšåˆ-aggregations" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9 èšåˆï¼ˆaggregationsï¼‰"><!---->9 èšåˆï¼ˆaggregationsï¼‰<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_9-1-åŸºæœ¬æ¦‚å¿µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.1 åŸºæœ¬æ¦‚å¿µ"><!---->9.1 åŸºæœ¬æ¦‚å¿µ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_9-2-èšåˆä¸ºæ¡¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.2 èšåˆä¸ºæ¡¶"><!---->9.2 èšåˆä¸ºæ¡¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_9-3-æ¡¶å†…åº¦é‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.3 æ¡¶å†…åº¦é‡"><!---->9.3 æ¡¶å†…åº¦é‡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_9-4-æ¡¶å†…åµŒå¥—æ¡¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.4 æ¡¶å†…åµŒå¥—æ¡¶"><!---->9.4 æ¡¶å†…åµŒå¥—æ¡¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-springdata-elasticsearch" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10 SpringData-Elasticsearch"><!---->10 SpringData-Elasticsearch<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-1-ä»‹ç»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.1 ä»‹ç»"><!---->10.1 ä»‹ç»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-2-åˆ›å»ºspringboot-é¡¹ç›®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.2 åˆ›å»ºspringboot é¡¹ç›®"><!---->10.2 åˆ›å»ºspringboot é¡¹ç›®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-3-banæµ‹è¯•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.3 banæµ‹è¯•"><!---->10.3 banæµ‹è¯•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-4-æµ‹è¯•ä¿å­˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.4 æµ‹è¯•ä¿å­˜"><!---->10.4 æµ‹è¯•ä¿å­˜<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-5-æµ‹è¯•æ£€ç´¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.5 æµ‹è¯•æ£€ç´¢"><!---->10.5 æµ‹è¯•æ£€ç´¢<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-6-åˆ›å»ºmodule" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.6 åˆ›å»ºmodule"><!---->10.6 åˆ›å»ºmodule<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-7-å®ä½“ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.7 å®ä½“ç±»"><!---->10.7 å®ä½“ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-8-åˆ›å»ºç´¢å¼•åŠæ˜ å°„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.8 åˆ›å»ºç´¢å¼•åŠæ˜ å°„"><!---->10.8 åˆ›å»ºç´¢å¼•åŠæ˜ å°„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-9-repositoryæ–‡æ¡£æ“ä½œ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.9 Repositoryæ–‡æ¡£æ“ä½œ"><!---->10.9 Repositoryæ–‡æ¡£æ“ä½œ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/middleware/elastic-search.html#_10-10-æŸ¥è¯¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.10 æŸ¥è¯¢"><!---->10.10 æŸ¥è¯¢<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-edit" style=""></span>ElasticSearch å…¨æ–‡æ£€ç´¢</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="/article" target="_blank" rel="noopener noreferrer">topjf</a></span><span property="author" content="topjf"></span></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category0 clickable" role="navigation">ElasticSearch</span><meta property="articleSection" content="ElasticSearch"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag0 clickable" role="navigation">ElasticSearch</span><meta property="keywords" content="ElasticSearch"></span><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2020-05-15T00:00:00.000Z"></span><!----><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 7905 å­—</span><meta property="wordCount" content="7905"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 26 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT26M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_1-elasticsearchæ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level2">1. ElasticSearchæ¦‚å¿µ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_1-1-esä»‹ç»" class="router-link-active router-link-exact-active toc-link level3">1.1 ESä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_1-2-åŸºæœ¬æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level3">1.2 åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_2-å®‰è£…" class="router-link-active router-link-exact-active toc-link level2">2 å®‰è£…</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#æŸ¥çœ‹-elasticsearch" class="router-link-active router-link-exact-active toc-link level3">æŸ¥çœ‹ elasticsearch</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#æŸ¥çœ‹-kibana" class="router-link-active router-link-exact-active toc-link level3">æŸ¥çœ‹ kibana</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_3-ç´¢å¼•æ“ä½œ-indices" class="router-link-active router-link-exact-active toc-link level2">3 ç´¢å¼•æ“ä½œï¼ˆindicesï¼‰</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_3-1-æŸ¥è¯¢ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level3">3.1 æŸ¥è¯¢ç´¢å¼•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_3-2-åˆ›å»ºç´¢å¼•" class="router-link-active router-link-exact-active toc-link level3">3.2 åˆ›å»ºç´¢å¼•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_3-3-get-æŸ¥è¯¢æ–‡æ¡£-ä¹è§‚é”" class="router-link-active router-link-exact-active toc-link level3">3.3 get æŸ¥è¯¢æ–‡æ¡£&amp;ä¹è§‚é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_3-4-post-æ›´æ–°æ–‡æ¡£" class="router-link-active router-link-exact-active toc-link level3">3.4 post æ›´æ–°æ–‡æ¡£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_3-5-åˆ é™¤æ–‡æ¡£-ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level3">3.5 åˆ é™¤æ–‡æ¡£&amp;ç´¢å¼•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_3-6-post-bulkæ‰¹é‡å¯¼å…¥-api" class="router-link-active router-link-exact-active toc-link level3">3.6 post bulkæ‰¹é‡å¯¼å…¥ API</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_4-æ˜ å°„é…ç½®-mapping" class="router-link-active router-link-exact-active toc-link level2">4 æ˜ å°„é…ç½®ï¼ˆ_mappingï¼‰</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_4-1-put-åˆ›å»ºæ˜ å°„å­—æ®µ" class="router-link-active router-link-exact-active toc-link level3">4.1 PUT åˆ›å»ºæ˜ å°„å­—æ®µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_4-2-get-æŸ¥çœ‹æ˜ å°„å…³ç³»" class="router-link-active router-link-exact-active toc-link level3">4.2 GET æŸ¥çœ‹æ˜ å°„å…³ç³»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_4-3-put-æ·»åŠ ç´¢å¼•å­—æ®µ" class="router-link-active router-link-exact-active toc-link level3">4.3 PUT æ·»åŠ ç´¢å¼•å­—æ®µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_4-4-æ˜ å°„-put-æ•°æ®è¿ç§»" class="router-link-active router-link-exact-active toc-link level3">4.4 æ˜ å°„ PUT æ•°æ®è¿ç§»</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_5-æ–°å¢æ–‡æ¡£-document" class="router-link-active router-link-exact-active toc-link level2">5 æ–°å¢æ–‡æ¡£ï¼ˆdocumentï¼‰</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_5-1-åŸºæœ¬ç©æ³•" class="router-link-active router-link-exact-active toc-link level3">5.1 åŸºæœ¬ç©æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_5-2-æ™ºèƒ½åˆ¤æ–­" class="router-link-active router-link-exact-active toc-link level3">5.2 æ™ºèƒ½åˆ¤æ–­</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_6-åˆ é™¤æ•°æ®" class="router-link-active router-link-exact-active toc-link level2">6 åˆ é™¤æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_7-åˆ†è¯" class="router-link-active router-link-exact-active toc-link level2">7 åˆ†è¯</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_7-1-é»˜è®¤åˆ†è¯å™¨-å¯¹ä¸­æ–‡ä¸å‹å¥½" class="router-link-active router-link-exact-active toc-link level3">7.1 é»˜è®¤åˆ†è¯å™¨ï¼Œå¯¹ä¸­æ–‡ä¸å‹å¥½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_7-2-ik-åˆ†è¯å™¨" class="router-link-active router-link-exact-active toc-link level3">7.2 ik åˆ†è¯å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_7-3-è‡ªå®šä¹‰åˆ†è¯" class="router-link-active router-link-exact-active toc-link level3">7.3 è‡ªå®šä¹‰åˆ†è¯</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level2">8 æŸ¥è¯¢</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-1-2ç§æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">8.1 2ç§æŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-2-æ•°æ®å‡†å¤‡" class="router-link-active router-link-exact-active toc-link level3">8.2 æ•°æ®å‡†å¤‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-3-åŒ¹é…æŸ¥è¯¢-match-match-all" class="router-link-active router-link-exact-active toc-link level3">8.3 åŒ¹é…æŸ¥è¯¢ï¼ˆmatch &amp;&amp; match_allï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-4-è¯æ¡æŸ¥è¯¢-ç²¾ç¡®å€¼åŒ¹é…-term" class="router-link-active router-link-exact-active toc-link level3">8.4 è¯æ¡æŸ¥è¯¢ï¼Œç²¾ç¡®å€¼åŒ¹é…ï¼ˆtermï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-5-èŒƒå›´æŸ¥è¯¢-range" class="router-link-active router-link-exact-active toc-link level3">8.5 èŒƒå›´æŸ¥è¯¢ï¼ˆrangeï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-6-å¸ƒå°”ç»„åˆ-bool" class="router-link-active router-link-exact-active toc-link level3">8.6 å¸ƒå°”ç»„åˆï¼ˆbool)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-7-è¿‡æ»¤-filter" class="router-link-active router-link-exact-active toc-link level3">8.7 è¿‡æ»¤ï¼ˆfilterï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-8-æ’åº-sort" class="router-link-active router-link-exact-active toc-link level3">8.8 æ’åºï¼ˆsortï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-9-åˆ†é¡µ-from-size" class="router-link-active router-link-exact-active toc-link level3">8.9 åˆ†é¡µï¼ˆfrom/sizeï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-10-é«˜äº®-highlight" class="router-link-active router-link-exact-active toc-link level3">8.10 é«˜äº®ï¼ˆhighlightï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_8-11-ç»“æœè¿‡æ»¤-source" class="router-link-active router-link-exact-active toc-link level3">8.11 ç»“æœè¿‡æ»¤ï¼ˆ_sourceï¼‰</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_9-èšåˆ-aggregations" class="router-link-active router-link-exact-active toc-link level2">9 èšåˆï¼ˆaggregationsï¼‰</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_9-1-åŸºæœ¬æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level3">9.1 åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_9-2-èšåˆä¸ºæ¡¶" class="router-link-active router-link-exact-active toc-link level3">9.2 èšåˆä¸ºæ¡¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_9-3-æ¡¶å†…åº¦é‡" class="router-link-active router-link-exact-active toc-link level3">9.3 æ¡¶å†…åº¦é‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_9-4-æ¡¶å†…åµŒå¥—æ¡¶" class="router-link-active router-link-exact-active toc-link level3">9.4 æ¡¶å†…åµŒå¥—æ¡¶</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-springdata-elasticsearch" class="router-link-active router-link-exact-active toc-link level2">10 SpringData-Elasticsearch</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-1-ä»‹ç»" class="router-link-active router-link-exact-active toc-link level3">10.1 ä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-2-åˆ›å»ºspringboot-é¡¹ç›®" class="router-link-active router-link-exact-active toc-link level3">10.2 åˆ›å»ºspringboot é¡¹ç›®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-3-banæµ‹è¯•" class="router-link-active router-link-exact-active toc-link level3">10.3 banæµ‹è¯•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-4-æµ‹è¯•ä¿å­˜" class="router-link-active router-link-exact-active toc-link level3">10.4 æµ‹è¯•ä¿å­˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-5-æµ‹è¯•æ£€ç´¢" class="router-link-active router-link-exact-active toc-link level3">10.5 æµ‹è¯•æ£€ç´¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-6-åˆ›å»ºmodule" class="router-link-active router-link-exact-active toc-link level3">10.6 åˆ›å»ºmodule</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-7-å®ä½“ç±»" class="router-link-active router-link-exact-active toc-link level3">10.7 å®ä½“ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-8-åˆ›å»ºç´¢å¼•åŠæ˜ å°„" class="router-link-active router-link-exact-active toc-link level3">10.8 åˆ›å»ºç´¢å¼•åŠæ˜ å°„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-9-repositoryæ–‡æ¡£æ“ä½œ" class="router-link-active router-link-exact-active toc-link level3">10.9 Repositoryæ–‡æ¡£æ“ä½œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/middleware/elastic-search.html#_10-10-æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">10.10 æŸ¥è¯¢</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!-- more --><h1>ElasticSearch</h1><p><img src="/assets/true-image-20210604131952296-11fdaa89.png" alt=""></p><p><img src="/assets/true-image-20210604132012980-e5e1feb9.png" alt=""></p><h2 id="_1-elasticsearchæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_1-elasticsearchæ¦‚å¿µ" aria-hidden="true">#</a> 1. ElasticSearchæ¦‚å¿µ</h2><h3 id="_1-1-esä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_1-1-esä»‹ç»" aria-hidden="true">#</a> 1.1 ESä»‹ç»</h3><p>åº”ç”¨ç¨‹åºæœç´¢ ç½‘ç«™æœç´¢ ä¼ä¸šæœç´¢ æ—¥å¿—å¤„ç†å’Œåˆ†æ</p><p>åŸºç¡€è®¾æ–½æŒ‡æ ‡å’Œå®¹å™¨ç›‘æµ‹ åº”ç”¨ç¨‹åºæ€§èƒ½ç›‘æµ‹</p><p>åœ°ç†ç©ºé—´æ•°æ®åˆ†æå’Œå¯è§†åŒ– å®‰å…¨åˆ†æ ä¸šåŠ¡åˆ†æ</p><p>å®˜æ–¹æ–‡æ¡£ : <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å®˜æ–¹ä¸­æ–‡ : <a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/foreword_id.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/cn/elasticsearch/guide/current/foreword_id.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ç¤¾åŒºä¸­æ–‡: <a href="https://es.xiaoleilu.com/index.html%E3%80%81http://doc.codingdict.com/elasticsearch/0/" target="_blank" rel="noopener noreferrer">https://es.xiaoleilu.com/index.htmlã€http://doc.codingdict.com/elasticsearch/0/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_1-2-åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_1-2-åŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> 1.2 åŸºæœ¬æ¦‚å¿µ</h3><p>Elasticsearchä¹Ÿæ˜¯åŸºäºLuceneçš„å…¨æ–‡æ£€ç´¢åº“ï¼Œæœ¬è´¨ä¹Ÿæ˜¯å­˜å‚¨æ•°æ®ï¼Œå¾ˆå¤šæ¦‚å¿µä¸MySQLç±»ä¼¼çš„ã€‚</p><p>å¯¹æ¯”å…³ç³»ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ç´¢å¼•ï¼ˆindicesï¼‰----------------------Databases æ•°æ®åº“

  ç±»å‹ï¼ˆtypeï¼‰--------------------------Table æ•°æ®è¡¨

     æ–‡æ¡£ï¼ˆDocumentï¼‰----------------------Row è¡Œ

	    å­—æ®µï¼ˆFieldï¼‰-------------------------Columns åˆ— 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>index:ç´¢å¼•</p><p>type: æ•°æ®ç±»å‹</p><p>document</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ä¿å­˜ åœ¨ æŸ ä¸ª ç´¢å¼• (Index) ä¸‹ ï¼Œ æŸ ç§ ç±» å‹ Type) çš„ ä¸€ ä¸ª æ•°æ® (Document) ï¼Œ æ–‡ æ¡£ æ˜¯ JSON æ ¼
å¼ çš„ ï¼ŒDocument å°± åƒ æ˜¯ MySQL ä¸­ çš„ æŸ ä¸ª Table é‡Œ é¢ çš„ å†… å®¹ 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦æ³¨æ„çš„æ˜¯ï¼šElasticsearchæœ¬èº«å°±æ˜¯åˆ†å¸ƒå¼çš„ï¼Œå› æ­¤å³ä¾¿ä½ åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒElasticsearché»˜è®¤ä¹Ÿä¼šå¯¹ä½ çš„æ•°æ®è¿›è¡Œåˆ†ç‰‡å’Œå‰¯æœ¬æ“ä½œï¼Œ å½“ä½ å‘é›†ç¾¤æ·»åŠ æ–°æ•°æ®æ—¶ï¼Œæ•°æ®ä¹Ÿä¼šåœ¨æ–°åŠ å…¥çš„èŠ‚ç‚¹ä¸­è¿›è¡Œå¹³è¡¡ã€‚</p><h2 id="_2-å®‰è£…" tabindex="-1"><a class="header-anchor" href="#_2-å®‰è£…" aria-hidden="true">#</a> 2 å®‰è£…</h2><p><a href="https://www.elastic.co/cn/downloads/elasticsearch#ga-release" target="_blank" rel="noopener noreferrer">downloads<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>docker pull elasticsearch:7.14.0 å­˜å‚¨å’Œæ£€ç´¢æ•°æ®</p><p>docker pull kibana:7.14.0 å¯è§†åŒ–æ•°æ®</p></blockquote><p><a href="https://blog.csdn.net/qq_42476834/article/details/112675953" target="_blank" rel="noopener noreferrer">æ•™ç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="/tools/docker/docker-install-mysql-redis-nginx-nacos-mq-es.html#elasticsearch-kibana" class="">å…·ä½“ Docker å®‰è£…é…ç½®-ç«™å†…è·³è½¬</a></p><h3 id="æŸ¥çœ‹-elasticsearch" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹-elasticsearch" aria-hidden="true">#</a> æŸ¥çœ‹ elasticsearch</h3><p><img src="/assets/true-image-20210908125845385-033bf4e3.png" alt=""></p><h3 id="æŸ¥çœ‹-kibana" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹-kibana" aria-hidden="true">#</a> æŸ¥çœ‹ kibana</h3><p><img src="/assets/true-image-20210908134637817-c0914e91.png" alt=""></p><h2 id="_3-ç´¢å¼•æ“ä½œ-indices" tabindex="-1"><a class="header-anchor" href="#_3-ç´¢å¼•æ“ä½œ-indices" aria-hidden="true">#</a> 3 ç´¢å¼•æ“ä½œï¼ˆindicesï¼‰</h2><h3 id="_3-1-æŸ¥è¯¢ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_3-1-æŸ¥è¯¢ç´¢å¼•" aria-hidden="true">#</a> 3.1 æŸ¥è¯¢ç´¢å¼•</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/_cat/indices?v æœ‰å“ªäº›ç´¢å¼•åº“
/_cat/nodes æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯
/_cat/health æŸ¥çœ‹eså¥åº·çŠ¶æ€
/_cat/master æŸ¥çœ‹ä¸»èŠ‚ç‚¹
/_cat/indices æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>es ä¸­ä¼šé»˜è®¤å­˜åœ¨ä¸€ä¸ªåä¸º.kibanaå’Œ.kibana_task_managerçš„ç´¢å¼•</p><p>è¡¨å¤´çš„å«ä¹‰</p><table><thead><tr><th style="text-align:center;">å­—æ®µå</th><th style="text-align:left;">å«ä¹‰è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center;">health</td><td style="text-align:left;">green(é›†ç¾¤å®Œæ•´) yellow(å•ç‚¹æ­£å¸¸ã€é›†ç¾¤ä¸å®Œæ•´) red(å•ç‚¹ä¸æ­£å¸¸)</td></tr><tr><td style="text-align:center;">status</td><td style="text-align:left;">æ˜¯å¦èƒ½ä½¿ç”¨</td></tr><tr><td style="text-align:center;">index</td><td style="text-align:left;">ç´¢å¼•å</td></tr><tr><td style="text-align:center;">uuid</td><td style="text-align:left;">ç´¢å¼•ç»Ÿä¸€ç¼–å·</td></tr><tr><td style="text-align:center;">pri</td><td style="text-align:left;">ä¸»èŠ‚ç‚¹å‡ ä¸ª</td></tr><tr><td style="text-align:center;">rep</td><td style="text-align:left;">ä»èŠ‚ç‚¹å‡ ä¸ª</td></tr><tr><td style="text-align:center;">docs.count</td><td style="text-align:left;">æ–‡æ¡£æ•°</td></tr><tr><td style="text-align:center;">docs.deleted</td><td style="text-align:left;">æ–‡æ¡£è¢«åˆ äº†å¤šå°‘</td></tr><tr><td style="text-align:center;">store.size</td><td style="text-align:left;">æ•´ä½“å ç©ºé—´å¤§å°</td></tr><tr><td style="text-align:center;">pri.store.size</td><td style="text-align:left;">ä¸»èŠ‚ç‚¹å </td></tr></tbody></table><h3 id="_3-2-åˆ›å»ºç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_3-2-åˆ›å»ºç´¢å¼•" aria-hidden="true">#</a> 3.2 åˆ›å»ºç´¢å¼•</h3><p>ä¿å­˜: PUT /index/type/æ ‡è¯†id</p><p>å¦‚: PUT /customer/demo/1</p><p><strong>PUT å’Œ POSTéƒ½å¯ä»¥.</strong></p><p><em>POST</em> æ–°å¢ã€‚å¦‚æœä¸æŒ‡å®šidï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆidã€‚æŒ‡å®šidå°±ä¼šä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œå¹¶æ–°å¢ç‰ˆæœ¬å·</p><p><em>PUT</em> å¯ä»¥æ–°å¢&amp;ä¿®æ”¹ã€‚PUTå¿…é¡»æŒ‡å®šid,ç”±äºPUTéœ€è¦æŒ‡å®šidï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ç”¨æ¥åšä¿®æ”¹æ“ä½œï¼Œä¸æŒ‡å®šidä¼šæŠ¥é”™ ã€‚</p><h4 id="å“åº”ç»“æœ" tabindex="-1"><a class="header-anchor" href="#å“åº”ç»“æœ" aria-hidden="true">#</a> å“åº”ç»“æœ <a name="å“åº”ç»“æœ"></a></h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{
    &quot;_index&quot;: &quot;customer&quot;, #ç´¢å¼•
    &quot;_type&quot;: &quot;demo&quot;, #ç±»å‹
    &quot;_id&quot;: &quot;1&quot;,	#id
    &quot;_version&quot;: 5, #ç‰ˆæœ¬
    &quot;result&quot;: &quot;updated&quot;, #çŠ¶æ€
    &quot;_shards&quot;: {
        &quot;total&quot;: 2,
        &quot;successful&quot;: 1,
        &quot;failed&quot;: 0
    },
    &quot;_seq_no&quot;: 5, #å¹¶å‘æ§åˆ¶å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°å°±ä¼š+1ï¼Œç”¨æ¥åšä¹è§‚é”
    &quot;_primary_term&quot;: 1 #åŒä¸Š,ä¸»åˆ†ç‰‡é‡æ–°åˆ†é…ï¼Œå¦‚é‡å¯ï¼Œå°±ä¼šå˜åŒ–
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="put" tabindex="-1"><a class="header-anchor" href="#put" aria-hidden="true">#</a> PUT</h4><p><img src="/assets/true-image-20210908140454119-cedcc55c.png" alt=""></p><p><img src="/assets/true-image-20210908140642855-b873a36f.png" alt=""></p><p>ä¸æŒ‡å®šIDæŠ¥é”™</p><p><img src="/assets/true-image-20210908140522448-6e782efb.png" alt=""></p><h4 id="post" tabindex="-1"><a class="header-anchor" href="#post" aria-hidden="true">#</a> POST</h4><p><img src="/assets/true-image-20210908141401665-62fc79c2.png" alt=""></p><h3 id="_3-3-get-æŸ¥è¯¢æ–‡æ¡£-ä¹è§‚é”" tabindex="-1"><a class="header-anchor" href="#_3-3-get-æŸ¥è¯¢æ–‡æ¡£-ä¹è§‚é”" aria-hidden="true">#</a> 3.3 get æŸ¥è¯¢æ–‡æ¡£&amp;ä¹è§‚é”</h3><p><a href="#%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%9C">å“åº”ç»“æœ</a></p><p>get <a href="http://192.168.101.5:9200/customer/demo/1" target="_blank" rel="noopener noreferrer">http://192.168.101.5:9200/customer/demo/1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;found&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°é±¼666&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ›´æ–°æºå¸¦ ?if_seq_no=14&amp;if_primary_term=1</p></blockquote><h4 id="å¹¶å‘ä¿®æ”¹æµ‹è¯•-å¤šä¸ªäººåŒæ—¶ä¿®æ”¹ä¸€ä¸ªæ•°æ®" tabindex="-1"><a class="header-anchor" href="#å¹¶å‘ä¿®æ”¹æµ‹è¯•-å¤šä¸ªäººåŒæ—¶ä¿®æ”¹ä¸€ä¸ªæ•°æ®" aria-hidden="true">#</a> å¹¶å‘ä¿®æ”¹æµ‹è¯•:å¤šä¸ªäººåŒæ—¶ä¿®æ”¹ä¸€ä¸ªæ•°æ®</h4><p><img src="/assets/true-image-20210908144225635-924815c0.png" alt=""></p><p><img src="/assets/true-image-20210908144344775-7fab5aaf.png" alt=""></p><p>è¯»å–</p><p><img src="/assets/true-image-20210908144359490-f1e7dcd2.png" alt=""></p><p>å¦‚æœæƒ³è¦ä¿®æ”¹æˆåŠŸ,å°±éœ€è¦è·å–æœ€æ–°çš„_seq_no</p><h3 id="_3-4-post-æ›´æ–°æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_3-4-post-æ›´æ–°æ–‡æ¡£" aria-hidden="true">#</a> 3.4 post æ›´æ–°æ–‡æ¡£</h3><p>æ›´æ–°1</p><p><img src="/assets/true-image-20210908145026804-51551790.png" alt=""></p><p>è¯»å–</p><p><img src="/assets/true-image-20210908145037058-84d99cea.png" alt=""></p><p>æ›´æ–°2</p><p><img src="/assets/true-image-20210908145215817-91563c1f.png" alt=""></p><h3 id="_3-5-åˆ é™¤æ–‡æ¡£-ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_3-5-åˆ é™¤æ–‡æ¡£-ç´¢å¼•" aria-hidden="true">#</a> 3.5 åˆ é™¤æ–‡æ¡£&amp;ç´¢å¼•</h3><p>åˆ é™¤ID: <a href="http://192.168.101.5:9200/customer/demo/id/" target="_blank" rel="noopener noreferrer">http://192.168.101.5:9200/customer/demo/id/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8v8NxHsBlSgdobgg7YRN&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deleted&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ é™¤ç´¢å¼•: <a href="http://192.168.101.5:9200/customer/" target="_blank" rel="noopener noreferrer">http://192.168.101.5:9200/customer/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹ç´¢å¼•: <a href="http://192.168.101.5:9200/_cat/indices" target="_blank" rel="noopener noreferrer">http://192.168.101.5:9200/_cat/indices<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_3-6-post-bulkæ‰¹é‡å¯¼å…¥-api" tabindex="-1"><a class="header-anchor" href="#_3-6-post-bulkæ‰¹é‡å¯¼å…¥-api" aria-hidden="true">#</a> 3.6 post bulkæ‰¹é‡å¯¼å…¥ API</h3><h4 id="ä½¿ç”¨postmanè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨postmanè¯·æ±‚" aria-hidden="true">#</a> ä½¿ç”¨postmanè¯·æ±‚</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{&quot;index&quot;:{&quot;_id&quot;:&quot;1&quot;}}
{&quot;name&quot;: &quot;å°éœ&quot;}
{&quot;index&quot;:{&quot;_id&quot;: &quot;2&quot;}}
{&quot;name&quot;: &quot;å°èŠ±&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>post <a href="http://192.168.101.5:9200/customer/demo/_bulk" target="_blank" rel="noopener noreferrer">http://192.168.101.5:9200/customer/demo/_bulk<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;took&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errors&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;updated&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">200</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;demo&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;created&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_shards&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;total&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;successful&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;failed&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_seq_no&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">&quot;_primary_term&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">201</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="http://192.168.101.5:9200/customer/demo/1" target="_blank" rel="noopener noreferrer">http://192.168.101.5:9200/customer/demo/1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="å¯è§†åŒ–æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#å¯è§†åŒ–æ“ä½œ" aria-hidden="true">#</a> å¯è§†åŒ–æ“ä½œ</h4><p><img src="/assets/true-image-20210908152409088-fc9cb420.png" alt=""></p><p>POST /_bulk</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;delete&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;create&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My first blog post&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My second blog post&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;update&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;website&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;blog&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;doc&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My updated blog post&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/true-image-20210908153043492-fd9c498e.png" alt=""></p><h4 id="æ ·æœ¬æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ ·æœ¬æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> æ ·æœ¬æµ‹è¯•æ•°æ®</h4><p><a href="https://download.elastic.co/demos/kibana/gettingstarted/accounts.zip" target="_blank" rel="noopener noreferrer">accounts.zip<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="/assets/true-image-20210908155510529-46065d03.png" alt=""></p><h2 id="_4-æ˜ å°„é…ç½®-mapping" tabindex="-1"><a class="header-anchor" href="#_4-æ˜ å°„é…ç½®-mapping" aria-hidden="true">#</a> 4 æ˜ å°„é…ç½®ï¼ˆ_mappingï¼‰</h2><p>ç´¢å¼•æœ‰äº†ï¼Œæ¥ä¸‹æ¥è‚¯å®šæ˜¯æ·»åŠ æ•°æ®ã€‚ä½†æ˜¯ï¼Œåœ¨æ·»åŠ æ•°æ®ä¹‹å‰å¿…é¡»å®šä¹‰æ˜ å°„ã€‚</p><p>ä»€ä¹ˆæ˜¯æ˜ å°„ï¼Ÿ</p><p>æ˜ å°„æ˜¯å®šä¹‰æ–‡æ¡£çš„è¿‡ç¨‹ï¼Œæ–‡æ¡£åŒ…å«å“ªäº›å­—æ®µï¼Œè¿™äº›å­—æ®µæ˜¯å¦ä¿å­˜ï¼Œæ˜¯å¦ç´¢å¼•ï¼Œæ˜¯å¦åˆ†è¯ç­‰</p><p>åªæœ‰é…ç½®æ¸…æ¥šï¼ŒElasticsearchæ‰ä¼šå¸®æˆ‘ä»¬è¿›è¡Œç´¢å¼•åº“çš„åˆ›å»ºï¼ˆä¸ä¸€å®šï¼‰</p><h3 id="_4-1-put-åˆ›å»ºæ˜ å°„å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_4-1-put-åˆ›å»ºæ˜ å°„å­—æ®µ" aria-hidden="true">#</a> 4.1 PUT åˆ›å»ºæ˜ å°„å­—æ®µ</h3><p>PUT /ç´¢å¼•åº“å/_mapping/ç±»å‹åç§°</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;å­—æ®µå&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ç±»å‹&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;store&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;åˆ†è¯å™¨&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç±»å‹åç§°ï¼šå°±æ˜¯å‰é¢å°†çš„typeçš„æ¦‚å¿µï¼Œç±»ä¼¼äºæ•°æ®åº“ä¸­çš„ä¸åŒè¡¨</p><p>å­—æ®µåï¼šç±»ä¼¼äºåˆ—åï¼Œpropertiesä¸‹å¯ä»¥æŒ‡å®šè®¸å¤šå­—æ®µã€‚</p><p>æ¯ä¸ªå­—æ®µå¯ä»¥æœ‰å¾ˆå¤šå±æ€§ã€‚ä¾‹å¦‚ï¼š</p><ul><li>typeï¼šç±»å‹ï¼Œå¯ä»¥æ˜¯textã€longã€shortã€dateã€integerã€objectç­‰</li><li>indexï¼šæ˜¯å¦ç´¢å¼•ï¼Œé»˜è®¤ä¸ºtrue</li><li>storeï¼šæ˜¯å¦å­˜å‚¨ï¼Œé»˜è®¤ä¸ºfalse</li><li>analyzerï¼šåˆ†è¯å™¨ï¼Œè¿™é‡Œä½¿ç”¨ikåˆ†è¯å™¨ï¼š<code>ik_max_word</code>æˆ–è€…<code>ik_smart</code></li></ul><p><strong>ç¤ºä¾‹</strong></p><p>å‘èµ·è¯·æ±‚ï¼š</p><p><strong>ç¤ºä¾‹1</strong></p><p>PUT atguigu/_mapping/goods</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;false&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¤ºä¾‹2</strong></p><p>PUT /my_index</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;integer&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;keyword&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å“åº”ç»“æœï¼š</strong></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;acknowledged&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/true-image-20210908215920528-3f961357.png" alt=""></p><h3 id="_4-2-get-æŸ¥çœ‹æ˜ å°„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_4-2-get-æŸ¥çœ‹æ˜ å°„å…³ç³»" aria-hidden="true">#</a> 4.2 GET æŸ¥çœ‹æ˜ å°„å…³ç³»</h3><p>è¯­æ³•ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /ç´¢å¼•åº“å/_mapping
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç¤ºä¾‹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /atguigu/_mapping
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å“åº”ï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;atguigu&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;mappings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;goods&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;properties&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>typeï¼šå­—æ®µç±»å‹ã€‚Stringï¼ˆtext keywordï¼‰ Numericï¼ˆlong integer float doubleï¼‰ date boolean</p><p>indexï¼šæ˜¯å¦åˆ›å»ºç´¢å¼•</p><p>analyzerï¼šåˆ†è¯å™¨ï¼ˆik_max_wordï¼‰</p><h3 id="_4-3-put-æ·»åŠ ç´¢å¼•å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_4-3-put-æ·»åŠ ç´¢å¼•å­—æ®µ" aria-hidden="true">#</a> 4.3 PUT æ·»åŠ ç´¢å¼•å­—æ®µ</h3><p>PUT /my_index/_mapping</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{
  &quot;properties&quot;: {
    &quot;employee-id&quot;:{	#å­—æ®µ
      &quot;type&quot;:&quot;keyword&quot;,  #ç±»å‹
      &quot;index&quot;:false   #å¯æ£€ç´¢
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºå·²ç»å­˜åœ¨çš„æ˜ å°„å­—æ®µï¼Œæˆ‘ä»¬ä¸èƒ½æ›´æ–°ã€‚æ›´æ–°å¿…é¡»åˆ›å»ºæ–°çš„ç´¢å¼•è¿›è¡Œæ•°æ®è¿ç§»</p><h3 id="_4-4-æ˜ å°„-put-æ•°æ®è¿ç§»" tabindex="-1"><a class="header-anchor" href="#_4-4-æ˜ å°„-put-æ•°æ®è¿ç§»" aria-hidden="true">#</a> 4.4 æ˜ å°„ PUT æ•°æ®è¿ç§»</h3><p>_type=&quot;account&quot; å˜ä¸º&gt; _type: &quot;_doc&quot;,ï¼Œå–æ¶ˆäº†typeï¼Œ6.0ä¹‹åå–æ¶ˆäº†type</p><p>GET /bank/_mapping</p><p>PUT /newbank</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;integer&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;integer&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;city&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;employer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;firstname&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lastname&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>GET /newbank</p><p>POST _reindex</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;source&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token string">&quot;bank&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;account&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dest&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token string">&quot;newbank&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>GET /newbank/_search #_type=&quot;account&quot; å˜ä¸º&gt; _type: &quot;_doc&quot;,ï¼Œå–æ¶ˆäº†typeï¼Œ6.0ä¹‹åå–æ¶ˆäº†type</p></blockquote><h2 id="_5-æ–°å¢æ–‡æ¡£-document" tabindex="-1"><a class="header-anchor" href="#_5-æ–°å¢æ–‡æ¡£-document" aria-hidden="true">#</a> 5 æ–°å¢æ–‡æ¡£ï¼ˆdocumentï¼‰</h2><p>æœ‰äº†ç´¢å¼•ã€ç±»å‹å’Œæ˜ å°„ï¼Œå°±å¯ä»¥å¯¹æ–‡æ¡£åšå¢åˆ æ”¹æŸ¥æ“ä½œäº†ã€‚</p><h3 id="_5-1-åŸºæœ¬ç©æ³•" tabindex="-1"><a class="header-anchor" href="#_5-1-åŸºæœ¬ç©æ³•" aria-hidden="true">#</a> 5.1 åŸºæœ¬ç©æ³•</h3><p>å¦‚æœæˆ‘ä»¬æƒ³è¦è‡ªå·±æ–°å¢çš„æ—¶å€™æŒ‡å®šidï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>POST /ç´¢å¼•åº“å/ç±»å‹/idå€¼
{
    ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¼”ç¤ºï¼š</p><p>æŸ¥è¯¢å¾—åˆ°ä¸¤æ¡æ•°æ®ï¼šå°ç±³æ‰‹æœºçš„idæ˜¯æˆ‘ä»¬æŒ‡å®šçš„id</p><ul><li><code>_source</code>ï¼šæºæ–‡æ¡£ä¿¡æ¯ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½åœ¨é‡Œé¢ã€‚</li><li><code>_id</code>ï¼šè¿™æ¡æ–‡æ¡£çš„å”¯ä¸€æ ‡ç¤ºï¼Œä¸æ–‡æ¡£è‡ªå·±çš„idå­—æ®µæ²¡æœ‰å…³è”</li></ul><h3 id="_5-2-æ™ºèƒ½åˆ¤æ–­" tabindex="-1"><a class="header-anchor" href="#_5-2-æ™ºèƒ½åˆ¤æ–­" aria-hidden="true">#</a> 5.2 æ™ºèƒ½åˆ¤æ–­</h3><p>äº‹å®ä¸ŠElasticsearchéå¸¸æ™ºèƒ½ï¼Œä½ ä¸éœ€è¦ç»™ç´¢å¼•åº“è®¾ç½®ä»»ä½•mappingæ˜ å°„ï¼Œå®ƒä¹Ÿå¯ä»¥æ ¹æ®ä½ è¾“å…¥çš„æ•°æ®æ¥åˆ¤æ–­ç±»å‹ï¼ŒåŠ¨æ€æ·»åŠ æ•°æ®æ˜ å°„ã€‚</p><p>æµ‹è¯•ä¸€ä¸‹ï¼š</p><p>POST /atguigu/goods/2</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;å°ç±³æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;images&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">2899</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stock&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token property">&quot;saleable&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;attr&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬é¢å¤–æ·»åŠ äº†stockåº“å­˜ï¼Œsaleableæ˜¯å¦ä¸Šæ¶ï¼Œattrå…¶ä»–å±æ€§å‡ ä¸ªå­—æ®µã€‚</p><p>æ¥çœ‹ç»“æœï¼š<code>GET /atguigu/_search</code></p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;åä¸ºæ‰‹æœº&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">4288</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å°ç±³æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">2899</span><span class="token punctuation">,</span>
          <span class="token property">&quot;stock&quot;</span> <span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
          <span class="token property">&quot;saleable&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token property">&quot;attr&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;brand&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†çœ‹ä¸‹ç´¢å¼•åº“çš„æ˜ å°„å…³ç³»: <code>GET /atguigu/_mapping</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;atguigu&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;mappings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;goods&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;properties&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;attr&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;properties&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;brand&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;fields&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;keyword&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;ignore_above&quot;</span> <span class="token operator">:</span> <span class="token number">256</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;fields&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;keyword&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;ignore_above&quot;</span> <span class="token operator">:</span> <span class="token number">256</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;saleable&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;boolean&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;stock&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>stockï¼Œsaleableï¼Œattréƒ½è¢«æˆåŠŸæ˜ å°„äº†ã€‚</p><p>å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ï¼Œä¼šæ·»åŠ ä¸¤ç§ç±»å‹ï¼štext + keywordã€‚å¦‚ä¸Šä¾‹ä¸­çš„category å’Œ brand</p><h2 id="_6-åˆ é™¤æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_6-åˆ é™¤æ•°æ®" aria-hidden="true">#</a> 6 åˆ é™¤æ•°æ®</h2><p>åˆ é™¤ä½¿ç”¨DELETEè¯·æ±‚ï¼ŒåŒæ ·ï¼Œéœ€è¦æ ¹æ®idè¿›è¡Œåˆ é™¤ï¼š</p><p><strong>è¯­æ³•</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DELETE /ç´¢å¼•åº“å/ç±»å‹å/idå€¼
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DELETE /atguigu/goods/3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ç»“æœï¼š</strong></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_version&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;result&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;deleted&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_seq_no&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_primary_term&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-åˆ†è¯" tabindex="-1"><a class="header-anchor" href="#_7-åˆ†è¯" aria-hidden="true">#</a> 7 åˆ†è¯</h2><h3 id="_7-1-é»˜è®¤åˆ†è¯å™¨-å¯¹ä¸­æ–‡ä¸å‹å¥½" tabindex="-1"><a class="header-anchor" href="#_7-1-é»˜è®¤åˆ†è¯å™¨-å¯¹ä¸­æ–‡ä¸å‹å¥½" aria-hidden="true">#</a> 7.1 é»˜è®¤åˆ†è¯å™¨ï¼Œå¯¹ä¸­æ–‡ä¸å‹å¥½</h3><p>POST _analyze</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{
  &quot;analyzer&quot;: &quot;standard&quot;,
  &quot;text&quot;: &quot;Bucket aggregations donâ€™t calculate metrics over fields like&quot;
}

ç»“æœ:

	{
      &quot;tokens&quot; : [
        {
          &quot;token&quot; : &quot;bucket&quot;,
          &quot;start_offset&quot; : 0,
          &quot;end_offset&quot; : 6,
          &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
          &quot;position&quot; : 0
        },
        {
          &quot;token&quot; : &quot;aggregations&quot;,
          &quot;start_offset&quot; : 7,
          &quot;end_offset&quot; : 19,
          &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
          &quot;position&quot; : 1
        },
--------------------
POST _analyze

{
  &quot;analyzer&quot;: &quot;standard&quot;,
  &quot;text&quot;: &quot;æˆ‘çˆ±ä½ java&quot;
}

ç»“æœï¼š

    {
      &quot;tokens&quot; : [
        {
          &quot;token&quot; : &quot;å­¦&quot;,
          &quot;start_offset&quot; : 0,
          &quot;end_offset&quot; : 1,
          &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
          &quot;position&quot; : 0
        },
        {
          &quot;token&quot; : &quot;æ ¡&quot;,
          &quot;start_offset&quot; : 1,
          &quot;end_offset&quot; : 2,
          &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
          &quot;position&quot; : 1
        },
        {
          &quot;token&quot; : &quot;æˆ‘&quot;,
          &quot;start_offset&quot; : 2,
          &quot;end_offset&quot; : 3,
          &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
          &quot;position&quot; : 2
        },
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-2-ik-åˆ†è¯å™¨" tabindex="-1"><a class="header-anchor" href="#_7-2-ik-åˆ†è¯å™¨" aria-hidden="true">#</a> 7.2 ik åˆ†è¯å™¨</h3><p><a href="https://github.com/medcl/elasticsearch-analysis-ik/releases" target="_blank" rel="noopener noreferrer">github ä¸‹è½½<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>è§£å‹åˆ°esï¼šplugins</p><p>é‡å¯es</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># åˆ†è¯å¤±è´¥
POST _analyze
{
  &quot;analyzer&quot;: &quot;standard&quot;,
  &quot;text&quot;: &quot;æˆ‘çˆ±ä½ ä¸­å›½&quot;
}

# åˆ†è¯ok
POST _analyze
{
  &quot;analyzer&quot;: &quot;ik_smart&quot;,
  &quot;text&quot;: &quot;æˆ‘çˆ±ä½ ä¸­å›½&quot;
}

# å¤šè¯ç»„åˆã€å¦‚ä¸‹å›¾ã€‘
POST _analyze
{
  &quot;analyzer&quot;: &quot;ik_max_word&quot;,
  &quot;text&quot;: &quot;æˆ‘çˆ±ä½ ä¸­å›½&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/true-image-20210908231400256-348a70f6.png" alt=""></p><h3 id="_7-3-è‡ªå®šä¹‰åˆ†è¯" tabindex="-1"><a class="header-anchor" href="#_7-3-è‡ªå®šä¹‰åˆ†è¯" aria-hidden="true">#</a> 7.3 è‡ªå®šä¹‰åˆ†è¯</h3><p><strong>nginx é…ç½®</strong></p><p><a href="http://localhost:50005/es/fenci.txt" target="_blank" rel="noopener noreferrer">http://localhost:50005/es/fenci.txt<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ik/config/IKAnalyzer.cfg.xml:</p><p><code>&lt;entry key=&quot;remote_ext_dict&quot;&gt;http://localhost:50005/es/fenci.txt&lt;/entry&gt;</code></p><p>é‡å¯es</p><h2 id="_8-æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_8-æŸ¥è¯¢" aria-hidden="true">#</a> 8 æŸ¥è¯¢</h2><h3 id="_8-1-2ç§æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_8-1-2ç§æŸ¥è¯¢" aria-hidden="true">#</a> 8.1 2ç§æŸ¥è¯¢ <a name="2ç§æŸ¥è¯¢"></a></h3><table><thead><tr><th>took</th><th>Elasticsearchæ‰§è¡Œæœç´¢çš„æ—¶é—´(æ¯«ç§’)</th></tr></thead><tbody><tr><td>time_out</td><td>å‘Šè¯‰æˆ‘ä»¬æœç´¢æ˜¯å¦è¶…æ—¶</td></tr><tr><td>_shards</td><td>å‘Šè¯‰æˆ‘ä»¬å¤šå°‘ä¸ªåˆ†ç‰‡è¢«æœç´¢äº†ï¼Œä»¥åŠç»Ÿè®¡äº†æˆåŠŸ/å¤±è´¥çš„æœç´¢åˆ†ç‰‡</td></tr><tr><td>hits</td><td>æœç´¢ç»“æœ</td></tr><tr><td>hits.total</td><td>æœç´¢ç»“æœ</td></tr><tr><td>hits.hits</td><td>å®é™…çš„æœç´¢ç»“æœæ•°ç»„(é»˜è®¤ä¸ºå‰10çš„æ–‡æ¡£)</td></tr><tr><td>sort</td><td>ç»“æœçš„æ’åºkey (é”®) (æ²¡æœ‰åˆ™æŒ‰scoreæ’åº)</td></tr><tr><td>scoreå’Œmax_score</td><td>ç›¸å…³æ€§å¾—åˆ†å’Œæœ€é«˜åˆ†</td></tr></tbody></table><p>GET bank/_search?q=*&amp;sort=account_number:asc</p><p>GET bank/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;account_number&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asc&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;balance&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢æ‰€æœ‰ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /{index}/_search
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ ¹æ®idæŸ¥è¯¢ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /{index}/{type}/{id}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é™¤äº†ä¸Šè¿°ç®€å•æŸ¥è¯¢ä¹‹å¤–ã€‚elasticsearchä½œä¸ºæœç´¢å¼•æ“ï¼Œæœ€å¤æ‚æœ€å¼ºå¤§çš„åŠŸèƒ½å°±æ˜¯æœç´¢æŸ¥è¯¢åŠŸèƒ½ã€‚åŒ…æ‹¬ï¼šåŒ¹é…æŸ¥è¯¢ã€è¯æ¡æŸ¥è¯¢ã€æ¨¡ç³ŠæŸ¥è¯¢ã€ç»„åˆæŸ¥è¯¢ã€èŒƒå›´æŸ¥è¯¢ã€é«˜äº®ã€æ’åºã€åˆ†é¡µç­‰ç­‰æŸ¥è¯¢åŠŸèƒ½ã€‚</p><p>åŸºæœ¬æŸ¥è¯¢è¯­æ³•å¦‚ä¸‹ï¼š</p><p>GET /ç´¢å¼•åº“å/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;æŸ¥è¯¢ç±»å‹&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;æŸ¥è¯¢æ¡ä»¶&quot;</span><span class="token operator">:</span><span class="token string">&quot;æŸ¥è¯¢æ¡ä»¶å€¼&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„queryä»£è¡¨ä¸€ä¸ªæŸ¥è¯¢å¯¹è±¡ï¼Œé‡Œé¢å¯ä»¥æœ‰ä¸åŒçš„æŸ¥è¯¢å±æ€§</p><ul><li>æŸ¥è¯¢ç±»å‹ï¼š <ul><li>ä¾‹å¦‚ï¼š<code>match_all</code>ï¼ŒÂ <code>match</code>ï¼Œ<code>term</code>Â ï¼ŒÂ <code>range</code> ç­‰ç­‰</li></ul></li><li>æŸ¥è¯¢æ¡ä»¶ï¼šæŸ¥è¯¢æ¡ä»¶ä¼šæ ¹æ®ç±»å‹çš„ä¸åŒï¼Œå†™æ³•ä¹Ÿæœ‰å·®å¼‚ï¼Œåé¢è¯¦ç»†è®²è§£</li></ul><p>æŸ¥è¯¢ç»“æœï¼š</p><ul><li>tookï¼šæŸ¥è¯¢èŠ±è´¹æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’</li><li>time_outï¼šæ˜¯å¦è¶…æ—¶</li><li>_shardsï¼šåˆ†ç‰‡ä¿¡æ¯</li><li>hitsï¼šæœç´¢ç»“æœæ€»è§ˆå¯¹è±¡ <ul><li>totalï¼šæœç´¢åˆ°çš„æ€»æ¡æ•°</li><li>max_scoreï¼šæ‰€æœ‰ç»“æœä¸­æ–‡æ¡£å¾—åˆ†çš„æœ€é«˜åˆ†</li><li>hitsï¼šæœç´¢ç»“æœçš„æ–‡æ¡£å¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€æ¡æœç´¢åˆ°çš„æ–‡æ¡£ä¿¡æ¯ <ul><li>_indexï¼šç´¢å¼•åº“</li><li>_typeï¼šæ–‡æ¡£ç±»å‹</li><li>_idï¼šæ–‡æ¡£id</li><li>_scoreï¼šæ–‡æ¡£å¾—åˆ†</li><li>_sourceï¼šæ–‡æ¡£çš„æºæ•°æ®</li></ul></li></ul></li></ul><h3 id="_8-2-æ•°æ®å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_8-2-æ•°æ®å‡†å¤‡" aria-hidden="true">#</a> 8.2 æ•°æ®å‡†å¤‡</h3><p>POST /atguigu/goods/_bulk</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{&quot;index&quot;:{&quot;_id&quot;:1}}
{ &quot;title&quot;:&quot;å°ç±³æ‰‹æœº&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:1999, &quot;stock&quot;: 200, &quot;attr&quot;: { &quot;category&quot;: &quot;æ‰‹æœº&quot;, &quot;brand&quot;: &quot;å°ç±³&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:2}}
{&quot;title&quot;:&quot;è¶…ç±³æ‰‹æœº&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:2999, &quot;stock&quot;: 300, &quot;attr&quot;: { &quot;category&quot;: &quot;æ‰‹æœº&quot;, &quot;brand&quot;: &quot;å°ç±³&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:3}}
{ &quot;title&quot;:&quot;å°ç±³ç”µè§†&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:3999, &quot;stock&quot;: 400, &quot;attr&quot;: { &quot;category&quot;: &quot;ç”µè§†&quot;, &quot;brand&quot;: &quot;å°ç±³&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:4}}
{ &quot;title&quot;:&quot;å°ç±³ç¬”è®°æœ¬&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:4999, &quot;stock&quot;: 200, &quot;attr&quot;: { &quot;category&quot;: &quot;ç¬”è®°æœ¬&quot;, &quot;brand&quot;: &quot;å°ç±³&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:5}}
{ &quot;title&quot;:&quot;åä¸ºæ‰‹æœº&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:3999, &quot;stock&quot;: 400, &quot;attr&quot;: { &quot;category&quot;: &quot;æ‰‹æœº&quot;, &quot;brand&quot;: &quot;åä¸º&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:6}}
{ &quot;title&quot;:&quot;åä¸ºç¬”è®°æœ¬&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:5999, &quot;stock&quot;: 200, &quot;attr&quot;: { &quot;category&quot;: &quot;ç¬”è®°æœ¬&quot;, &quot;brand&quot;: &quot;åä¸º&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:7}}
{ &quot;title&quot;:&quot;è£è€€æ‰‹æœº&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:2999, &quot;stock&quot;: 300, &quot;attr&quot;: { &quot;category&quot;: &quot;æ‰‹æœº&quot;, &quot;brand&quot;: &quot;åä¸º&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:8}}
{ &quot;title&quot;:&quot;oppoæ‰‹æœº&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:2799, &quot;stock&quot;: 400, &quot;attr&quot;: { &quot;category&quot;: &quot;æ‰‹æœº&quot;, &quot;brand&quot;: &quot;oppo&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:9}}
{ &quot;title&quot;:&quot;vivoæ‰‹æœº&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:2699, &quot;stock&quot;: 300, &quot;attr&quot;: { &quot;category&quot;: &quot;æ‰‹æœº&quot;, &quot;brand&quot;: &quot;vivo&quot; } }
{&quot;index&quot;:{&quot;_id&quot;:10}}
{ &quot;title&quot;:&quot;åä¸ºnovaæ‰‹æœº&quot;, &quot;images&quot;:&quot;http://image.jd.com/12479122.jpg&quot;, &quot;price&quot;:2999, &quot;stock&quot;: 300, &quot;attr&quot;: { &quot;category&quot;: &quot;æ‰‹æœº&quot;, &quot;brand&quot;: &quot;åä¸º&quot; } }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹éæ–‡æœ¬æ•°æ®æ£€ç´¢ç”¨ tremï¼Œå¯¹æ–‡æœ¬|å…¨æ–‡æ£€ç´¢å°±ç”¨ match</p><h3 id="_8-3-åŒ¹é…æŸ¥è¯¢-match-match-all" tabindex="-1"><a class="header-anchor" href="#_8-3-åŒ¹é…æŸ¥è¯¢-match-match-all" aria-hidden="true">#</a> 8.3 åŒ¹é…æŸ¥è¯¢ï¼ˆmatch &amp;&amp; match_allï¼‰</h3><h4 id="_8-3-1-æŸ¥è¯¢æ‰€æœ‰-match-all" tabindex="-1"><a class="header-anchor" href="#_8-3-1-æŸ¥è¯¢æ‰€æœ‰-match-all" aria-hidden="true">#</a> 8.3.1 æŸ¥è¯¢æ‰€æœ‰ï¼ˆmatch_all ï¼‰</h4><p>GET /atguigu/_search</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{
  &quot;query&quot;:{ #æŸ¥è¯¢è§„åˆ™
    &quot;match_all&quot;: {}	#æŸ¥è¯¢æ‰€æœ‰
  },
  &quot;from&quot;: 0, #å¼€å§‹ä½ç½®
  &quot;size&quot;: 4, #é€‰å–æ¡æ•°
  &quot;sort&quot;: [ #æ’åº
    {
      &quot;balance&quot;:{ #å¤„ç†çš„å­—æ®µ
        &quot;order&quot;: &quot;desc&quot; # æ’åºè§„åˆ™
      }
    }
  ],
  &quot;_source&quot;: [&quot;balance&quot;,&quot;lastname&quot;] #æ˜¾ç¤ºå­—æ®µ
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>query</code>ï¼šä»£è¡¨æŸ¥è¯¢å¯¹è±¡</li><li><code>match_all</code>ï¼šä»£è¡¨æŸ¥è¯¢æ‰€æœ‰</li></ul><h4 id="_8-3-2-æ¡ä»¶åŒ¹é…-match" tabindex="-1"><a class="header-anchor" href="#_8-3-2-æ¡ä»¶åŒ¹é…-match" aria-hidden="true">#</a> 8.3.2 æ¡ä»¶åŒ¹é…ï¼ˆmatch ï¼‰</h4><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³æ‰‹æœº&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢å‡ºå¾ˆå¤šæ•°æ®ï¼Œä¸ä»…åŒ…æ‹¬<code>å°ç±³æ‰‹æœº</code>ï¼Œè€Œä¸”ä¸<code>å°ç±³</code>æˆ–è€…<code>æ‰‹æœº</code>ç›¸å…³çš„éƒ½ä¼šæŸ¥è¯¢åˆ°ï¼Œè¯´æ˜å¤šä¸ªè¯ä¹‹é—´æ˜¯<code>or</code>çš„å…³ç³»ã€‚</p><p>æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ›´ç²¾ç¡®æŸ¥æ‰¾ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªå…³ç³»å˜æˆ<code>and</code>ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;operator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;and&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.7037868</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.7037868</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å°ç±³æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;images&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://image.jd.com/12479122.jpg&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">1999</span><span class="token punctuation">,</span>
          <span class="token property">&quot;stock&quot;</span> <span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
          <span class="token property">&quot;attr&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;brand&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-3-3-çŸ­è¯­åŒ¹é…-match-phrase" tabindex="-1"><a class="header-anchor" href="#_8-3-3-çŸ­è¯­åŒ¹é…-match-phrase" aria-hidden="true">#</a> 8.3.3 çŸ­è¯­åŒ¹é… ï¼ˆmatch phraseï¼‰ <a name="çŸ­è¯­åŒ¹é…"></a></h4><p>GET bank/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill lane&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åªä¼šåŒ…å« address=mill lane è®°å½•</p><h4 id="_8-3-4-å­å±æ€§åŒ¹é…-å­—æ®µ-xx" tabindex="-1"><a class="header-anchor" href="#_8-3-4-å­å±æ€§åŒ¹é…-å­—æ®µ-xx" aria-hidden="true">#</a> 8.3.4 å­å±æ€§åŒ¹é…ï¼ˆå­—æ®µ.xxï¼‰ <a name="å­å±æ€§åŒ¹é…"></a></h4><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;attr.brand&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-3-5-å¤šå­—æ®µåŒ¹é…-multi-match" tabindex="-1"><a class="header-anchor" href="#_8-3-5-å¤šå­—æ®µåŒ¹é…-multi-match" aria-hidden="true">#</a> 8.3.5 å¤šå­—æ®µåŒ¹é…ï¼ˆmulti_matchï¼‰ <a name="å¤šå­—æ®µåŒ¹é…"></a></h4><p><code>match</code>åªèƒ½æ ¹æ®ä¸€ä¸ªå­—æ®µåŒ¹é…æŸ¥è¯¢ï¼Œå¦‚æœè¦æ ¹æ®å¤šä¸ªå­—æ®µåŒ¹é…æŸ¥è¯¢å¯ä»¥ä½¿ç”¨<code>multi_match</code></p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attr.brand.keyword&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;city&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>fieldså€¼åŒ¹é…åˆ°query</p><h3 id="_8-4-è¯æ¡æŸ¥è¯¢-ç²¾ç¡®å€¼åŒ¹é…-term" tabindex="-1"><a class="header-anchor" href="#_8-4-è¯æ¡æŸ¥è¯¢-ç²¾ç¡®å€¼åŒ¹é…-term" aria-hidden="true">#</a> 8.4 è¯æ¡æŸ¥è¯¢ï¼Œç²¾ç¡®å€¼åŒ¹é…ï¼ˆtermï¼‰</h3><p><code>term</code> æŸ¥è¯¢è¢«ç”¨äºç²¾ç¡®å€¼ åŒ¹é…ï¼Œè¿™äº›ç²¾ç¡®å€¼å¯èƒ½æ˜¯æ•°å­—ã€æ—¶é—´ã€å¸ƒå°”æˆ–è€…é‚£äº›<strong>æœªåˆ†è¯</strong>çš„å­—ç¬¦ä¸²ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /atguigu/_search

{
    &quot;query&quot;:{
        &quot;term&quot;:{
            &quot;price&quot;: 4999
        }
    }
}

# å¯¹éæ–‡æœ¬æ•°æ®æ£€ç´¢ç”¨tremï¼Œå¯¹æ–‡æœ¬|å…¨æ–‡æ£€ç´¢å°±ç”¨match
GET bank/_search

{
  &quot;query&quot;: {
    &quot;term&quot;: {
        &quot;age&quot;: &quot;28&quot;
    }
  }
}

GET bank/_search

{
  &quot;query&quot;: {
    &quot;term&quot;: {
        &quot;address&quot;: &quot;mill&quot; ########ä¼šå–ä¸åˆ°æ•°æ®
    }
  }
}

GET bank/_search

{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;address&quot;: &quot;990 mill&quot;
    }
  }
}

GET bank/_search

{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;address.keyword&quot;: &quot;990 mill&quot; # ç²¾ç¡®åŒ¹é…
    }
  }
}

GET bank/_search

{
  &quot;query&quot;: {
    &quot;match_phrase&quot;: {
      &quot;address&quot;: &quot;990 mill&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-5-èŒƒå›´æŸ¥è¯¢-range" tabindex="-1"><a class="header-anchor" href="#_8-5-èŒƒå›´æŸ¥è¯¢-range" aria-hidden="true">#</a> 8.5 èŒƒå›´æŸ¥è¯¢ï¼ˆrangeï¼‰</h3><p><code>range</code> æŸ¥è¯¢æ‰¾å‡ºé‚£äº›è½åœ¨æŒ‡å®šåŒºé—´å†…çš„æ•°å­—æˆ–è€…æ—¶é—´</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span>  <span class="token number">1000</span><span class="token punctuation">,</span>
                <span class="token property">&quot;lt&quot;</span><span class="token operator">:</span>   <span class="token number">3000</span>
            <span class="token punctuation">}</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="rangeæŸ¥è¯¢å…è®¸ä»¥ä¸‹å­—ç¬¦-gtã€gteã€ltã€lte" tabindex="-1"><a class="header-anchor" href="#rangeæŸ¥è¯¢å…è®¸ä»¥ä¸‹å­—ç¬¦-gtã€gteã€ltã€lte" aria-hidden="true">#</a> rangeæŸ¥è¯¢å…è®¸ä»¥ä¸‹å­—ç¬¦ï¼šgtã€gteã€ltã€lte</h4><table><thead><tr><th style="text-align:center;">æ“ä½œç¬¦</th><th style="text-align:center;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center;">gt</td><td style="text-align:center;">å¤§äº</td></tr><tr><td style="text-align:center;">gte</td><td style="text-align:center;">å¤§äºç­‰äº</td></tr><tr><td style="text-align:center;">lt</td><td style="text-align:center;">å°äº</td></tr><tr><td style="text-align:center;">lte</td><td style="text-align:center;">å°äºç­‰äº</td></tr></tbody></table><h3 id="_8-6-å¸ƒå°”ç»„åˆ-bool" tabindex="-1"><a class="header-anchor" href="#_8-6-å¸ƒå°”ç»„åˆ-bool" aria-hidden="true">#</a> 8.6 å¸ƒå°”ç»„åˆï¼ˆbool)</h3><p>å¸ƒå°”æŸ¥è¯¢åˆå« <strong>ç»„åˆæŸ¥è¯¢ã€å¤åˆæŸ¥è¯¢</strong></p><p><code>bool</code>æŠŠå„ç§å…¶å®ƒæŸ¥è¯¢é€šè¿‡<code>must</code>ï¼ˆä¸ï¼‰ã€<code>must_not</code>ï¼ˆéï¼‰ã€<code>should</code>ï¼ˆæˆ–ï¼‰çš„æ–¹å¼è¿›è¡Œç»„åˆ</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        	<span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        	  <span class="token punctuation">{</span>
        	    <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	        <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
        	        <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token number">3000</span>
        	      <span class="token punctuation">}</span>
        	    <span class="token punctuation">}</span>
        	  <span class="token punctuation">}</span><span class="token punctuation">,</span>
        	  <span class="token punctuation">{</span>
        	    <span class="token property">&quot;range&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        	        <span class="token property">&quot;gte&quot;</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
        	        <span class="token property">&quot;lte&quot;</span><span class="token operator">:</span> <span class="token number">4000</span>
        	      <span class="token punctuation">}</span>
        	    <span class="token punctuation">}</span>
        	  <span class="token punctuation">}</span>
        	<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>GET bank/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;F&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Mill&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢gender=Må¹¶ä¸”address=Mill</p><p>GET bank/_search</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [ #å¿…é¡»æ˜¯ä»€ä¹ˆ
        {
          &quot;match&quot;: {
            &quot;gender&quot;: &quot;M&quot;
          }
        },
        {
          &quot;match&quot;: {
            &quot;address&quot;: &quot;Mill&quot;
          }
        }
      ],
      &quot;must_not&quot;: [ #å¿…é¡»ä¸æ˜¯ä»€ä¹ˆ
        {
          &quot;match&quot;: {
            &quot;age&quot;: 38
          }
        }
      ],
	  &quot;should&quot;: [ #åº”è¯¥ï¼Œèƒ½åŒ¹é…åˆ°æœ€å¥½ï¼Œæ²¡åŒ¹é…åˆ°ä¹Ÿä¸ä¼¤å¤§é›…ï¼Œæ»¡è¶³çš„è¯max_scoreä¼šæ›´é«˜
        {
          &quot;match&quot;: {
            &quot;lastname&quot;: &quot;Wallace&quot;
          }
        }
      ]
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æŸ¥è¯¢gender=F &amp; address=Mill &amp; age!=38 ï¼Œlastnameèƒ½åŒ¹é…åˆ°æœ€å¥½ï¼Œæ²¡åŒ¹é…åˆ°ä¹Ÿä¸ä¼¤å¤§é›…</p></blockquote><p>æ³¨æ„ï¼šä¸€ä¸ªç»„åˆæŸ¥è¯¢é‡Œé¢åªèƒ½å‡ºç°ä¸€ç§ç»„åˆï¼Œä¸èƒ½æ··ç”¨</p><h3 id="_8-7-è¿‡æ»¤-filter" tabindex="-1"><a class="header-anchor" href="#_8-7-è¿‡æ»¤-filter" aria-hidden="true">#</a> 8.7 è¿‡æ»¤ï¼ˆfilterï¼‰</h3><p>æ‰€æœ‰çš„æŸ¥è¯¢éƒ½ä¼šå½±å“åˆ°æ–‡æ¡£çš„è¯„åˆ†åŠæ’åã€‚å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨æŸ¥è¯¢ç»“æœä¸­è¿›è¡Œè¿‡æ»¤ï¼Œå¹¶ä¸”ä¸å¸Œæœ›è¿‡æ»¤æ¡ä»¶å½±å“è¯„åˆ†ï¼Œé‚£ä¹ˆå°±ä¸è¦æŠŠè¿‡æ»¤æ¡ä»¶ä½œä¸ºæŸ¥è¯¢æ¡ä»¶æ¥ç”¨ã€‚è€Œæ˜¯ä½¿ç”¨<code>filter</code>æ–¹å¼ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GET /atguigu/_search

{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: {
        &quot;match&quot;: { &quot;title&quot;: &quot;å°ç±³æ‰‹æœº&quot; }
      },
      &quot;filter&quot;: {
        &quot;range&quot;: {
          &quot;price&quot;: { &quot;gt&quot;: 2000, &quot;lt&quot;: 3000 }
        }
      }
    }
  }
}

# filterä¸ä¼šè®¡ç®—ç›¸å…³æ€§å¾—åˆ†_scoreï¼Œmuståä¹‹

GET bank/_search

{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [
        {
          &quot;range&quot;: {
            &quot;age&quot;: {
              &quot;gte&quot;: 18,
              &quot;lte&quot;: 30
            }
          }
        }
      ]
    }
  }
}

--------------
GET bank/_search

{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;filter&quot;: {
          &quot;range&quot;: {
            &quot;age&quot;: {
              &quot;gte&quot;: 18,
              &quot;lte&quot;: 30
            }
          }
      }
    }
  }
}

# filter æœ€å¥½æ˜¯æ”¾åœ¨æœ€åè¿‡æ»¤ï¼Œè¿™æ ·ä¸ä¼šå½±å“æŸ¥è¯¢æ¡ä»¶å’Œç›¸å…³æ€§å¾—åˆ†
GET bank/_search

{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [
        {
          &quot;match&quot;: {
            &quot;gender&quot;: &quot;M&quot;
          }
        },
        {
          &quot;match&quot;: {
            &quot;address&quot;: &quot;Mill&quot;
          }
        }
      ],
      &quot;must_not&quot;: [
        {
          &quot;match&quot;: {
            &quot;age&quot;: 18
          }
        }
      ],
      &quot;should&quot;: [
        {
          &quot;match&quot;: {
            &quot;lastname&quot;: &quot;Holland&quot;
          }
        }
      ],
      &quot;filter&quot;: {
          &quot;range&quot;: {
            &quot;age&quot;: {
              &quot;gte&quot;: 18,
              &quot;lte&quot;: 30
            }
          }
      }
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šfilter æœ€å¥½æ˜¯æ”¾åœ¨æœ€åè¿‡æ»¤ï¼Œè¿™æ ·ä¸ä¼šå½±å“æŸ¥è¯¢æ¡ä»¶å’Œç›¸å…³æ€§å¾—åˆ†ã€‚<code>filter</code>ä¸­è¿˜å¯ä»¥å†æ¬¡è¿›è¡Œ<code>bool</code>ç»„åˆæ¡ä»¶è¿‡æ»¤ã€‚</p><p><img src="/assets/true-image-20210908173825031-104b9835.png" alt=""></p><p><img src="/assets/true-image-20210908173957845-fd26978e.png" alt=""></p><h3 id="_8-8-æ’åº-sort" tabindex="-1"><a class="header-anchor" href="#_8-8-æ’åº-sort" aria-hidden="true">#</a> 8.8 æ’åºï¼ˆsortï¼‰</h3><p><code>sort</code> å¯ä»¥è®©æˆ‘ä»¬æŒ‰ç…§ä¸åŒçš„å­—æ®µè¿›è¡Œæ’åºï¼Œå¹¶ä¸”é€šè¿‡<code>order</code>æŒ‡å®šæ’åºçš„æ–¹å¼</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³æ‰‹æœº&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;desc&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-9-åˆ†é¡µ-from-size" tabindex="-1"><a class="header-anchor" href="#_8-9-åˆ†é¡µ-from-size" aria-hidden="true">#</a> 8.9 åˆ†é¡µï¼ˆfrom/sizeï¼‰</h3><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³æ‰‹æœº&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>fromï¼šä»é‚£ä¸€æ¡å¼€å§‹</p><p>sizeï¼šå–å¤šå°‘æ¡</p><h3 id="_8-10-é«˜äº®-highlight" tabindex="-1"><a class="header-anchor" href="#_8-10-é«˜äº®-highlight" aria-hidden="true">#</a> 8.10 é«˜äº®ï¼ˆhighlightï¼‰</h3><p>å‘ç°ï¼šé«˜äº®çš„æœ¬è´¨æ˜¯ç»™å…³é”®å­—æ·»åŠ äº† <code>&lt;em&gt;</code> æ ‡ç­¾ï¼Œåœ¨å‰ç«¯å†ç»™è¯¥æ ‡ç­¾æ·»åŠ æ ·å¼å³å¯ã€‚</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;highlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token property">&quot;pre_tags&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;em&gt;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;post_tags&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;/em&gt;&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>fieldsï¼šé«˜äº®å­—æ®µ</p><p>pre_tagsï¼šå‰ç½®æ ‡ç­¾</p><p>post_tagsï¼šåç½®æ ‡ç­¾</p><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š</p><h3 id="_8-11-ç»“æœè¿‡æ»¤-source" tabindex="-1"><a class="header-anchor" href="#_8-11-ç»“æœè¿‡æ»¤-source" aria-hidden="true">#</a> 8.11 ç»“æœè¿‡æ»¤ï¼ˆ_sourceï¼‰</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œelasticsearchåœ¨æœç´¢çš„ç»“æœä¸­ï¼Œä¼šæŠŠæ–‡æ¡£ä¸­ä¿å­˜åœ¨<code>_source</code>çš„æ‰€æœ‰å­—æ®µéƒ½è¿”å›ã€‚</p><p>å¦‚æœæˆ‘ä»¬åªæƒ³è·å–å…¶ä¸­çš„éƒ¨åˆ†å­—æ®µï¼Œå¯ä»¥æ·»åŠ <code>_source</code>çš„è¿‡æ»¤</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">2699</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›ç»“æœï¼Œåªæœ‰ä¸¤ä¸ªå­—æ®µï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">2699</span><span class="token punctuation">,</span>
          <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;vivoæ‰‹æœº&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-èšåˆ-aggregations" tabindex="-1"><a class="header-anchor" href="#_9-èšåˆ-aggregations" aria-hidden="true">#</a> 9 èšåˆï¼ˆaggregationsï¼‰</h2><p><em>æœç´¢addressä¸­åŒ…å«millçš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œä½†ä¸æ˜¾ç¤ºè¿™äº›äººçš„è¯¦æƒ…</em></p><p>GET bank/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mill&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;balanceAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>æŒ‰ç…§å¹´é¾„èšåˆï¼Œå¹¶ä¸”è¯·æ±‚è¿™äº›å¹´é¾„æ®µçš„è¿™äº›äººçš„å¹³å‡è–ªèµ„</em></p><p>GET bank/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>æŸ¥å‡ºæ‰€æœ‰å¹´é¾„åˆ†å¸ƒï¼Œå¹¶ä¸”è¿™äº›å¹´éš†æ®µä¸­Mçš„å¹³å‡è–ªèµ„å’ŒFçš„å¹³å‡è–ªèµ„ä»¥åŠè¿™ä¸ªå¹´é¾„æ®µçš„æ€»ä½“å¹³å‡è–ªèµ„</em></p><p>GET bank/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;match_all&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ageAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;genderAgg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gender.keyword&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> 
          <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;balanceAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ageAvg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>èšåˆå¯ä»¥è®©æˆ‘ä»¬æå…¶æ–¹ä¾¿çš„å®ç°å¯¹æ•°æ®çš„ç»Ÿè®¡ã€åˆ†æã€‚ä¾‹å¦‚ï¼š</p><ul><li>ä»€ä¹ˆå“ç‰Œçš„æ‰‹æœºæœ€å—æ¬¢è¿ï¼Ÿ</li><li>è¿™äº›æ‰‹æœºçš„å¹³å‡ä»·æ ¼ã€æœ€é«˜ä»·æ ¼ã€æœ€ä½ä»·æ ¼ï¼Ÿ</li><li>è¿™äº›æ‰‹æœºæ¯æœˆçš„é”€å”®æƒ…å†µå¦‚ä½•ï¼Ÿ</li></ul><p>å®ç°è¿™äº›ç»Ÿè®¡åŠŸèƒ½çš„æ¯”æ•°æ®åº“çš„sqlè¦æ–¹ä¾¿çš„å¤šï¼Œè€Œä¸”æŸ¥è¯¢é€Ÿåº¦éå¸¸å¿«ï¼Œå¯ä»¥å®ç°å®æ—¶æœç´¢æ•ˆæœã€‚</p><h3 id="_9-1-åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_9-1-åŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> 9.1 åŸºæœ¬æ¦‚å¿µ</h3><p>Elasticsearchä¸­çš„èšåˆï¼ŒåŒ…å«å¤šç§ç±»å‹ï¼Œæœ€å¸¸ç”¨çš„ä¸¤ç§ï¼Œä¸€ä¸ªå«<code>æ¡¶</code>ï¼Œä¸€ä¸ªå«<code>åº¦é‡</code>ï¼š</p><p><strong>æ¡¶ï¼ˆbucketï¼‰</strong></p><p>æ¡¶çš„ä½œç”¨ï¼Œæ˜¯æŒ‰ç…§æŸç§æ–¹å¼å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œæ¯ä¸€ç»„æ•°æ®åœ¨ESä¸­ç§°ä¸ºä¸€ä¸ª<code>æ¡¶</code>ï¼Œä¾‹å¦‚æˆ‘ä»¬æ ¹æ®å›½ç±å¯¹äººåˆ’åˆ†ï¼Œå¯ä»¥å¾—åˆ°<code>ä¸­å›½æ¡¶</code>ã€<code>è‹±å›½æ¡¶</code>ï¼Œ<code>æ—¥æœ¬æ¡¶</code> æˆ–è€…æˆ‘ä»¬æŒ‰ç…§å¹´é¾„æ®µå¯¹äººè¿›è¡Œåˆ’åˆ†ï¼š<code>0~10,10~20,20~30,30~40</code>ç­‰ã€‚</p><p>Elasticsearchä¸­æä¾›çš„åˆ’åˆ†æ¡¶çš„æ–¹å¼æœ‰å¾ˆå¤šï¼š</p><ul><li>Date Histogram Aggregationï¼šæ ¹æ®æ—¥æœŸé˜¶æ¢¯åˆ†ç»„ï¼Œä¾‹å¦‚ç»™å®šé˜¶æ¢¯ä¸ºå‘¨ï¼Œä¼šè‡ªåŠ¨æ¯å‘¨åˆ†ä¸ºä¸€ç»„</li><li>Histogram Aggregationï¼šæ ¹æ®æ•°å€¼é˜¶æ¢¯åˆ†ç»„ï¼Œä¸æ—¥æœŸç±»ä¼¼</li><li>Terms Aggregationï¼šæ ¹æ®è¯æ¡å†…å®¹åˆ†ç»„ï¼Œè¯æ¡å†…å®¹å®Œå…¨åŒ¹é…çš„ä¸ºä¸€ç»„</li><li>Range Aggregationï¼šæ•°å€¼å’Œæ—¥æœŸçš„èŒƒå›´åˆ†ç»„ï¼ŒæŒ‡å®šå¼€å§‹å’Œç»“æŸï¼Œç„¶åæŒ‰æ®µåˆ†ç»„</li></ul><p>bucket aggregations åªè´Ÿè´£å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¹¶ä¸è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤å¾€å¾€bucketä¸­å¾€å¾€ä¼šåµŒå¥—å¦ä¸€ç§èšåˆï¼šmetrics aggregationså³åº¦é‡</p><p><strong>åº¦é‡ï¼ˆmetricsï¼‰</strong></p><p>åˆ†ç»„å®Œæˆä»¥åï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå¯¹ç»„ä¸­çš„æ•°æ®è¿›è¡Œèšåˆè¿ç®—ï¼Œä¾‹å¦‚æ±‚å¹³å‡å€¼ã€æœ€å¤§ã€æœ€å°ã€æ±‚å’Œç­‰ï¼Œè¿™äº›åœ¨ESä¸­ç§°ä¸º<code>åº¦é‡</code></p><p>æ¯”è¾ƒå¸¸ç”¨çš„ä¸€äº›åº¦é‡èšåˆæ–¹å¼ï¼š</p><ul><li>Avg Aggregationï¼šæ±‚å¹³å‡å€¼</li><li>Max Aggregationï¼šæ±‚æœ€å¤§å€¼</li><li>Min Aggregationï¼šæ±‚æœ€å°å€¼</li><li>Percentiles Aggregationï¼šæ±‚ç™¾åˆ†æ¯”</li><li>Stats Aggregationï¼šåŒæ—¶è¿”å›avgã€maxã€minã€sumã€countç­‰</li><li>Sum Aggregationï¼šæ±‚å’Œ</li><li>Top hits Aggregationï¼šæ±‚å‰å‡ </li><li>Value Count Aggregationï¼šæ±‚æ€»æ•°</li></ul><h3 id="_9-2-èšåˆä¸ºæ¡¶" tabindex="-1"><a class="header-anchor" href="#_9-2-èšåˆä¸ºæ¡¶" aria-hidden="true">#</a> 9.2 èšåˆä¸ºæ¡¶</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬æŒ‰ç…§æ‰‹æœºçš„å“ç‰Œ<code>attr.brand.keyword</code>æ¥åˆ’åˆ†<code>æ¡¶</code></p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;size&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token property">&quot;terms&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
              <span class="token property">&quot;field&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;attr.brand.keyword&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>sizeï¼š æŸ¥è¯¢æ¡æ•°ï¼Œè¿™é‡Œè®¾ç½®ä¸º0ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å…³å¿ƒæœç´¢åˆ°çš„æ•°æ®ï¼Œåªå…³å¿ƒèšåˆç»“æœï¼Œæé«˜æ•ˆç‡</li><li>aggsï¼šå£°æ˜è¿™æ˜¯ä¸€ä¸ªèšåˆæŸ¥è¯¢ï¼Œæ˜¯aggregationsçš„ç¼©å†™ <ul><li>brandsï¼šç»™è¿™æ¬¡èšåˆèµ·ä¸€ä¸ªåå­—ï¼Œä»»æ„ã€‚ <ul><li>termsï¼šåˆ’åˆ†æ¡¶çš„æ–¹å¼ï¼Œè¿™é‡Œæ˜¯æ ¹æ®è¯æ¡åˆ’åˆ† <ul><li>fieldï¼šåˆ’åˆ†æ¡¶çš„å­—æ®µ</li></ul></li></ul></li></ul></li></ul><p>ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">124</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;åä¸º&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;oppo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;vivo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>hitsï¼šæŸ¥è¯¢ç»“æœä¸ºç©ºï¼Œå› ä¸ºæˆ‘ä»¬è®¾ç½®äº†sizeä¸º0</li><li>aggregationsï¼šèšåˆçš„ç»“æœ</li><li>brandsï¼šæˆ‘ä»¬å®šä¹‰çš„èšåˆåç§°</li><li>bucketsï¼šæŸ¥æ‰¾åˆ°çš„æ¡¶ï¼Œæ¯ä¸ªä¸åŒçš„å“ç‰Œå­—æ®µå€¼éƒ½ä¼šå½¢æˆä¸€ä¸ªæ¡¶ <ul><li>keyï¼šè¿™ä¸ªæ¡¶å¯¹åº”çš„å“ç‰Œå­—æ®µçš„å€¼</li><li>doc_countï¼šè¿™ä¸ªæ¡¶ä¸­çš„æ–‡æ¡£æ•°é‡</li></ul></li></ul><h3 id="_9-3-æ¡¶å†…åº¦é‡" tabindex="-1"><a class="header-anchor" href="#_9-3-æ¡¶å†…åº¦é‡" aria-hidden="true">#</a> 9.3 æ¡¶å†…åº¦é‡</h3><p>å‰é¢çš„ä¾‹å­å‘Šè¯‰æˆ‘ä»¬æ¯ä¸ªæ¡¶é‡Œé¢çš„æ–‡æ¡£æ•°é‡ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚ ä½†é€šå¸¸ï¼Œæˆ‘ä»¬çš„åº”ç”¨éœ€è¦æä¾›æ›´å¤æ‚çš„æ–‡æ¡£åº¦é‡ã€‚ ä¾‹å¦‚ï¼Œæ¯ç§å“ç‰Œæ‰‹æœºçš„å¹³å‡ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿ</p><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰Elasticsearch<code>ä½¿ç”¨å“ªä¸ªå­—æ®µ</code>ï¼Œ<code>ä½¿ç”¨ä½•ç§åº¦é‡æ–¹å¼</code>è¿›è¡Œè¿ç®—ï¼Œè¿™äº›ä¿¡æ¯è¦åµŒå¥—åœ¨<code>æ¡¶</code>å†…ï¼Œ<code>åº¦é‡</code>çš„è¿ç®—ä¼šåŸºäº<code>æ¡¶</code>å†…çš„æ–‡æ¡£è¿›è¡Œ</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬ä¸ºåˆšåˆšçš„èšåˆç»“æœæ·»åŠ  æ±‚ä»·æ ¼å¹³å‡å€¼çš„åº¦é‡ï¼š</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;size&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token property">&quot;terms&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
              <span class="token property">&quot;field&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;attr.brand.keyword&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token property">&quot;avg_price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
                   <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;price&quot;</span> 
                   <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>aggsï¼šæˆ‘ä»¬åœ¨ä¸Šä¸€ä¸ªaggs(brands)ä¸­æ·»åŠ æ–°çš„aggsã€‚å¯è§<code>åº¦é‡</code>ä¹Ÿæ˜¯ä¸€ä¸ªèšåˆ</li><li>avg_priceï¼šèšåˆçš„åç§°</li><li>avgï¼šåº¦é‡çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯æ±‚å¹³å‡å€¼</li><li>fieldï¼šåº¦é‡è¿ç®—çš„å­—æ®µ</li></ul><p>ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">41</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;åä¸º&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3999.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3499.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;oppo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2799.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;vivo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2699.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°æ¯ä¸ªæ¡¶ä¸­éƒ½æœ‰è‡ªå·±çš„<code>avg_price</code>å­—æ®µï¼Œè¿™æ˜¯åº¦é‡èšåˆçš„ç»“æœ</p><h3 id="_9-4-æ¡¶å†…åµŒå¥—æ¡¶" tabindex="-1"><a class="header-anchor" href="#_9-4-æ¡¶å†…åµŒå¥—æ¡¶" aria-hidden="true">#</a> 9.4 æ¡¶å†…åµŒå¥—æ¡¶</h3><p>åˆšåˆšçš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨æ¡¶å†…åµŒå¥—åº¦é‡è¿ç®—ã€‚äº‹å®ä¸Šæ¡¶ä¸ä»…å¯ä»¥åµŒå¥—è¿ç®—ï¼Œ è¿˜å¯ä»¥å†åµŒå¥—å…¶å®ƒæ¡¶ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ¯ä¸ªåˆ†ç»„ä¸­ï¼Œå†åˆ†æ›´å¤šç»„ã€‚</p><p>æ¯”å¦‚ï¼šæˆ‘ä»¬æƒ³ç»Ÿè®¡æ¯ä¸ªå“ç‰Œéƒ½ç”Ÿäº§äº†é‚£äº›äº§å“ï¼ŒæŒ‰ç…§<code>attr.category.keyword</code>å­—æ®µå†è¿›è¡Œåˆ†æ¡¶</p><p>GET /atguigu/_search</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;size&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;aggs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token property">&quot;terms&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> 
              <span class="token property">&quot;field&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;attr.brand.keyword&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;aggs&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token property">&quot;avg_price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
                   <span class="token property">&quot;avg&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;price&quot;</span> 
                   <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;categorys&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;terms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;attr.category.keyword&quot;</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éƒ¨åˆ†ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_shards&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;successful&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;skipped&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;failed&quot;</span> <span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token property">&quot;max_score&quot;</span> <span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aggregations&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;brands&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;åä¸º&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">3</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ç¬”è®°æœ¬&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3999.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;å°ç±³&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">2</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ç”µè§†&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ç¬”è®°æœ¬&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3499.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;oppo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2799.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;vivo&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token property">&quot;categorys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;doc_count_error_upper_bound&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sum_other_doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;buckets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;doc_count&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;avg_price&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">2699.0</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ–°çš„èšåˆ<code>categorys</code>è¢«åµŒå¥—åœ¨åŸæ¥æ¯ä¸€ä¸ª<code>brands</code>çš„æ¡¶ä¸­ã€‚</li><li>æ¯ä¸ªå“ç‰Œä¸‹é¢éƒ½æ ¹æ® <code>attr.category.keyword</code>å­—æ®µè¿›è¡Œäº†åˆ†ç»„</li><li>æˆ‘ä»¬èƒ½è¯»å–åˆ°çš„ä¿¡æ¯ï¼š <ul><li>åä¸ºæœ‰4ä¸­äº§å“</li><li>åä¸ºäº§å“çš„å¹³å‡å”®ä»·æ˜¯ 3999.0ç¾å…ƒã€‚</li><li>å…¶ä¸­3ç§æ‰‹æœºäº§å“ï¼Œ1ç§ç¬”è®°æœ¬äº§å“</li></ul></li></ul><h2 id="_10-springdata-elasticsearch" tabindex="-1"><a class="header-anchor" href="#_10-springdata-elasticsearch" aria-hidden="true">#</a> 10 SpringData-Elasticsearch</h2><h3 id="_10-1-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_10-1-ä»‹ç»" aria-hidden="true">#</a> 10.1 ä»‹ç»</h3><p>ç›®å‰å¸‚é¢ä¸Šæœ‰ä¸¤ç±»å®¢æˆ·ç«¯</p><p>ä¸€ç±»æ˜¯TransportClient ä¸ºä»£è¡¨çš„ESåŸç”Ÿå®¢æˆ·ç«¯ï¼Œä¸èƒ½æ‰§è¡ŒåŸç”Ÿdslè¯­å¥å¿…é¡»ä½¿ç”¨å®ƒçš„Java apiæ–¹æ³•ã€‚</p><p>å¦å¤–ä¸€ç§æ˜¯ä»¥Rest Apiä¸ºä¸»çš„missing clientï¼Œæœ€å…¸å‹çš„å°±æ˜¯jestã€‚ è¿™ç§å®¢æˆ·ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨dslè¯­å¥æ‹¼æˆçš„å­—ç¬¦ä¸²ï¼Œç›´æ¥ä¼ ç»™æœåŠ¡ç«¯ï¼Œç„¶åè¿”å›jsonå­—ç¬¦ä¸²å†è§£æã€‚</p><p>ä¸¤ç§æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼Œä½†æ˜¯æœ€è¿‘elasticsearchå®˜ç½‘ï¼Œå®£å¸ƒè®¡åˆ’åœ¨7.0ä»¥åçš„ç‰ˆæœ¬ä¸­åºŸé™¤TransportClientã€‚ä»¥RestClientä¸ºä¸»ã€‚</p><p>ç”±äºåŸç”Ÿçš„Elasticsearchå®¢æˆ·ç«¯APIéå¸¸éº»çƒ¦ã€‚æ‰€ä»¥è¿™é‡Œç›´æ¥å­¦ä¹ Springæä¾›çš„å¥—ä»¶ï¼šSpring Data Elasticsearchã€‚</p><p><strong>spring-data-Elasticsearch ä½¿ç”¨ä¹‹å‰,å¿…é¡»å…ˆç¡®å®šç‰ˆæœ¬,elasticsearch å¯¹ç‰ˆæœ¬çš„è¦æ±‚æ¯”è¾ƒé«˜ã€‚</strong></p><p>java-APIé€‰æ‹©ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/client/index.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/client/index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>é€‰æ‹©ï¼šJava REST Client <a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/index.html" target="_blank" rel="noopener noreferrer">7.14]<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>â€‰=&gt; JavaHighLevelRESTClient <a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html" target="_blank" rel="noopener noreferrer">æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_10-2-åˆ›å»ºspringboot-é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_10-2-åˆ›å»ºspringboot-é¡¹ç›®" aria-hidden="true">#</a> 10.2 åˆ›å»ºspringboot é¡¹ç›®</h3><p>åˆ›å»ºå•ç‹¬é¡¹ç›® yumall-search</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;properties&gt;
    &lt;elasticsearch.version&gt;7.14.0&lt;/elasticsearch.version&gt;
&lt;/properties&gt; 	

&lt;dependency&gt;
     &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;
     &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;
     &lt;version&gt;7.14.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;
            &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;
            &lt;artifactId&gt;transport&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;
    &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;
    &lt;version&gt;6.8.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;
    &lt;artifactId&gt;transport&lt;/artifactId&gt;
    &lt;version&gt;6.8.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŠ å…¥nacosã€commonã€@EnableDiscoveryClient</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment">#å¼€å¯æœåŠ¡å‘ç°</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-3-banæµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_10-3-banæµ‹è¯•" aria-hidden="true">#</a> 10.3 banæµ‹è¯•</h3><p>åˆ›å»ºé…ç½®ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token comment">//   RestClient builder = RestClient.builder(new HttpHost(&quot;192.168.101.5&quot;, 9200, &quot;http&quot;));</span>
 <span class="token comment">//   new RestHighLevelClient(builder);</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Autowired</span>
  <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getClientBan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//null</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">///Junit4 æµ‹è¯•ç±»åŠ ä¸Šæ³¨è§£ï¼Œåœ¨è¿è¡Œï¼šorg.elasticsearch.client.RestHighLevelClient@6f6f65a4</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoTesst</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-4-æµ‹è¯•ä¿å­˜" tabindex="-1"><a class="header-anchor" href="#_10-4-æµ‹è¯•ä¿å­˜" aria-hidden="true">#</a> 10.4 æµ‹è¯•ä¿å­˜</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoTest</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">indexData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">IndexRequest</span> indexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    indexRequest<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        indexRequest.source(&quot;name&quot;,&quot;xiaoyu&quot;,&quot;age&quot;,&quot;19&quot;);</span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;å°å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token string">&quot;ç”·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> jsonString <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    indexRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span><span class="token constant">JSON</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¦ä¿å­˜çš„æ•°æ®json</span>
    <span class="token comment">//å¼€å§‹ä¿å­˜</span>
    <span class="token class-name">IndexResponse</span> indexResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexRequest<span class="token punctuation">,</span> <span class="token class-name">ElasticSearchConfig</span><span class="token punctuation">.</span><span class="token constant">COMMON_OPTIONS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;indexResponse = &quot;</span> <span class="token operator">+</span> indexResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-5-æµ‹è¯•æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_10-5-æµ‹è¯•æ£€ç´¢" aria-hidden="true">#</a> 10.5 æµ‹è¯•æ£€ç´¢</h3><h4 id="ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç»“æ„" aria-hidden="true">#</a> ç»“æ„ï¼š</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>//1ã€åˆ›å»ºæ£€ç´¢è¯·æ±‚ SearchRequest &gt; sourceBuilder[æ·»åŠ èšåˆï¼Ÿ] &gt; searchRequest.source(sourceBuilder);
//2ã€æ‰§è¡Œç»“æœ SearchResponse=client.search(searchRequest,è‡ªå®šä¹‰OPTIONS);
//3ã€åˆ†æç»“æœ searchResponse:getHitsè·å–æ•°æ®,getAggregationsè·å–èšåˆ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹" aria-hidden="true">#</a> å®ä¾‹ï¼š</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">serachData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">//1ã€åˆ›å»ºæ£€ç´¢è¯·æ±‚</span>
    <span class="token class-name">SearchRequest</span> searchRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æŒ‡å®šç´¢å¼•</span>
    searchRequest<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;bank&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//æŒ‡å®šDSLï¼Œæ£€ç´¢æ¡ä»¶</span>
    <span class="token comment">//SearchSourceBuilder sourceBuilde å°è£…çš„æ¡ä»¶</span>
    <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1.1)ã€æ„é€ æ£€ç´¢æ¡ä»¶</span>
    <span class="token comment">//sourceBuilder.query();</span>
    <span class="token comment">//sourceBuilder.from();</span>
    <span class="token comment">//sourceBuilder.size();</span>
    <span class="token comment">//sourceBuilder.aggregatipn()</span>
    sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mill&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//1.2)ã€æŒ‰ç…§å¹´é¾„çš„å€¼åˆ†å¸ƒè¿›è¡Œèšåˆ</span>
    <span class="token class-name">TermsAggregationBuilder</span> ageAgg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">terms</span><span class="token punctuation">(</span><span class="token string">&quot;ageAgg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>ageAgg<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//1.3)ã€å¹³å‡è–ªèµ„</span>
    <span class="token class-name">AvgAggregationBuilder</span> balanceAvg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;balanceAvg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;balance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>balanceAvg<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ£€ç´¢æ¡ä»¶ï¼š&quot;</span> <span class="token operator">+</span> sourceBuilder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//è¦æ£€ç´¢å†…å®¹</span>
    searchRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2ã€æ‰§è¡Œç»“æœ        SearchResponse</span>
    <span class="token class-name">SearchResponse</span> searchResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>searchRequest<span class="token punctuation">,</span> <span class="token class-name">ElasticSearchConfig</span><span class="token punctuation">.</span><span class="token constant">COMMON_OPTIONS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//3ã€åˆ†æç»“æœ</span>
<span class="token comment">//        System.out.println(&quot;æ£€ç´¢ç»“æœï¼š&quot; + searchResponse.toString());</span>
<span class="token comment">//        Map map = JSON.parseObject(searchResponse.toString(), Map.class);</span>
    <span class="token comment">//3.1)ã€è·å–æ‰€æœ‰æ•°æ®;</span>
    <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> searchHits <span class="token operator">=</span> hits<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> hit <span class="token operator">:</span> searchHits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">/*
                &quot;_index&quot;:&quot;bank&quot;,
                &quot;_type&quot;:&quot;account&quot;,
                &quot;_id&quot;:&quot;970&quot;,
                &quot;_score&quot;:5.4032025,
                &quot;_source&quot;:{æ•°æ®
             */</span>
<span class="token comment">//            hit.getIndex();hit.getType();hit.getId();</span>
      <span class="token class-name">String</span> string <span class="token operator">=</span> hit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">Account</span> account <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;account = &quot;</span> <span class="token operator">+</span> account<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//3.2)ã€è·å–è¿™æ¬¡æ£€ç´¢åˆ°çš„åˆ†æä¿¡æ¯;</span>
    <span class="token class-name">Aggregations</span> aggregations <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getAggregations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Aggregation</span> aggregation <span class="token operator">:</span> aggregations<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å½“å‰èšåˆ&quot;</span> <span class="token operator">+</span> aggregation<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Terms</span> ageAgg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;ageAgg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Terms<span class="token punctuation">.</span>Bucket</span> bucket <span class="token operator">:</span> ageAgg1<span class="token punctuation">.</span><span class="token function">getBuckets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">String</span> keyAsString <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">getKeyAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¹´é¾„: &quot;</span> <span class="token operator">+</span> keyAsString <span class="token operator">+</span> <span class="token string">&quot;==&gt;&quot;</span> <span class="token operator">+</span> bucket<span class="token punctuation">.</span><span class="token function">getDocCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/true-image-20210909151150060-1b96817a.png" alt=""></p><h3 id="_10-6-åˆ›å»ºmodule" tabindex="-1"><a class="header-anchor" href="#_10-6-åˆ›å»ºmodule" aria-hidden="true">#</a> 10.6 åˆ›å»ºmodule</h3><p>åœ¨application.propertiesä¸­æ·»åŠ é…ç½®</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.elasticsearch.rest.uris</span><span class="token punctuation">=</span><span class="token value attr-value">http://172.16.116.100:9200</span>
<span class="token comment"># é›†ç¾¤æƒ…å†µä¸‹</span>
<span class="token key attr-name">spring.elasticsearch.rest.uris[0]</span><span class="token punctuation">=</span><span class="token value attr-value">http://172.16.116.100:9200</span>
<span class="token key attr-name">spring.elasticsearch.rest.uris[1]</span><span class="token punctuation">=</span><span class="token value attr-value">http://172.16.116.100:9200</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-7-å®ä½“ç±»" tabindex="-1"><a class="header-anchor" href="#_10-7-å®ä½“ç±»" aria-hidden="true">#</a> 10.7 å®ä½“ç±»</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> shards <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> replicas <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> analyzer <span class="token operator">=</span> <span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Integer</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Keyword</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spring Dataé€šè¿‡æ³¨è§£æ¥å£°æ˜å­—æ®µçš„æ˜ å°„å±æ€§ï¼Œæœ‰ä¸‹é¢çš„ä¸‰ä¸ªæ³¨è§£ï¼š</p><ul><li><code>@Document</code> ä½œç”¨åœ¨ç±»ï¼Œæ ‡è®°å®ä½“ç±»ä¸ºæ–‡æ¡£å¯¹è±¡ï¼Œä¸€èˆ¬æœ‰å››ä¸ªå±æ€§ <ul><li>indexNameï¼šå¯¹åº”ç´¢å¼•åº“åç§°</li><li>typeï¼šå¯¹åº”åœ¨ç´¢å¼•åº“ä¸­çš„ç±»å‹</li><li>shardsï¼šåˆ†ç‰‡æ•°é‡ï¼Œé»˜è®¤5</li><li>replicasï¼šå‰¯æœ¬æ•°é‡ï¼Œé»˜è®¤1</li></ul></li><li><code>@Id</code> ä½œç”¨åœ¨æˆå‘˜å˜é‡ï¼Œæ ‡è®°ä¸€ä¸ªå­—æ®µä½œä¸ºidä¸»é”®</li><li><code>@Field</code> ä½œç”¨åœ¨æˆå‘˜å˜é‡ï¼Œæ ‡è®°ä¸ºæ–‡æ¡£çš„å­—æ®µï¼Œå¹¶æŒ‡å®šå­—æ®µæ˜ å°„å±æ€§ï¼š <ul><li>typeï¼šå­—æ®µç±»å‹ï¼Œå–å€¼æ˜¯æšä¸¾ï¼šFieldType</li><li>indexï¼šæ˜¯å¦ç´¢å¼•ï¼Œå¸ƒå°”ç±»å‹ï¼Œé»˜è®¤æ˜¯true</li><li>storeï¼šæ˜¯å¦å­˜å‚¨ï¼Œå¸ƒå°”ç±»å‹ï¼Œé»˜è®¤æ˜¯false</li><li>analyzerï¼šåˆ†è¯å™¨åç§°ï¼šik_max_word</li></ul></li></ul><h3 id="_10-8-åˆ›å»ºç´¢å¼•åŠæ˜ å°„" tabindex="-1"><a class="header-anchor" href="#_10-8-åˆ›å»ºç´¢å¼•åŠæ˜ å°„" aria-hidden="true">#</a> 10.8 åˆ›å»ºç´¢å¼•åŠæ˜ å°„</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">EsDemoApplicationTests</span> <span class="token punctuation">{</span>

    <span class="token comment">// ElasticsearchTemplate æ˜¯ TransportClient å®¢æˆ·ç«¯</span>
    <span class="token comment">// ElasticsearchRestTemplate æ˜¯ RestHighLevel å®¢æˆ·ç«¯</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ElasticsearchRestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»ºç´¢å¼•</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ›å»ºæ˜ å°„</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate<span class="token punctuation">.</span><span class="token function">putMapping</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ é™¤ç´¢å¼•</span>
        <span class="token comment">// this.restTemplate.deleteIndex(&quot;user&quot;);</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-9-repositoryæ–‡æ¡£æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_10-9-repositoryæ–‡æ¡£æ“ä½œ" aria-hidden="true">#</a> 10.9 Repositoryæ–‡æ¡£æ“ä½œ</h3><p>Spring Data çš„å¼ºå¤§ä¹‹å¤„ï¼Œå°±åœ¨äºä½ ä¸ç”¨å†™ä»»ä½•DAOå¤„ç†ï¼Œè‡ªåŠ¨æ ¹æ®æ–¹æ³•åæˆ–ç±»çš„ä¿¡æ¯è¿›è¡ŒCRUDæ“ä½œã€‚åªè¦ä½ å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç„¶åç»§æ‰¿Repositoryæä¾›çš„ä¸€äº›å­æ¥å£ï¼Œå°±èƒ½å…·å¤‡å„ç§åŸºæœ¬çš„CRUDåŠŸèƒ½ã€‚</p><p>å…¶ä¸­ElasticsearchRepositoryæ¥å£åŠŸèƒ½æœ€å¼ºå¤§ã€‚è¯¥æ¥å£çš„æ–¹æ³•åŒ…æ‹¬ï¼š</p><h4 id="_10-9-1-æ–°å¢" tabindex="-1"><a class="header-anchor" href="#_10-9-1-æ–°å¢" aria-hidden="true">#</a> 10.9.1 æ–°å¢</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Autowired</span>
  <span class="token class-name">UserRepository</span> userRepository<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">void</span> <span class="token function">testAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token string">&quot;zhang3&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹å’Œæ–°å¢æ˜¯åŒä¸€ä¸ªæ¥å£ï¼ŒåŒºåˆ†çš„ä¾æ®å°±æ˜¯idï¼Œè¿™ä¸€ç‚¹è·Ÿæˆ‘ä»¬åœ¨é¡µé¢å‘èµ·PUTè¯·æ±‚æ˜¯ç±»ä¼¼çš„ã€‚</p><h4 id="_10-9-2-åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_10-9-2-åˆ é™¤" aria-hidden="true">#</a> 10.9.2 åˆ é™¤</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">void</span> <span class="token function">testDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-10-æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_10-10-æŸ¥è¯¢" aria-hidden="true">#</a> 10.10 æŸ¥è¯¢</h3><h4 id="_10-10-1-åŸºæœ¬æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_10-10-1-åŸºæœ¬æŸ¥è¯¢" aria-hidden="true">#</a> 10.10.1 åŸºæœ¬æŸ¥è¯¢</h4><p>æŸ¥è¯¢ä¸€ä¸ªï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">void</span> <span class="token function">testFind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-10-2-æ¡ä»¶æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_10-10-2-æ¡ä»¶æŸ¥è¯¢" aria-hidden="true">#</a> 10.10.2 æ¡ä»¶æŸ¥è¯¢</h4><p>Spring Data çš„å¦ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ï¼Œæ˜¯æ ¹æ®æ–¹æ³•åç§°è‡ªåŠ¨å®ç°åŠŸèƒ½ã€‚</p><p>æ¯”å¦‚ï¼šä½ çš„æ–¹æ³•åå«åšï¼šfindByTitleï¼Œé‚£ä¹ˆå®ƒå°±çŸ¥é“ä½ æ˜¯æ ¹æ®titleæŸ¥è¯¢ï¼Œç„¶åè‡ªåŠ¨å¸®ä½ å®Œæˆï¼Œæ— éœ€å†™å®ç°ç±»ã€‚</p><p>å½“ç„¶ï¼Œæ–¹æ³•åç§°è¦ç¬¦åˆä¸€å®šçš„çº¦å®šï¼š</p><table><thead><tr><th>Keyword</th><th>Sample</th><th>Elasticsearch Query String</th></tr></thead><tbody><tr><td><code>And</code></td><td><code>findByNameAndPrice</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;price&quot; : &quot;?&quot;}} ]}}</code></td></tr><tr><td><code>Or</code></td><td><code>findByNameOrPrice</code></td><td><code>{&quot;bool&quot; : {&quot;should&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;price&quot; : &quot;?&quot;}} ]}}</code></td></tr><tr><td><code>Is</code></td><td><code>findByName</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}</code></td></tr><tr><td><code>Not</code></td><td><code>findByNameNot</code></td><td><code>{&quot;bool&quot; : {&quot;must_not&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}</code></td></tr><tr><td><code>Between</code></td><td><code>findByPriceBetween</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>LessThanEqual</code></td><td><code>findByPriceLessThan</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>GreaterThanEqual</code></td><td><code>findByPriceGreaterThan</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : null,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>Before</code></td><td><code>findByPriceBefore</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : null,&quot;to&quot; : ?,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>After</code></td><td><code>findByPriceAfter</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;range&quot; : {&quot;price&quot; : {&quot;from&quot; : ?,&quot;to&quot; : null,&quot;include_lower&quot; : true,&quot;include_upper&quot; : true}}}}}</code></td></tr><tr><td><code>Like</code></td><td><code>findByNameLike</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;?*&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>StartingWith</code></td><td><code>findByNameStartingWith</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;?*&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>EndingWith</code></td><td><code>findByNameEndingWith</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;*?&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>Contains/Containing</code></td><td><code>findByNameContaining</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;name&quot; : {&quot;query&quot; : &quot;**?**&quot;,&quot;analyze_wildcard&quot; : true}}}}}</code></td></tr><tr><td><code>In</code></td><td><code>findByNameIn(Collection&lt;String&gt;names)</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;bool&quot; : {&quot;should&quot; : [ {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}, {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}} ]}}}}</code></td></tr><tr><td><code>NotIn</code></td><td><code>findByNameNotIn(Collection&lt;String&gt;names)</code></td><td><code>{&quot;bool&quot; : {&quot;must_not&quot; : {&quot;bool&quot; : {&quot;should&quot; : {&quot;field&quot; : {&quot;name&quot; : &quot;?&quot;}}}}}}</code></td></tr><tr><td><code>Near</code></td><td><code>findByStoreNear</code></td><td><code>Not Supported Yet !</code></td></tr><tr><td><code>True</code></td><td><code>findByAvailableTrue</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : true}}}}</code></td></tr><tr><td><code>False</code></td><td><code>findByAvailableFalse</code></td><td><code>{&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : false}}}}</code></td></tr><tr><td><code>OrderBy</code></td><td><code>findByAvailableTrueOrderByNameDesc</code></td><td><code>{&quot;sort&quot; : [{ &quot;name&quot; : {&quot;order&quot; : &quot;desc&quot;} }],&quot;bool&quot; : {&quot;must&quot; : {&quot;field&quot; : {&quot;available&quot; : true}}}}</code></td></tr></tbody></table><p>å‡†å¤‡ä¸€ç»„æ•°æ®ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">void</span> <span class="token function">testAddAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token string">&quot;æŸ³å²©&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">2l</span><span class="token punctuation">,</span> <span class="token string">&quot;èŒƒå†°å†°&quot;</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">3l</span><span class="token punctuation">,</span> <span class="token string">&quot;æå†°å†°&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">4l</span><span class="token punctuation">,</span> <span class="token string">&quot;é”‹å“¥&quot;</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">5l</span><span class="token punctuation">,</span> <span class="token string">&quot;å°é¹¿&quot;</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">6l</span><span class="token punctuation">,</span> <span class="token string">&quot;éŸ©çº¢&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">saveAll</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨UserRepositoryä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼š</p><p>ç¬¬ä¸€ç§å†™æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ ¹æ®å¹´é¾„åŒºé—´æŸ¥è¯¢
     * <span class="token keyword">@param</span> <span class="token parameter">age1</span>
     * <span class="token keyword">@param</span> <span class="token parameter">age2</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByAgeBetween</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age1<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">void</span> <span class="token function">testFindByAgeBetween</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findByAgeBetween</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬äºŒç§å†™æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">&quot;{\n&quot;</span> <span class="token operator">+</span>
          <span class="token string">&quot;    \&quot;range\&quot;: {\n&quot;</span> <span class="token operator">+</span>
          <span class="token string">&quot;      \&quot;age\&quot;: {\n&quot;</span> <span class="token operator">+</span>
          <span class="token string">&quot;        \&quot;gte\&quot;: \&quot;?0\&quot;,\n&quot;</span> <span class="token operator">+</span>
          <span class="token string">&quot;        \&quot;lte\&quot;: \&quot;?1\&quot;\n&quot;</span> <span class="token operator">+</span>
          <span class="token string">&quot;      }\n&quot;</span> <span class="token operator">+</span>
          <span class="token string">&quot;    }\n&quot;</span> <span class="token operator">+</span>
          <span class="token string">&quot;  }&quot;</span><span class="token punctuation">)</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByQuery</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age1<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">void</span> <span class="token function">testFindByQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findByQuery</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-10-3-è‡ªå®šä¹‰æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_10-10-3-è‡ªå®šä¹‰æŸ¥è¯¢" aria-hidden="true">#</a> 10.10.3 è‡ªå®šä¹‰æŸ¥è¯¢</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testNative</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆå§‹åŒ–è‡ªå®šä¹‰æŸ¥è¯¢å¯¹è±¡</span>
    <span class="token class-name">NativeSearchQueryBuilder</span> queryBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeSearchQueryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ„å»ºæŸ¥è¯¢</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withQuery</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å†°å†°&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ’åº</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withSort</span><span class="token punctuation">(</span><span class="token class-name">SortBuilders</span><span class="token punctuation">.</span><span class="token function">fieldSort</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token class-name">SortOrder</span><span class="token punctuation">.</span><span class="token constant">ASC</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆ†é¡µ</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withPageable</span><span class="token punctuation">(</span><span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// é«˜äº®</span>
    queryBuilder<span class="token punctuation">.</span><span class="token function">withHighlightBuilder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HighlightBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">preTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;em&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">postTags</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/em&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–åˆ†é¡µç»“æœé›†</span>
    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>queryBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ€»é¡µæ•°</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userPage<span class="token punctuation">.</span><span class="token function">getTotalPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ€»è®°å½•æ•°</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userPage<span class="token punctuation">.</span><span class="token function">getTotalElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å½“å‰é¡µæ•°æ®</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userPage<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>NativeSearchQueryBuilderï¼šSpringæä¾›çš„ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶æ„å»ºå™¨ï¼Œå¸®åŠ©æ„å»ºjsonæ ¼å¼çš„è¯·æ±‚ä½“</p><p><code>Page&lt;item&gt;</code>ï¼šé»˜è®¤æ˜¯åˆ†é¡µæŸ¥è¯¢ï¼Œå› æ­¤è¿”å›çš„æ˜¯ä¸€ä¸ªåˆ†é¡µçš„ç»“æœå¯¹è±¡ï¼ŒåŒ…å«å±æ€§ï¼š</p><ul><li>totalElementsï¼šæ€»æ¡æ•°</li><li>totalPagesï¼šæ€»é¡µæ•°</li><li>Iteratorï¼šè¿­ä»£å™¨ï¼Œæœ¬èº«å®ç°äº†Iteratoræ¥å£ï¼Œå› æ­¤å¯ç›´æ¥è¿­ä»£å¾—åˆ°å½“å‰é¡µçš„æ•°æ®</li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/topjf/topjf/edit/main/docs/middleware/elastic-search.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: topjfk@163.com">jinfang</span><!--]--><!--]--></div></div></footer><!----><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"></div><div class="copyright">Copyright Â© 2023 topjf</div></footer></div><!--]--><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-30d3d221.js" defer></script>
  </body>
</html>
