import{_ as l,V as i,W as p,a0 as o,X as s,Y as n,Z as e,$ as t,G as c}from"./framework-ed4f969a.js";const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAh4AAAA6CAIAAABwA8cUAAANnklEQVR4Xu1drXojuRI1XJhXGBgYahiYRwhtGDgw1NCwX2GhoeFC04GGfoWBF+a2/kr1J7stOUlbqfPVNyuVSmpJk5zjkjzbqw+DwfCD8ff478ffXZfW+dL+d1iyrfgPmsFg+EnonH+Fsw8zaTEYDItG5/wrnH2YSYvBYFg0Oudf4ezDTFoMBsOi0Tn/CmcfZtJiMBgWjc75Vzj7MJMWg8GwaHTOv8LZh5m0GAyGRaNz/hXOPqxPadluNu+/f8+0KZj3/0E4jevVsOfeJrgh1+OJuw2GOnTOv8LZh/UpLVI/mB0OB/hzMt7/42M/rBjjJsJ0/10p1Ol6KO5PAJsbY/IriX2J0tK0+a6IA3zTjVdo+FJ8H/++ux8eh1/bP7I1Bqw3I3j2ryJ+97x6ej3yjtGaljaNTKd33PxKnohhd6bX856POW6fVtpi/T6kVaQ1epxfmmDz2bZNO/84HmXrbnTzlE2+19PbyVf9bz7MMzqzHd8qpYW7ytCDOb0BBXuWm0DpLXCeQnqfgWlu+UGcbUnjZcyUlothFwOuQdvmY3FpljnD96OJf+vN8WyUDUfHjIgDCz8Pr0haprDXd1f487qOnDuRsmTwbA1Lex+A1pXp+TlI51mdi0t++oXF8gMUC0kLBDiZCUsW1iAtTjnW250r715Wq5e9GvD0GGOSnbaPWEUcE6YAzyhbHsx/0GYgqMXoMRUextPDFtsRt+rSwugtM6cvjYxIJ+d6HK8j9XoQvpzmOQwDzMbP5IpJzJSEi2EXA65C4+an7iYsXaCBfxuMULPjXCUDoDw7UXCKibw/taq9wG60tEnAeKqhPXpaBQ8TAathwzTJ99pkTWJLvr20HN/WWU6cigw7FuOdWxwWnI/j9kWVFickRFqm/KZBWgCgKA8bZ/9snLQACtJC6A0RZyyS5CBUkgs1oTHAGz9jO9DhXXDq6cseGjWi6Thl2TPuTbSbB0FEzZ7FVhYD6RzROPoSaMDlOfi9GGOLtsD6zc9Ol97ogxvuCzfi3ysNUhBvmE+xET90CQU6gmq3WZrMWtTsxOdS23ScpS0nKihf1DQUGhC1FhX3o0VapkwFyYD7zabZCegNadp5UQl/8o5Cn3xYvbTkrMXLSbT3P5Ph1pK0IErDZJnKmfyQxzNZjt4PcHqTG4fEdnQEzrwxiPA0ALz7kK+cUq4S66FE+Vd/Fl5OCleeSXegsIQYgNevz8GVUD+N/2s3H0Cfbbhj3IZ/rzT2eXyWtOR7iInow1FYuq2RRO/tBktz2RXj9wLj+1uW6He9ZAaTOmatQp6vumthGYb7zS5ICzouQ54Zdy2OJne11/i4CooChluL0gK0RagWKokUgdSgkOlu7T5OO+cJn1O59gjJnpF4MRSGjOPBsLGQCZZTLZl2flaoDihHcAgzwP1Zr7NLgGJxDriB7AxCCiZPJqvQNz/AVYdBVy3DneEG/FthFVkL9YeP/4HKteMpZ41L87cgQiHUW5a/PJXRZg6alO6ZoIuetWgJU7JqaZmfteRbGVAUPWuhdzbpwK1eWiAvyaLy+xBMBqsITEZpFdU8neVD/sxugS6RqOyRBABn55HoEzgjq9jHg7AUqdQ5recZMGkpHB35puhHvS4uAYrFOcyRljgMnS6qFTcfVVy4PrjhjtDIv5VGiLiQB+gEDbI09Uq0u3tWwtqkxWUP2oGbPqW/+MsFpTC0TL/8LcSUpEW75gnWJC05yRBnWczpgx0PwLW/Ki3+ciV8owyyonppAYCiOHs7rN7+w61npCVwE/1GEua6vf90j2op0PHlOsaFsmRAT9GCl2NQru4H1ILgtGTw4lWsK2QrnpWqaDZTeYwBEMw5/dwScrE0h1nSUrv5eCVhDH14w72ghX8bjPOsI1ZxjqQRNHwrLI9w+6yllJpIrs9zTrkIcWLDChqO8rI06tLyGVmLUA7+vWGiN+FryikjKUmLPDprkZactSRFAZPBBXieItxEqJlUGGEipkb05hs8/IGN4GUeRf0YnlpRK68n8mXDsGfpZJ17Yo5eha1Ql4AC+KYASjtV4v6azRe7gP8mDHeJev5tNH+N4ZHYUzCykBaa38AIWnrx0SIt/uIEA12iUK4nc4Z/qaNKHZk8uW0q3bUUdOWjSVrCmVWA/ObxgaUy5G6mdNeCT8NSQL20zMRVwQaD4YtRz7+Lt86XxiXh+w2nMjXSYv+jF4OhG3TOv8LZhy1SWvKNy0edtBgMhm7QOf8KZx+2SGkhZtJiMPxodM6/wtmHmbQYDIZFo3P+Fc4+zKTFYDAsGp3zr3D2YSYtBoNh0eicf4WzDzNpMRgMi0bn/CucfZhJi8FgWDQ651/h7MNMWgwGw6LROf8KZx9m0mIwGBaNzvlXOPswkxaDwbBodM6/wtmHmbQYDIZFo3P+Fc4+zKTFYDAsGp3zr3D2YSYtBoNh0eicf4WzDzNpMRgMi0bn/CucfZhJi8FgWDQ651/h7MNMWgwGw6LROf8KZx/Wp7TYq8BmQ7w7uR3khc0GQys651/h7MP6lBapH8wOhwP8+a69wNi9V5kybiLM8A54SZ3+TczS/Qlgc2NMfiWxL1FamjbfFXGAb7rxCg1fiu/jX3iTPLxbPpp7bzxFeKV8em88ikdvlZfWtLRp5Ij8ODIxeLM92J/X9M55viJv4/ZJbfL7kFaR1uhxfmmCzWfbNu18fikkst3o5imbfK+nt5Ov+t98mGd0Zju+VUoLd5WhB3N6Awr2LDeB0lvgPIX0PgPu/c7wIM62pPEyZkrLxbCLAdegbfOxuDTLnOH70cS/9eZ4dr0ZXdmR+POeByRzfO1bp7DA5pMncu5EyuWOTdLyPgCto+lNvB/nrJhTiCCBBcHzS376xUaIcoWkBQKczEgB89YgLU454hvsdy+r1cteDXh6hLfcBzttH7GKOCZMAZ5RtjyY/6DNQFCL0WMqPIynhy22I27VpYXRW2ZOXxoZkU7O9TheR+r1IHw5zXMYBpiNn8kVk5gpCRfDLgZchcbNT91NWLpAA/82GAiGM8e5kZSFTfQamiYKTjGR96GpZDda2qQZMdU490QiJ9OKZHbil7nBC0+Rm9wXS4tTnZtLy/FtneXEqciwYzHeucVhwfk4bl9UaXFCQqRlym8apAUAivKwcfbPxkkLoCAthN4QccYiSQ5CJblQExoDvPEztgMd3gWnnr7soVEjmo5Tlj3j3kS7eRBE1OxZbGUxkM4RjaMvgQZcnoPfizG2aAus3/zsdOmNPrjhvnAj/r3SIAXxVswGMF9Dl1CgI6h2m6XlrCWcaAWIbIlLixSh6CSLDb1QX9SqDhKtXlqmTAXJgPvNptkJ6A1p2nlRCX/yjkKffFi9tOSsxctJtPc/k+HWkrQgSsNkmcqZ/JDHM1mO3g9wepMbh8R2dATOvDGI8DQAvPuQr5xSrhLroUT5V38WXk4KV55Jd6CwhBiA16/PwZVQP43/azcfQJ9tuGPchn+vNPZ5vCAtnFvTPcRE6+EoLN3WKKdPzm6wNH99IvndzZ89FEf6exrRKy2HalX0fNVdC8sw3G92QVrQcRnyzLhrcTS5q73Gx1VQFDDcWpQWoC1CtVBJpAikBoVMd2v3cdo5T/icyrVHSPaMxIuhMGQcD4aNhUywnGrJtPOzQnVAOYJDmAHuz3qdXQIUi3PADWRnEFIweTJZhb75Aa46DLpqGe4MN+DfCpuTtZBDM2LhYAqOp0rnVI1L87cg8lwrWD4ly+YVxeHpdfsqWrNSpnsmUBQ9ayHXPMyqpWV+1pJvZUBR9KyF3tmkA7d6aYG8JIvK70MwGawiMBmlVVTzdJYP+TO7BbpEorJHEgCcnUeiT+CMrGIfD8JSpFLntJ5nwKSlcHTkm6If9bq4BCgW5zBHWuIwdLqoVtx8VHHh+uCGO0Ij/1ba5eOjgt6Evk6Wpl6JdnfPamTL0lz2cO7ATZMW0iolAS3TL38LCyxJS/kpTdKSkwxxlsWcPtjxAFz7q9LiL1fCN8ogK6qXFgAoirO3w+rtP9x6RloCN9FvJGGu2/tP96iWAh1frmNcKEsG9BQteDkG5ep+QC0ITksGL17FukK24lmpimYzlccYAMGc088tIRdLc5glLbWbj1cSxtCHN9wLWvi3wTjPOmJ1aQowaYlVgbXzCLfPWvSEaTym+TjhUeacWzWpwwoajvKyNOrS8hlZi1AO/r1hojfha8opIylJizw6a5GWnLUkRQGTwQV4niLcRKiZVBhhIqZG9OYbPPyBjeBlHkX9GJ5aUSuvJ/Jlw7Bn6WSde2KOXoWtUJeAAvimAEo7VeL+ms0Xu4D/Jgx3iXr+bbT8r0ASe2KaLpA7yW9ghEJ6Ub80ONpKgIOsCEi58pxzq6YrMQAmT26bSnctyg5Ea5CWcGYVIL95fGCpDLmbKd214NOwFFAvLTNxVbDBYPhi1PPv4q3zpXFJ+H7DqUyNtNj/6MVg6Aad869w9mGLlJZ84/JRJy0Gg6EbdM6/wtmHLVJaiJm0GAw/Gp3zr3D2YSYtBoNh0eicf4WzDzNpMRgMi0bn/CucfZhJi8FgWDQ651/h7MNMWgwGw6LROf8KZx9m0mIwGBaNzvlXOPswkxaDwbBodM6/wtmHmbQYDIZFY/kkVW0mLd9oJi0Gw4/G8kmq2kxavtH+D3kj7soe3Zz0AAAAAElFTkSuQmCC",u={},d=t(`<h2 id="一、安装-centos7-9-模板" tabindex="-1"><a class="header-anchor" href="#一、安装-centos7-9-模板" aria-hidden="true">#</a> 一、安装 centos7.9 模板</h2><p><em>安装：略略略略</em></p><h2 id="步骤" tabindex="-1"><a class="header-anchor" href="#步骤" aria-hidden="true">#</a> 步骤：</h2><ol><li>查看当前系统版本</li><li>设置sudo权限</li><li>国内yum源</li><li>升级内核</li><li>关闭防火墙firewalld、关闭selinux</li><li>配置网卡</li><li>禁用该可预测命名规则</li><li>重新生成GRUB配置并更新内核参数</li></ol><h2 id="_1、查看当前系统版本" tabindex="-1"><a class="header-anchor" href="#_1、查看当前系统版本" aria-hidden="true">#</a> 1、查看当前系统版本</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># cat /etc/redhat-release</span>
CentOS Linux release <span class="token number">7.9</span>.2009 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2、设置sudo权限" tabindex="-1"><a class="header-anchor" href="#_2、设置sudo权限" aria-hidden="true">#</a> 2、设置sudo权限</h2><p>1、su root</p><p>2、chmod u+w /etc/sudoers</p><p>3、vim /etc/sudoers</p><blockquote><p>root ALL=(ALL) ALL</p><p>a ALL=(ALL) ALL</p></blockquote><p>4、撤销sudoers文件写权限，命令：</p><p>chmod u-w /etc/sudoers</p><p>5、切换用户 su a</p><h2 id="_3、国内yum源-使用华为" tabindex="-1"><a class="header-anchor" href="#_3、国内yum源-使用华为" aria-hidden="true">#</a> 3、国内yum源（使用华为）</h2>`,15),v={href:"https://developer.aliyun.com/mirror/?spm=a2c6h.13651102.0.0.44e61b11ewNwcu&serviceType=mirror&tag=%E7%B3%BB%E7%BB%9F",target:"_blank",rel:"noopener noreferrer"},k={href:"https://mirrors.huaweicloud.com/home",target:"_blank",rel:"noopener noreferrer"},m=t(`<h3 id="centos-base-repo" tabindex="-1"><a class="header-anchor" href="#centos-base-repo" aria-hidden="true">#</a> CentOS-Base.repo</h3><h4 id="centos7" tabindex="-1"><a class="header-anchor" href="#centos7" aria-hidden="true">#</a> centos7</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 备份</span>
<span class="token function">mv</span> /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
<span class="token comment"># 配置下载</span>
<span class="token function">wget</span> <span class="token parameter variable">-O</span> /etc/yum.repos.d/CentOS-Base-huawei.repo https://repo.huaweicloud.com/repository/conf/CentOS-7-reg.repo

yum clean all <span class="token operator">&amp;&amp;</span> yum makecache <span class="token operator">&amp;&amp;</span> yum <span class="token parameter variable">-y</span> update <span class="token operator">&amp;&amp;</span> yum repolist all

-----------------------------------CentOS-Base.repo--------------------------------------
<span class="token punctuation">[</span>base<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Base - repo.huaweicloud.com
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/<span class="token variable">$releasever</span>/os/<span class="token variable">$basearch</span>/
<span class="token comment">#mirrorlist=https://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/RPM-GPG-KEY-CentOS-7

<span class="token comment">#发布更新</span>
<span class="token punctuation">[</span>updates<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Updates - repo.huaweicloud.com
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/<span class="token variable">$releasever</span>/updates/<span class="token variable">$basearch</span>/
<span class="token comment">#mirrorlist=https://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/RPM-GPG-KEY-CentOS-7

<span class="token comment">#可能有用的附加软件包</span>
<span class="token punctuation">[</span>extras<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Extras - repo.huaweicloud.com
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/<span class="token variable">$releasever</span>/extras/<span class="token variable">$basearch</span>/
<span class="token comment">#mirrorlist=https://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/RPM-GPG-KEY-CentOS-7

<span class="token comment">#扩展现有软件包功能的附加软件包</span>
<span class="token punctuation">[</span>centosplus<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Plus - repo.huaweicloud.com
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/<span class="token variable">$releasever</span>/centosplus/<span class="token variable">$basearch</span>/
<span class="token comment">#mirrorlist=https://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://repo.huaweicloud.com/centos/RPM-GPG-KEY-CentOS-7

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
<span class="token comment"># 阿里</span>
<span class="token function">wget</span> <span class="token parameter variable">-O</span> /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
<span class="token function">curl</span> <span class="token parameter variable">-o</span> /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo
<span class="token function">wget</span> http://mirrors.aliyun.com/repo/Centos-7.repo
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;/mirrors.cloud.aliyuncs.com/d&#39;</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;/mirrors.aliyuncs.com/d&#39;</span> /etc/yum.repos.d/CentOS-Base.repo

yum clean all <span class="token operator">&amp;&amp;</span> yum makecache <span class="token operator">&amp;&amp;</span> yum <span class="token parameter variable">-y</span> update <span class="token operator">&amp;&amp;</span> yum repolist all
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ubuntu" tabindex="-1"><a class="header-anchor" href="#ubuntu" aria-hidden="true">#</a> ubuntu</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>华为：
<span class="token function">cp</span> <span class="token parameter variable">-a</span> /etc/apt/sources.list /etc/apt/sources.list.bak

将http://archive.ubuntu.com和http://security.ubuntu.com替换成http://repo.huaweicloud.com，可以参考如下命令：
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s@http://.*archive.ubuntu.com@http://repo.huaweicloud.com@g&quot;</span> /etc/apt/sources.list
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s@http://.*security.ubuntu.com@http://repo.huaweicloud.com@g&quot;</span> /etc/apt/sources.list

执行 yum update 更新索引
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
阿里：
替换默认的http://archive.ubuntu.com/为mirrors.aliyun.com

deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse

<span class="token comment"># deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span>
<span class="token comment"># deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span>

deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse

执行 yum update 更新索引
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="elrepo-repo" tabindex="-1"><a class="header-anchor" href="#elrepo-repo" aria-hidden="true">#</a> elrepo.repo</h3><h4 id="华为" tabindex="-1"><a class="header-anchor" href="#华为" aria-hidden="true">#</a> 华为</h4>`,7),b={href:"https://mirrors.huaweicloud.com/home",target:"_blank",rel:"noopener noreferrer"},g=s("p",null,"1 查看：yum list | grep epel-release",-1),h=s("p",null,"=== epel-release.noarch 7-11 extras",-1),f=s("p",null,"2 安装：yum install -y epel-release yum remove -y epel-release",-1),_=s("p",null,"3 替换：",-1),q=s("p",null,"rm -rf /etc/yum.repos.d/epel-testing.repo（不需要这个文件！）",-1),w=s("p",null,'sed -i "s/#baseurl/baseurl/g" /etc/yum.repos.d/epel.repo',-1),x=s("p",null,'sed -i "s/metalink/#metalink/g" /etc/yum.repos.d/epel.repo',-1),y={href:"https://repo.huaweicloud.com@g",target:"_blank",rel:"noopener noreferrer"},$=t(`<p>4 执行 yum -y clean all &amp;&amp; yum -y makecache &amp;&amp; yum -y update &amp;&amp; yum repolist all</p><h5>epel.repo</h5><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>epel<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>Extra Packages <span class="token keyword">for</span> Enterprise Linux <span class="token number">7</span> - <span class="token variable">$basearch</span>
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.huaweicloud.com/epel/7/<span class="token variable">$basearch</span>
<span class="token comment">#metalink=https://mirrors.fedoraproject.org/#metalink?repo=epel-7&amp;arch=$basearch</span>
<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7

<span class="token punctuation">[</span>epel-debuginfo<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>Extra Packages <span class="token keyword">for</span> Enterprise Linux <span class="token number">7</span> - <span class="token variable">$basearch</span> - Debug
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.huaweicloud.com/epel/7/<span class="token variable">$basearch</span>/debug
<span class="token comment">#metalink=https://mirrors.fedoraproject.org/#metalink?repo=epel-debug-7&amp;arch=$basearch</span>
<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token punctuation">[</span>epel-source<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>Extra Packages <span class="token keyword">for</span> Enterprise Linux <span class="token number">7</span> - <span class="token variable">$basearch</span> - Source
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.huaweicloud.com/epel/7/SRPMS
<span class="token comment">#metalink=https://mirrors.fedoraproject.org/#metalink?repo=epel-source-7&amp;arch=$basearch</span>
<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5>epel.repo.rpmnew 自动生成</h5><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>epel<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>Extra Packages <span class="token keyword">for</span> Enterprise Linux <span class="token number">7</span> - <span class="token variable">$basearch</span>
<span class="token comment"># 使用metalink更安全，但如果你想使用本地镜像</span>
<span class="token comment"># 把它的地址放在这里。</span>
<span class="token comment">#baseurl=http://download.example/pub/epel/7/$basearch</span>
<span class="token assign-left variable">metalink</span><span class="token operator">=</span>https://mirrors.fedoraproject.org/metalink?repo<span class="token operator">=</span>epel-7<span class="token operator">&amp;</span><span class="token assign-left variable">arch</span><span class="token operator">=</span><span class="token variable">$basearch</span><span class="token operator">&amp;</span><span class="token assign-left variable">infra</span><span class="token operator">=</span><span class="token variable">$infra</span><span class="token operator">&amp;</span><span class="token assign-left variable">content</span><span class="token operator">=</span><span class="token variable">$contentdir</span>
<span class="token assign-left variable">failovermethod</span><span class="token operator">=</span>priority
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="阿里" tabindex="-1"><a class="header-anchor" href="#阿里" aria-hidden="true">#</a> 阿里</h4>`,6),E={href:"https://developer.aliyun.com/mirror/epel",target:"_blank",rel:"noopener noreferrer"},M=s("p",null,"1 查看：yum list | grep epel-release",-1),S=s("p",null,"=== epel-release.noarch 7-11 extras",-1),N=s("p",null,"2 安装：yum install -y epel-release",-1),A=s("blockquote",null,[s("p",null,"mv /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel.repo.backup"),s("p",null,"mv /etc/yum.repos.d/epel-testing.repo /etc/yum.repos.d/epel-testing.repo.backup")],-1),T={href:"http://mirrors.aliyun.com/repo/epel-7.repo",target:"_blank",rel:"noopener noreferrer"},V=s("h2",{id:"_4、升级内核、并删除当前无用的系统内核版本",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4、升级内核、并删除当前无用的系统内核版本","aria-hidden":"true"},"#"),n(" 4、升级内核、并删除当前无用的系统内核版本")],-1),O={href:"https://kernel.org/",target:"_blank",rel:"noopener noreferrer"},D=s("th",null,"mainline:",-1),C=s("th",null,[s("strong",null,"5.18-rc6")],-1),P=s("th",null,"2022-05-08",-1),R={href:"https://git.kernel.org/torvalds/t/linux-5.18-rc6.tar.gz",target:"_blank",rel:"noopener noreferrer"},L=s("th",null,null,-1),I={href:"https://git.kernel.org/torvalds/p/v5.18-rc6/v5.17",target:"_blank",rel:"noopener noreferrer"},U={href:"https://git.kernel.org/torvalds/p/v5.18-rc6/v5.18-rc5",target:"_blank",rel:"noopener noreferrer"},G={href:"https://git.kernel.org/torvalds/ds/v5.18-rc6/v5.18-rc5",target:"_blank",rel:"noopener noreferrer"},F={href:"https://git.kernel.org/torvalds/h/v5.18-rc6",target:"_blank",rel:"noopener noreferrer"},B=s("th",null,null,-1),z=s("td",null,"stable:",-1),W=s("td",null,[s("strong",null,"5.17.6")],-1),H=s("td",null,"2022-05-09",-1),K={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.17.6.tar.xz",target:"_blank",rel:"noopener noreferrer"},X={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.17.6.tar.sign",target:"_blank",rel:"noopener noreferrer"},j={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/patch-5.17.6.xz",target:"_blank",rel:"noopener noreferrer"},Y={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/incr/patch-5.17.5-6.xz",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://git.kernel.org/stable/ds/v5.17.6/v5.17.5",target:"_blank",rel:"noopener noreferrer"},J={href:"https://git.kernel.org/stable/h/v5.17.6",target:"_blank",rel:"noopener noreferrer"},Q={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.17.6",target:"_blank",rel:"noopener noreferrer"},ss=s("td",null,"stable:",-1),ns=s("td",null,[s("strong",null,"5.16.20 [EOL]")],-1),as=s("td",null,"2022-04-13",-1),es={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.16.20.tar.xz",target:"_blank",rel:"noopener noreferrer"},ts={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.16.20.tar.sign",target:"_blank",rel:"noopener noreferrer"},ls={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/patch-5.16.20.xz",target:"_blank",rel:"noopener noreferrer"},is={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/incr/patch-5.16.19-20.xz",target:"_blank",rel:"noopener noreferrer"},ps={href:"https://git.kernel.org/stable/ds/v5.16.20/v5.16.19",target:"_blank",rel:"noopener noreferrer"},os={href:"https://git.kernel.org/stable/h/v5.16.20",target:"_blank",rel:"noopener noreferrer"},cs={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.16.20",target:"_blank",rel:"noopener noreferrer"},rs=s("td",null,"longterm:",-1),us=s("td",null,[s("strong",null,"5.15.38")],-1),ds=s("td",null,"2022-05-09",-1),vs={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.15.38.tar.xz",target:"_blank",rel:"noopener noreferrer"},ks={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.15.38.tar.sign",target:"_blank",rel:"noopener noreferrer"},ms={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/patch-5.15.38.xz",target:"_blank",rel:"noopener noreferrer"},bs={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/incr/patch-5.15.37-38.xz",target:"_blank",rel:"noopener noreferrer"},gs={href:"https://git.kernel.org/stable/ds/v5.15.38/v5.15.37",target:"_blank",rel:"noopener noreferrer"},hs={href:"https://git.kernel.org/stable/h/v5.15.38",target:"_blank",rel:"noopener noreferrer"},fs={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.15.38",target:"_blank",rel:"noopener noreferrer"},_s=s("td",null,"longterm:",-1),qs=s("td",null,[s("strong",null,"5.10.114")],-1),ws=s("td",null,"2022-05-09",-1),xs={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.10.114.tar.xz",target:"_blank",rel:"noopener noreferrer"},ys={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.10.114.tar.sign",target:"_blank",rel:"noopener noreferrer"},$s={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/patch-5.10.114.xz",target:"_blank",rel:"noopener noreferrer"},Es={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/incr/patch-5.10.113-114.xz",target:"_blank",rel:"noopener noreferrer"},Ms={href:"https://git.kernel.org/stable/ds/v5.10.114/v5.10.113",target:"_blank",rel:"noopener noreferrer"},Ss={href:"https://git.kernel.org/stable/h/v5.10.114",target:"_blank",rel:"noopener noreferrer"},Ns={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.10.114",target:"_blank",rel:"noopener noreferrer"},As=s("td",null,"longterm:",-1),Ts=s("td",null,[s("strong",null,"5.4.192")],-1),Vs=s("td",null,"2022-05-09",-1),Os={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.4.192.tar.xz",target:"_blank",rel:"noopener noreferrer"},Ds={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.4.192.tar.sign",target:"_blank",rel:"noopener noreferrer"},Cs={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/patch-5.4.192.xz",target:"_blank",rel:"noopener noreferrer"},Ps={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/incr/patch-5.4.191-192.xz",target:"_blank",rel:"noopener noreferrer"},Rs={href:"https://git.kernel.org/stable/ds/v5.4.192/v5.4.191",target:"_blank",rel:"noopener noreferrer"},Ls={href:"https://git.kernel.org/stable/h/v5.4.192",target:"_blank",rel:"noopener noreferrer"},Is={href:"https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.4.192",target:"_blank",rel:"noopener noreferrer"},Us=s("h3",{id:"centos-内核升级",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#centos-内核升级","aria-hidden":"true"},"#"),n(" centos 内核升级")],-1),Gs={href:"http://www.elrepo.org/",target:"_blank",rel:"noopener noreferrer"},Fs=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 导入该源的秘钥</span>
<span class="token function">rpm</span> <span class="token parameter variable">--import</span> https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
<span class="token comment"># 启用该源仓库</span>
<span class="token function">rpm</span> <span class="token parameter variable">-Uvh</span> http://www.elrepo.org/elrepo-release-7.0-6.el7.elrepo.noarch.rpm
或者：
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看可升级的内核版本</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token parameter variable">--disablerepo</span><span class="token operator">=</span><span class="token string">&quot;*&quot;</span> <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span><span class="token string">&quot;elrepo-kernel&quot;</span> list available
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>可安装的软件包</p><p>kernel-lt.x86_64 5.4.211-1.el7.elrepo elrepo-kernel</p><p>kernel-ml.x86_64 5.19.4-1.el7.elrepo elrepo-kernel</p><p>安装内核</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span>elrepo-kernel <span class="token function">install</span> <span class="token parameter variable">-y</span> kernel-lt-5.4.211-1.el7.elrepo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看当前系统内可用内核</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">awk</span> -F<span class="token punctuation">\\</span>&#39; <span class="token string">&#39;$1==&quot;menuentry &quot; {print i++ &quot; : &quot; $2}&#39;</span> /etc/grub2.cfg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>设置开机从新内核版本启动（其中 0 是上面查询出来的可用内核编号）</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>grub2-set-default <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">reboot</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="并删除当前无用的系统内核版本" tabindex="-1"><a class="header-anchor" href="#并删除当前无用的系统内核版本" aria-hidden="true">#</a> 并删除当前无用的系统内核版本</h3><p>所有已安装的内核版本</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep kernel</span>

kernel-tools-libs-3.10.0-1160.76.1.el7.x86_64
kernel-3.10.0-1160.76.1.el7.x86_64
kernel-headers-3.10.0-1160.76.1.el7.x86_64
kernel-devel-3.10.0-1160.el7.x86_64
kernel-tools-3.10.0-1160.76.1.el7.x86_64
kernel-devel-3.10.0-1160.76.1.el7.x86_64
kernel-lt-5.4.211-1.el7.elrepo.x86_64
kernel-3.10.0-1160.el7.x86_64
abrt-addon-kerneloops-2.1.11-60.el7.centos.x86_64
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当前使用的内核版本</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># uname -r</span>
<span class="token number">5.4</span>.192-1.el7.elrepo.x86_64
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>删除</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum remove <span class="token parameter variable">-y</span> kernel-3.10.0-1160.el7.x86_64 kernel-3.10.0-1160.76.1.el7.x86_64
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>或</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum remove <span class="token variable"><span class="token variable">$(</span><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> kernel <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token punctuation">$(</span>uname -r<span class="token punctuation">)</span><span class="token variable">)</span></span>

<span class="token comment"># 卸载后重新安装</span>
yum <span class="token parameter variable">--enablerepo</span><span class="token operator">=</span>elrepo-kernel <span class="token function">install</span> <span class="token parameter variable">-y</span> kernel-lt-devel-5.4.211-1.el7.elrepo <span class="token punctuation">\\</span>
kernel-lt-doc-5.4.211-1.el7.elrepo <span class="token punctuation">\\</span>
kernel-lt-headers-5.4.211-1.el7.elrepo <span class="token punctuation">\\</span>
kernel-lt-tools-5.4.211-1.el7.elrepo <span class="token punctuation">\\</span>
kernel-lt-tools-libs-5.4.211-1.el7.elrepo <span class="token punctuation">\\</span>
kernel-lt-tools-libs-devel-5.4.211-1.el7.elrepo

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># rpm -qa | grep kernel</span>
kernel-lt-doc-5.4.211-1.el7.elrepo.noarch
kernel-lt-tools-5.4.211-1.el7.elrepo.x86_64
kernel-lt-devel-5.4.211-1.el7.elrepo.x86_64
kernel-lt-5.4.211-1.el7.elrepo.x86_64
kernel-lt-tools-libs-5.4.211-1.el7.elrepo.x86_64
kernel-lt-headers-5.4.211-1.el7.elrepo.x86_64
kernel-lt-tools-libs-devel-5.4.211-1.el7.elrepo.x86_64


yum <span class="token function">install</span> <span class="token parameter variable">-y</span> gcc <span class="token function">make</span> ncurses-devel openssl-devel flex bison  elfutils-libelf-devel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5、关闭防火墙firewalld、关闭selinux、关闭swap、确保不休眠" tabindex="-1"><a class="header-anchor" href="#_5、关闭防火墙firewalld、关闭selinux、关闭swap、确保不休眠" aria-hidden="true">#</a> 5、关闭防火墙firewalld、关闭selinux、关闭swap、确保不休眠</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 1、 关闭防火墙</span>
<span class="token comment">## centos</span>
systemctl start firewalld		systemctl stop firewalld
systemctl <span class="token builtin class-name">enable</span> firewalld		systemctl disable firewalld
systemctl status firewalld
<span class="token comment">## ubuntu</span>
systemctl disable ufw.service <span class="token operator">&amp;&amp;</span> systemctl stop ufw.service
ufw start		ufw stop 	
ufw <span class="token builtin class-name">enable</span>		ufw disable 	
ufw status

<span class="token comment"># 2、 关闭selinux</span>
setenforce <span class="token number">0</span> <span class="token comment"># 临时关闭 </span>
<span class="token comment"># 永久关闭/etc/selinux/semanage.conf</span>
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/enforcing/disabled/&#39;</span> /etc/selinux/config
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39;</span> /etc/selinux/config
<span class="token comment"># 查看SELinux的状态</span>
getenforce

<span class="token comment"># 3、关闭 swap</span>
swapoff <span class="token parameter variable">-a</span>  <span class="token comment">#临时关闭</span>
<span class="token comment">#永久关闭</span>
<span class="token function">sed</span> <span class="token parameter variable">-ri</span> <span class="token string">&#39;s/.*swap.*/#&amp;/&#39;</span> /etc/fstab

<span class="token comment"># 4、确保不休眠</span>
systemctl mask sleep.target suspend.target hibernate.target hybrid-sleep.target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6、配置网卡" tabindex="-1"><a class="header-anchor" href="#_6、配置网卡" aria-hidden="true">#</a> 6、配置网卡</h2><p>vim /etc/sysconfig/network-scripts/ifcfg-ens33</p><p>生产 UUID： uuidgen ens33</p><p>ls -l /dev/disk/by-uuid</p><p>查看 UUID： nmcli con | sed -n &#39;1,2p&#39;</p><p>BOOTPROTO：</p><blockquote><p>dhcp 表示使用动态IP，dhcp 动态IP地址是自行生成。</p><p>none 无（不指定）通常是DHCP</p><p>static 要自己自行指定IP地址</p><p>bootp</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;Ethernet&quot;</span>
<span class="token assign-left variable">PROXY_METHOD</span><span class="token operator">=</span><span class="token string">&quot;none&quot;</span>
<span class="token assign-left variable">BROWSER_ONLY</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span><span class="token string">&quot;static&quot;</span>
<span class="token assign-left variable">DEFROUTE</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV4_FAILURE_FATAL</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">IPV6INIT</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV6_AUTOCONF</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV6_DEFROUTE</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV6_PRIVACY</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">IPV6_FAILURE_FATAL</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">IPV6_ADDR_GEN_MODE</span><span class="token operator">=</span><span class="token string">&quot;stable-privacy&quot;</span>
<span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">&quot;ens33&quot;</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;ccb173d2-9470-4fc3-b894-cce7029f0455&quot;</span>
<span class="token assign-left variable">DEVICE</span><span class="token operator">=</span><span class="token string">&quot;ens33&quot;</span>
<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">ETHTOOL_OPTS</span><span class="token operator">=</span><span class="token string">&quot;autoneg off speed 10000 duplex full&quot;</span>
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token string">&quot;192.168.101.119&quot;</span>
<span class="token comment"># PREFIX=&quot;24&quot;</span>
<span class="token assign-left variable">NETMASK</span><span class="token operator">=</span><span class="token string">&quot;255.255.255.0&quot;</span>
<span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token string">&quot;192.168.101.1&quot;</span>
<span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token string">&quot;192.168.1.1&quot;</span>
<span class="token assign-left variable">DNS2</span><span class="token operator">=</span><span class="token string">&quot;192.168.101.1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;Ethernet&quot;</span>
<span class="token assign-left variable">PROXY_METHOD</span><span class="token operator">=</span><span class="token string">&quot;none&quot;</span>
<span class="token assign-left variable">BROWSER_ONLY</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span><span class="token string">&quot;dhcp&quot;</span>
<span class="token assign-left variable">DEFROUTE</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV4_FAILURE_FATAL</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">IPV6INIT</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV6_AUTOCONF</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV6_DEFROUTE</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPV6_FAILURE_FATAL</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">IPV6_ADDR_GEN_MODE</span><span class="token operator">=</span><span class="token string">&quot;stable-privacy&quot;</span>
<span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">&quot;ens33&quot;</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;5ed15a21-bf0f-4b2a-a40a-33a07afb6560&quot;</span>
<span class="token assign-left variable">DEVICE</span><span class="token operator">=</span><span class="token string">&quot;ens33&quot;</span>
<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span>
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token string">&quot;192.168.100.130&quot;</span>
<span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token string">&quot;24&quot;</span>
<span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token string">&quot;192.168.100.2&quot;</span>
<span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token string">&quot;192.168.100.2&quot;</span>
<span class="token assign-left variable">IPV6_PRIVACY</span><span class="token operator">=</span><span class="token string">&quot;no&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>/etc/hosts</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> <span class="token function">tee</span> /etc/hosts</span>
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6

192.168.100.130 master
192.168.100.131 node1
192.168.100.132 node2
192.168.100.133 node3
EOF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>systemctl start network.service systemctl stop network.service</p><p>systemctl restart network.service systemctl status network.service</p><p>netplan apply</p><h2 id="_7、编写后期需要的脚本-vim-root-first-sh" tabindex="-1"><a class="header-anchor" href="#_7、编写后期需要的脚本-vim-root-first-sh" aria-hidden="true">#</a> 7、编写后期需要的脚本：vim /root/first.sh<a name="first.sh"></a></h2><p>具体使用地址：<a href="#%E4%BD%BF%E7%94%A8first.sh">使用first.sh</a></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># 复制到 vm-centos 虚拟机 /root/first.sh 里，配合 auto_VM.sh 使用</span>

<span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable">hostname</span><span class="token operator">=</span><span class="token variable">$2</span>

<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\\n">\\n</span>----------------------------------&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
<span class="token builtin class-name">echo</span> <span class="token string">&quot;请求参数：IP：<span class="token variable">\${ip}</span>，HostName：<span class="token variable">\${hostname}</span>&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------------------------&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> <span class="token parameter variable">-ne</span> <span class="token number">2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;sh <span class="token variable">$0</span> ip hostname&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
<span class="token keyword">fi</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;ccb173d2-9470-4fc3-b894-cce7029f0455&quot;</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>uuidgen ens33<span class="token variable">)</span></span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;new UUID=<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">\${UUID}</span><span class="token entity" title="\\&quot;">\\&quot;</span>&quot;</span> <span class="token operator">&gt;&gt;</span> main.log


<span class="token keyword">function</span> <span class="token function-name function">set_ip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment"># 设置IP</span>
  <span class="token function">sed</span> <span class="token parameter variable">-ri</span> <span class="token string">&quot;/IPADDR/s#(.*.)\\..*#<span class="token entity" title="\\1">\\1</span>.<span class="token variable">\${ip}</span><span class="token entity" title="\\&quot;">\\&quot;</span>#&quot;</span> /etc/sysconfig/network-scripts/ifcfg-ens33
<span class="token comment"># 设置UUID</span>
  <span class="token function">sed</span> <span class="token parameter variable">-ri</span> <span class="token string">&quot;s/UUID=.*/UUID=<span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">\${UUID}</span><span class="token entity" title="\\&quot;">\\&quot;</span>/&quot;</span> /etc/sysconfig/network-scripts/ifcfg-ens33
  
<span class="token comment"># 设置hosts  </span>
<span class="token function">cat</span> <span class="token parameter variable">-s</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> <span class="token function">tee</span> /etc/hosts <span class="token operator">&gt;&gt;</span> main.log</span>
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.100.130 master
192.168.100.131 node1
192.168.100.132 node2
192.168.100.133 node3
EOF</span>
  
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------------------------------------&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  <span class="token comment"># （sed -n &#39;3,100p）读取文件的3-100行</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;cat /etc/hosts<span class="token entity" title="\\n">\\n</span><span class="token variable"><span class="token variable">$(</span><span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">&#39;3,100p&#39;</span> /etc/hosts<span class="token variable">)</span></span>&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;==============================================&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;wait for systemctl restart network.service ...&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  systemctl restart network.service
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;==============================================&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;new IPADDR is : <span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span> <span class="token parameter variable">-I</span><span class="token variable">)</span></span><span class="token entity" title="\\&quot;">\\&quot;</span>&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;==============================================&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-name function">set_hostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#.*#<span class="token variable">\${hostname}</span>#&quot;</span> /etc/hostname
  hostnamectl set-hostname <span class="token variable">\${hostname}</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;==============================================&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;new hostname is : <span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /etc/hostname<span class="token variable">)</span></span><span class="token entity" title="\\&quot;">\\&quot;</span>&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;==============================================&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
<span class="token punctuation">}</span>

<span class="token function-name function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  set_hostname
  <span class="token function">sleep</span> <span class="token number">3</span>
  set_ip
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; set_ip &amp; set_hostnameok OK!!  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span> <span class="token operator">&gt;&gt;</span> main.log
<span class="token punctuation">}</span>

main
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上传到模板镜像的<code>/root/</code> 目录下</p><p>赋予权限：<code>chmod +x /root/first.sh</code></p><h2 id="_8、禁用-grub-规则" tabindex="-1"><a class="header-anchor" href="#_8、禁用-grub-规则" aria-hidden="true">#</a> 8、禁用 grub 规则</h2><p>#在 grub 文件里面的 GRUB_CMDLINE_LINUX 变量添加 net.ifnames=0 biosdevname=0</p><p><strong>原来配置的网卡ip会生效：/etc/sysconfig/network-scripts/ifcfg-ens33</strong>，所以我不需要这里</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/default/grub</span>
<span class="token punctuation">..</span>.
<span class="token assign-left variable">GRUB_CMDLINE_LINUX</span><span class="token operator">=</span><span class="token string">&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet&quot;</span>
<span class="token comment"># 换为：</span>
<span class="token assign-left variable">GRUB_CMDLINE_LINUX</span><span class="token operator">=</span><span class="token string">&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet net.ifnames=0 biosdevname=0&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新生成GRUB配置并更新内核参数</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># grub2-mkconfig -o /boot/grub2/grub.cfg</span>
Generating grub configuration <span class="token function">file</span> <span class="token punctuation">..</span>.
Found linux image: /boot/vmlinuz-3.10.0-327.el7.x86_64
Found initrd image: /boot/initramfs-3.10.0-327.el7.x86_64.img
。。。。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9、安装对window格式的-sh-脚本转码-dos2unix" tabindex="-1"><a class="header-anchor" href="#_9、安装对window格式的-sh-脚本转码-dos2unix" aria-hidden="true">#</a> 9、安装对window格式的 sh 脚本转码 dos2unix</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># yum install -y dos2unix</span>
已加载插件：fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * elrepo: hkg.mirror.rackspace.com
 
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># ls</span>
anaconda-ks.cfg  first.sh  get_UUID.sh

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># dos2unix first.sh</span>
dos2unix: converting <span class="token function">file</span> first.sh to Unix <span class="token function">format</span> <span class="token punctuation">..</span>.

<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># sh first.sh 129 master0</span>
new <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;eddedb45-b871-4eea-8433-4c08103423e1&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、vagrant" tabindex="-1"><a class="header-anchor" href="#二、vagrant" aria-hidden="true">#</a> 二、Vagrant</h2><h3 id="_1、centos7-9-基本配置" tabindex="-1"><a class="header-anchor" href="#_1、centos7-9-基本配置" aria-hidden="true">#</a> 1、centos7.9 基本配置</h3><h3 id="_2、vagrantfile-文件" tabindex="-1"><a class="header-anchor" href="#_2、vagrantfile-文件" aria-hidden="true">#</a> 2、Vagrantfile 文件</h3><h4 id="vagrant-virtualbox" tabindex="-1"><a class="header-anchor" href="#vagrant-virtualbox" aria-hidden="true">#</a> Vagrant + VirtualBox</h4>`,54),Bs={href:"https://download.virtualbox.org/virtualbox/6.1.34/VirtualBox-6.1.34-150636-Win.exe",target:"_blank",rel:"noopener noreferrer"},zs={href:"https://releases.hashicorp.com/vagrant/2.2.19/",target:"_blank",rel:"noopener noreferrer"},Ws={href:"https://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&sort=downloads&provider=&q=centos",target:"_blank",rel:"noopener noreferrer"},Hs=t(`<p><strong>Vagrant 环境变量配置</strong></p><p>新建用户变量：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>VAGRANT_HOME D:\\rj-win\\Vagrant\\.vagrant.d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>vagrant box add centos7 D:\\iso\\Centos7.box</p><p>centos7 是为 box 取的名字，供后续创建虚拟机。</p><p>查看是否添加成功</p><p>vagrant box list</p><blockquote><p>D:\\iso&gt;vagrant box list centos7 (virtualbox, 0)</p></blockquote></blockquote><p>新建目录：F:\\vb\\centos7，然后进入cmd</p><blockquote><p>创建虚拟机</p><blockquote><p>cd F:\\vm\\masterVagrantfile、cd F:\\vm\\nodeVagrantfile</p><p>vagrant init centos7</p><p>会在当前目录 <code>F:\\vb\\xxx</code> 生成 Vagrantfile 文件</p></blockquote></blockquote><h4 id="vagrantfile-脚本" tabindex="-1"><a class="header-anchor" href="#vagrantfile-脚本" aria-hidden="true">#</a> Vagrantfile 脚本<a name="Vagrantfile 脚本"></a></h4>`,7),Ks={href:"https://www.vagrantup.com/docs/disks",target:"_blank",rel:"noopener noreferrer"},Xs=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#docker, hyperv, virtualbox, vmware_desktop, vmware_workstation</span>
<span class="token comment">## vagrant up --provider virtualbox</span>
<span class="token comment">## vagrant up --provider vmware_desktop</span>
<span class="token comment">## vagrant up --provider vmware_workstation</span>
Vagrant.configure<span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">)</span>.each <span class="token keyword">do</span> <span class="token operator">|</span>i<span class="token operator">|</span>
        config.vm.define <span class="token string">&quot;master&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span>master<span class="token operator">|</span>
            master.vm.box <span class="token operator">=</span> <span class="token string">&quot;centos7w&quot;</span>
            master.vm.box_check_update <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token assign-left variable">master.vm.hostname</span><span class="token operator">=</span><span class="token string">&quot;master&quot;</span>
            master.vm.disk :disk, size: <span class="token string">&quot;100GB&quot;</span>, primary: <span class="token boolean">true</span>
            <span class="token comment"># 设置虚拟机的IP(public_network：桥接 private_network：仅主机)、bridge 桥接适配器</span>
            master.vm.network <span class="token string">&quot;public_network&quot;</span>, ip: <span class="token string">&quot;192.168.101.120&quot;</span>, netmask: <span class="token string">&quot;255.255.255.0&quot;</span>
            <span class="token comment">#docker, hyperv, virtualbox, vmware_desktop, vmware_workstation，vmware_fusion</span>
            master.vm.provider <span class="token string">&quot;vmware_workstation&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span><span class="token function">v</span><span class="token operator">|</span>
                <span class="token comment"># 设置虚拟机的名称</span>
                <span class="token assign-left variable">v.gui</span><span class="token operator">=</span>false
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;master&quot;</span>
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;memsize&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;8192&quot;</span>
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;numvcpus&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;4&quot;</span>
            end
            master.vm.provision <span class="token string">&quot;log&quot;</span>, type: <span class="token string">&quot;shell&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span>s<span class="token operator">|</span>
                s.inline <span class="token operator">=</span> <span class="token string">&quot;echo =================  #{i} =========================&quot;</span>
            end
            <span class="token comment">#master.vm.provision &quot;shell&quot;, inline: &lt;&lt;-SHELL</span>
            <span class="token comment">#    yum install -y net-tools</span>
            <span class="token comment">#SHELL</span>
        end
    end
end

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Vagrant.configure<span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">3</span><span class="token punctuation">)</span>.each <span class="token keyword">do</span> <span class="token operator">|</span>i<span class="token operator">|</span>
        config.vm.define <span class="token string">&quot;node#{i}&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span>master<span class="token operator">|</span>
            master.vm.box <span class="token operator">=</span> <span class="token string">&quot;centos7w&quot;</span>
            master.vm.box_check_update <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token assign-left variable">master.vm.hostname</span><span class="token operator">=</span><span class="token string">&quot;node#{i}&quot;</span>
            master.vm.disk :disk, size: <span class="token string">&quot;100GB&quot;</span>, primary: <span class="token boolean">true</span>
            <span class="token comment"># 设置虚拟机的IP(public_network：桥接 private_network：仅主机)、bridge 桥接适配器</span>
            master.vm.network <span class="token string">&quot;public_network&quot;</span>, ip: <span class="token string">&quot;192.168.101.#{120+i}&quot;</span>, netmask: <span class="token string">&quot;255.255.255.0&quot;</span>
            <span class="token comment">#docker, hyperv, virtualbox, vmware_desktop, vmware_workstation，vmware_fusion</span>
            master.vm.provider <span class="token string">&quot;vmware_workstation&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span><span class="token function">v</span><span class="token operator">|</span>
                <span class="token assign-left variable">v.gui</span><span class="token operator">=</span>false
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;node#{i}&quot;</span>
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;memsize&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;8192&quot;</span>
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;numvcpus&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;4&quot;</span>
            end
            master.vm.provision <span class="token string">&quot;shell&quot;</span>, inline: <span class="token operator">&lt;&lt;-</span><span class="token environment constant">SHELL</span>
                <span class="token builtin class-name">echo</span> <span class="token string">&quot;=================  #{i} =========================&quot;</span>
            <span class="token environment constant">SHELL</span>
        end
    end
end

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>完成配置后，下面安装虚拟机</p><blockquote><p>cd F:\\vm\\masterVagrantfile、cd F:\\vm\\nodeVagrantfile</p><blockquote><p>vagrant up</p></blockquote></blockquote><blockquote><p>默认用户：vagrant 密码：vagrant</p><p>root用户：root：密码：vagrant</p></blockquote><h4 id="vagrant-vmware-desktop" tabindex="-1"><a class="header-anchor" href="#vagrant-vmware-desktop" aria-hidden="true">#</a> Vagrant + VMware-desktop</h4>`,6),js=s("strong",null,"1.下载",-1),Ys={href:"https://releases.hashicorp.com/vagrant/2.2.19/vagrant_2.2.19_x86_64.msi",target:"_blank",rel:"noopener noreferrer"},Zs={href:"https://www.vagrantup.com/vmware/downloads",target:"_blank",rel:"noopener noreferrer"},Js=t(`<p><strong>2.下载 vmware-desktop插件</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>vagrant plugin list
vagrant plugin install vagrant-vmware-desktop
vagrant plugin install vagrant-disksize
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),Qs=s("strong",null,"3.下载",-1),sn={href:"https://app.vagrantup.com/centos/boxes/7",target:"_blank",rel:"noopener noreferrer"},nn=s("p",null,"vmware_desktop：",-1),an={href:"https://app.vagrantup.com/generic/boxes/centos7",target:"_blank",rel:"noopener noreferrer"},en={href:"https://app.vagrantup.com/dds/boxes/vagrant-base-centos7",target:"_blank",rel:"noopener noreferrer"},tn=s("p",null,"vmware_workstation：",-1),ln={href:"https://app.vagrantup.com/dds/boxes/vagrant-base-centos7",target:"_blank",rel:"noopener noreferrer"},pn=t(`<p><strong>4.本地安装box</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>vagrant box <span class="token function">add</span> centos70 D:<span class="token punctuation">\\</span>iso<span class="token punctuation">\\</span>centos7.generic.desktop.box
vagrant box <span class="token function">add</span> centos7w D:<span class="token punctuation">\\</span>iso<span class="token punctuation">\\</span>centos7.dds.workstation.box
vagrant box list
vagrant box remove centos7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> %~dp0centos70
COPY /y /v /d D:<span class="token punctuation">\\</span>rj-win<span class="token punctuation">\\</span>Vagrant<span class="token punctuation">\\</span>.vagrant.d<span class="token punctuation">\\</span>boxes<span class="token punctuation">\\</span>centos70<span class="token punctuation">\\</span><span class="token number">0</span><span class="token punctuation">\\</span>vmware_desktop<span class="token punctuation">\\</span> %~dp0centos70
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>5.生成Vagrantfile文件</strong>，[Vagrantfile 脚本](#Vagrantfile 脚本)</p><blockquote><p>cd F:\\vm\\k8s</p><p>vagrant init centos7d</p></blockquote><p><strong>6.安装</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>vagrant up <span class="token parameter variable">--provider</span> virtualbox
vagrant up <span class="token parameter variable">--provider</span> vmware_desktop
vagrant up <span class="token parameter variable">--provider</span> vmware_workstation
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>7.脚本</strong></p><p><strong>sh脚本均已 Git Bash 执行，bat以 cmd 执行</strong></p>`,9),on={href:"http://clear.sh",target:"_blank",rel:"noopener noreferrer"},cn=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot; ------------- 清除创建记录 -------------- &quot;</span>
<span class="token assign-left variable">k8s</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">cd</span> <span class="token punctuation">$(</span>dirname <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span><span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>&quot;</span>
<span class="token assign-left variable">Vagrantfile</span><span class="token operator">=</span><span class="token string">&quot;Vagrantfile&quot;</span>
<span class="token assign-left variable">VagrantD</span><span class="token operator">=</span><span class="token string">&quot;.vagrant&quot;</span>
<span class="token assign-left variable">mf</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/masterVagrantfile&quot;</span>
<span class="token assign-left variable">nf</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/nodeVagrantfile&quot;</span>

<span class="token builtin class-name">cd</span> <span class="token variable">\${mf}</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${VagrantD}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/master
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${VagrantD}</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;---------- delete old virtual machines [<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/.vagrant]----------&quot;</span>
<span class="token keyword">else</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/master
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;not <span class="token variable">\${mf}</span>/.vagrant !!!&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">cd</span> <span class="token variable">\${nf}</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${VagrantD}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/node1
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/node2
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/node3
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${VagrantD}</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;---------- delete old virtual machines [<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/.vagrant]----------&quot;</span>
<span class="token keyword">else</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/node1
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/node2
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/node3
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;not <span class="token variable">\${nf}</span>/.vagrant !!!&quot;</span>
<span class="token keyword">fi</span>
<span class="token assign-left variable">types</span><span class="token operator">=</span><span class="token variable">$1</span> <span class="token operator">||</span> <span class="token parameter variable">-1</span>
<span class="token keyword">if</span> <span class="token variable"><span class="token punctuation">((</span>types <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/centos70
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${k8s}</span>/centos7w
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;rm -rf <span class="token variable">\${k8s}</span>/centos70 !!&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;rm -rf <span class="token variable">\${k8s}</span>/centos7w !!&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">exit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),rn={href:"http://init.sh",target:"_blank",rel:"noopener noreferrer"},un=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------   vagrant box init   ------------------&quot;</span>
<span class="token assign-left variable">k8s</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">cd</span> <span class="token punctuation">$(</span>dirname <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span><span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>&quot;</span>
<span class="token assign-left variable">centos70</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/centos70&quot;</span>
<span class="token assign-left variable">centos7w</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/centos7w&quot;</span>
<span class="token assign-left variable">old_centos70</span><span class="token operator">=</span><span class="token string">&quot;/d/rj-win/Vagrant/.vagrant.d/boxes/centos70/0/vmware_desktop/&quot;</span>
<span class="token assign-left variable">old_centos7w</span><span class="token operator">=</span><span class="token string">&quot;/d/rj-win/Vagrant/.vagrant.d/boxes/centos7w/0/vmware_desktop/&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------   vagrant box list   ------------------&quot;</span>
vagrant box list
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------   vagrant box remove centos7[0|w]   ------------------&quot;</span>
vagrant box remove centos70
vagrant box remove centos7w
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------   vagrant box add   ------------------&quot;</span>
vagrant box <span class="token function">add</span> centos70 /d/iso/centos7.generic.desktop.box
vagrant box <span class="token function">add</span> centos7w /d/iso/centos7.dds.workstation.box
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token variable">\${centos70}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;------   vagrant box copy to <span class="token variable">\${centos70}</span>...  -------&quot;</span>
    <span class="token function">cp</span> <span class="token parameter variable">-r</span> <span class="token variable">\${old_centos70}</span><span class="token builtin class-name">.</span> <span class="token variable">\${centos70}</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token variable">\${centos7w}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;------   vagrant box copy to <span class="token variable">\${centos7w}</span>...  -------&quot;</span>
    <span class="token function">cp</span> <span class="token parameter variable">-r</span> <span class="token variable">\${old_centos7w}</span><span class="token builtin class-name">.</span> <span class="token variable">\${centos7w}</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">exit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>第一次开始创建镜像的目录文件有</p><div class="language-ABAP line-numbers-mode" data-ext="ABAP"><pre class="language-ABAP"><code>39个
Vagrantfile		disk1.vmdk		metadata.json		
vagrant-base-centos7.vmxf		vagrant-base-centos7.nvram		vagrant-base-centos7.vmsd
vagrant-base-centos7.vmx		disk1-s001.vmdk---&gt;disk1-s032.vmdk
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-ABAP line-numbers-mode" data-ext="ABAP"><pre class="language-ABAP"><code>8个
generic-centos7-vmware.nvram		generic-centos7-vmware.vmdk（后期：vmware【000001-000004】.vmdk）
generic-centos7-vmware.vmsd			generic-centos7-vmware.vmx
generic-centos7-vmware.vmxf
info.json		metadata.json		Vagrantfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),dn={href:"http://install.sh",target:"_blank",rel:"noopener noreferrer"},vn=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot; ------------- 创建 VMware -------------- &quot;</span>
<span class="token assign-left variable">k8s</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">cd</span> <span class="token punctuation">$(</span>dirname <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span><span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>&quot;</span>
<span class="token assign-left variable">Vagrantfile</span><span class="token operator">=</span><span class="token string">&quot;Vagrantfile&quot;</span>
<span class="token assign-left variable">VagrantD</span><span class="token operator">=</span><span class="token string">&quot;.vagrant&quot;</span>
<span class="token assign-left variable">mf</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/masterVagrantfile&quot;</span>
<span class="token assign-left variable">nf</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/nodeVagrantfile&quot;</span>

<span class="token builtin class-name">cd</span> <span class="token variable">\${mf}</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${Vagrantfile}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;==================== <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span> -------------&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;---------------&gt;  rm &quot;</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span><span class="token string">&quot; ok!!&quot;</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------  vagrant up master  -----------------------&quot;</span>
            vagrant up <span class="token parameter variable">--provider</span> vmware_workstation
        <span class="token keyword">fi</span>
    <span class="token keyword">fi</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------  vagrant up master -----------------------&quot;</span>
        vagrant up <span class="token parameter variable">--provider</span> vmware_workstation
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;====&gt; [ <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y-%m-%d,%H:%M:%S<span class="token variable">)</span></span> ] master install ok!&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; &quot;</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;not <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/Vagrantfile !!!&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot; &quot;</span>
<span class="token builtin class-name">cd</span> <span class="token variable">\${nf}</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${Vagrantfile}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;==================== <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span> -------------&quot;</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;---------------&gt;  rm <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span> ok!!&quot;</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------  vagrant up node -----------------------&quot;</span>
            vagrant up <span class="token parameter variable">--provider</span> vmware_workstation
        <span class="token keyword">fi</span>
    <span class="token keyword">fi</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;----------------  vagrant up node -----------------------&quot;</span>
        vagrant up <span class="token parameter variable">--provider</span> vmware_workstation
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;====&gt; [ <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y-%m-%d,%H:%M:%S<span class="token variable">)</span></span> ] node install ok!&quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot; &quot;</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;not <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/Vagrantfile !!!&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">exit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装完成后执行<code>kill.bat</code>结束VMware虚拟机的【vmware-vmx.exe】</p><p><img src="`+r+`" alt="image-20220508160013429"></p><p>4、kill.bat</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>@echo off
<span class="token assign-left variable">echo</span><span class="token operator">=</span>
<span class="token keyword">for</span> /f <span class="token string">&quot;tokens=2 delims= &quot;</span> %%i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;tasklist  /fi &quot;imagename eq vmware-vmx.exe&quot; /nh&#39;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> taskkill /f /pid %%i
cmd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),kn={href:"http://cp.sh",target:"_blank",rel:"noopener noreferrer"},mn=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cp</span> <span class="token parameter variable">-r</span> /f/vm/k8s/masterVagrantfile/.vagrant/machines/master/vmware_workstation/. /f/vm/k8s/master
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">k8s</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">cd</span> <span class="token punctuation">$(</span>dirname <span class="token string">&quot;<span class="token variable">$0</span>&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span><span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>&quot;</span>
<span class="token assign-left variable">Vagrantfile</span><span class="token operator">=</span><span class="token string">&quot;Vagrantfile&quot;</span>
<span class="token assign-left variable">VagrantD</span><span class="token operator">=</span><span class="token string">&quot;.vagrant&quot;</span>
<span class="token assign-left variable">mf</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/masterVagrantfile&quot;</span>
<span class="token assign-left variable">nf</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/nodeVagrantfile&quot;</span>
<span class="token assign-left variable">master</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/master&quot;</span>
<span class="token assign-left variable">node1</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/node1&quot;</span>
<span class="token assign-left variable">node2</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/node2&quot;</span>
<span class="token assign-left variable">node3</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${k8s}</span>/node3&quot;</span>
<span class="token assign-left variable">old_master</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${mf}</span>/.vagrant/machines/master/vmware_workstation/&quot;</span>
<span class="token assign-left variable">old_node1</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${nf}</span>/.vagrant/machines/node1/vmware_workstation/&quot;</span>
<span class="token assign-left variable">old_node2</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${nf}</span>/.vagrant/machines/node2/vmware_workstation/&quot;</span>
<span class="token assign-left variable">old_node3</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${nf}</span>/.vagrant/machines/node3/vmware_workstation/&quot;</span>

<span class="token builtin class-name">cd</span> <span class="token string">&quot;<span class="token variable">\${mf}</span>&quot;</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${master}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${master}</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;rm -f <span class="token variable">\${master}</span> ok&quot;</span>
  <span class="token keyword">fi</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot; &quot;</span>
  <span class="token function">mkdir</span> <span class="token string">&quot;<span class="token variable">\${master}</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;=============&gt; [ <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y-%m-%d,%H:%M:%S<span class="token variable">)</span></span> ] start of copy VMware [<span class="token variable">\${old_master}</span>. --&gt; <span class="token variable">\${master}</span>]&quot;</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${old_master}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">cp</span> <span class="token parameter variable">-r</span> <span class="token variable">\${old_master}</span><span class="token builtin class-name">.</span> <span class="token variable">\${master}</span>
  <span class="token keyword">fi</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot; &quot;</span>
<span class="token builtin class-name">cd</span> <span class="token string">&quot;<span class="token variable">\${nf}</span>&quot;</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/<span class="token variable">\${VagrantD}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${node1}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${node1}</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;rm -f <span class="token variable">\${node1}</span> ok&quot;</span>
  <span class="token keyword">fi</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${node2}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${node2}</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;rm -f <span class="token variable">\${node2}</span> ok&quot;</span>
  <span class="token keyword">fi</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${node3}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${node3}</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;rm -f <span class="token variable">\${node3}</span> ok&quot;</span>
  <span class="token keyword">fi</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot; &quot;</span>
  <span class="token function">mkdir</span> <span class="token string">&quot;<span class="token variable">\${node1}</span>&quot;</span>
  <span class="token function">mkdir</span> <span class="token string">&quot;<span class="token variable">\${node2}</span>&quot;</span>
  <span class="token function">mkdir</span> <span class="token string">&quot;<span class="token variable">\${node3}</span>&quot;</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${old_node1}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token function">cp</span> <span class="token parameter variable">-r</span> <span class="token variable">\${old_node1}</span><span class="token builtin class-name">.</span> <span class="token variable">\${node1}</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;=============&gt; [ <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y-%m-%d,%H:%M:%S<span class="token variable">)</span></span> ] start of copy VMware [<span class="token variable">\${old_node1}</span>. --&gt; <span class="token variable">\${node1}</span>]&quot;</span>
    <span class="token keyword">fi</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${old_node2}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token function">cp</span> <span class="token parameter variable">-r</span> <span class="token variable">\${old_node2}</span><span class="token builtin class-name">.</span> <span class="token variable">\${node2}</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;=============&gt; [ <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y-%m-%d,%H:%M:%S<span class="token variable">)</span></span> ] start of copy VMware [<span class="token variable">\${old_node2}</span>. --&gt; <span class="token variable">\${node2}</span>]&quot;</span>
    <span class="token keyword">fi</span>

  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">\${old_node3}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token function">cp</span> <span class="token parameter variable">-r</span> <span class="token variable">\${old_node3}</span><span class="token builtin class-name">.</span> <span class="token variable">\${node3}</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;=============&gt; [ <span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y-%m-%d,%H:%M:%S<span class="token variable">)</span></span> ] start of copy VMware [<span class="token variable">\${old_node3}</span>. --&gt; <span class="token variable">\${node3}</span>]&quot;</span>
    <span class="token keyword">fi</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">exit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6、修改虚拟机引用镜像地址 boxes</p><p>/f/vm/k8s/下的：master、node[1-3]</p><p>把【master、node[1-3]】/c2c6ff32-7b85-4fb9-8cdf-48497b898d32：36位名称+4</p><p>遍历后把 <code>c2c6ff32-7b85-4fb9-8cdf-48497b898d32/. ../master</code></p><p><strong>直接把D:\\rj-win\\Vagrant.vagrant.d\\boxes\\centos7w\\0\\vmware_desktop\\复制到F:\\vm\\k8s\\vmware_desktop不就行了，然后修改每个节点的（下面提到的3个文件）！！！！</strong></p><p>7、正则复制</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ls /data/dns_data/ | grep .*20180928.* | xargs -i cp -r /data/dns_data/{} ./

/data/dns_data/  --&gt;  表示要cp文件所在目录
| grep  .*20180928.*  ---&gt;表示要过滤的目录
| args -i cp -r /data/dns_data/{}  ---&gt; 把要拷贝文件传入CP命令当中
./  ---&gt; 当前目录
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>disk1-cl1.vmdk 磁盘描述符文件</p><p>修改：<code>[master,node[1-3]]/c2c6ff32-7b85-4fb9-8cdf-48497b898d32/disk1-cl1.vmdk</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 父文件名提示</span>
master:parentFileNameHint<span class="token operator">=</span><span class="token string">&quot;D:<span class="token entity" title="\\r">\\r</span>j-win\\Vagrant\\.vagrant.d<span class="token entity" title="\\b">\\b</span>oxes<span class="token entity" title="\\c">\\c</span>entos7w<span class="token entity" title="\\0">\\0</span><span class="token entity" title="\\v">\\v</span>mware_desktop\\disk1.vmdk&quot;</span>
node1: <span class="token assign-left variable">parentFileNameHint</span><span class="token operator">=</span><span class="token string">&quot;D:<span class="token entity" title="\\r">\\r</span>j-win\\Vagrant\\.vagrant.d<span class="token entity" title="\\b">\\b</span>oxes<span class="token entity" title="\\c">\\c</span>entos7w<span class="token entity" title="\\0">\\0</span><span class="token entity" title="\\v">\\v</span>mware_desktop\\disk1-000001.vmdk&quot;</span>
node2: <span class="token assign-left variable">parentFileNameHint</span><span class="token operator">=</span><span class="token string">&quot;D:<span class="token entity" title="\\r">\\r</span>j-win\\Vagrant\\.vagrant.d<span class="token entity" title="\\b">\\b</span>oxes<span class="token entity" title="\\c">\\c</span>entos7w<span class="token entity" title="\\0">\\0</span><span class="token entity" title="\\v">\\v</span>mware_desktop\\disk1-000002.vmdk&quot;</span>
node3: <span class="token assign-left variable">parentFileNameHint</span><span class="token operator">=</span><span class="token string">&quot;D:<span class="token entity" title="\\r">\\r</span>j-win\\Vagrant\\.vagrant.d<span class="token entity" title="\\b">\\b</span>oxes<span class="token entity" title="\\c">\\c</span>entos7w<span class="token entity" title="\\0">\\0</span><span class="token entity" title="\\v">\\v</span>mware_desktop\\disk1-000003.vmdk&quot;</span>
改为：：
master: <span class="token assign-left variable">parentFileNameHint</span><span class="token operator">=</span><span class="token string">&quot;F:<span class="token entity" title="\\v">\\v</span>m\\k8s\\master\\xxx\\server\\disk1.vmdk&quot;</span>
node1: <span class="token assign-left variable">parentFileNameHint</span><span class="token operator">=</span><span class="token string">&quot;F:<span class="token entity" title="\\v">\\v</span>m\\k8s<span class="token entity" title="\\n">\\n</span>ode1\\xxx\\server\\disk1-000001.vmdk&quot;</span>
node2: <span class="token assign-left variable">parentFileNameHint</span><span class="token operator">=</span><span class="token string">&quot;F:<span class="token entity" title="\\v">\\v</span>m\\k8s<span class="token entity" title="\\n">\\n</span>ode2\\xxx\\server\\disk1-000002.vmdk&quot;</span>
node3: <span class="token assign-left variable">parentFileNameHint</span><span class="token operator">=</span><span class="token string">&quot;F:<span class="token entity" title="\\v">\\v</span>m\\k8s<span class="token entity" title="\\n">\\n</span>ode3\\xxx\\server\\disk1-000003.vmdk&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>复制：</p><p>把 <code>D:\\rj-win\\Vagrant\\.vagrant.d\\boxes\\centos7w\\0\\vmware_desktop\\disk1-s001.vmdk</code>--&gt;<code>disk1-s032.vmdk</code> 复制到<code>F:\\vm\\k8s\\master\\xxx\\serve\\</code></p><p>把 <code>D:\\rj-win\\Vagrant\\.vagrant.d\\boxes\\centos7w\\0\\vmware_desktop\\disk1-000001-s001.vmdk</code>--&gt;<code>disk1-000001-s032.vmdk</code> 复制到<code>F:\\vm\\k8s\\node1\\xxx\\serve\\</code></p><p>把 <code>D:\\rj-win\\Vagrant\\.vagrant.d\\boxes\\centos7w\\0\\vmware_desktop\\disk1-000002-s001.vmdk</code>--&gt;<code>disk1-000002-s032.vmdk</code> 复制到<code>F:\\vm\\k8s\\node2\\xxx\\serve\\</code></p><p>把 <code>D:\\rj-win\\Vagrant\\.vagrant.d\\boxes\\centos7w\\0\\vmware_desktop\\disk1-000003-s001.vmdk</code>--&gt;<code>disk1-000003-s032.vmdk</code> 复制到<code>F:\\vm\\k8s\\node3\\xxx\\serve\\</code></p><p>vagrant-base-centos7.vmsd</p><p>[master,node[1-3]]/c2c6ff32-7b85-4fb9-8cdf-48497b898d32/vagrant-base-centos7.vmsd</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>cloneOf0 <span class="token operator">=</span> <span class="token string">&quot;D:<span class="token entity" title="\\r">\\r</span>j-win\\Vagrant\\.vagrant.d<span class="token entity" title="\\b">\\b</span>oxes<span class="token entity" title="\\c">\\c</span>entos7w<span class="token entity" title="\\0">\\0</span><span class="token entity" title="\\v">\\v</span>mware_desktop<span class="token entity" title="\\v">\\v</span>agrant-base-centos7.vmx&quot;</span>
改
cloneOf0 <span class="token operator">=</span> <span class="token string">&quot;F:<span class="token entity" title="\\v">\\v</span>m\\k8s<span class="token entity" title="\\c">\\c</span>entos7w<span class="token entity" title="\\v">\\v</span>agrant-base-centos7.vmx&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>vagrant-base-centos7.vmx</p><p>[master,node[1-3]]/c2c6ff32-7b85-4fb9-8cdf-48497b898d32/vagrant-base-centos7.vmx</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>filesearchpath <span class="token operator">=</span> <span class="token string">&quot;.;D:<span class="token entity" title="\\r">\\r</span>j-win\\Vagrant\\.vagrant.d<span class="token entity" title="\\b">\\b</span>oxes<span class="token entity" title="\\c">\\c</span>entos7w<span class="token entity" title="\\0">\\0</span><span class="token entity" title="\\v">\\v</span>mware_desktop&quot;</span>
改
filesearchpath <span class="token operator">=</span> &quot;.<span class="token punctuation">;</span>F:<span class="token punctuation">\\</span>vm<span class="token punctuation">\\</span>k8s<span class="token punctuation">\\</span>centos7w<span class="token punctuation">\\</span>&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Vagrant.configure<span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">)</span>.each <span class="token keyword">do</span> <span class="token operator">|</span>i<span class="token operator">|</span>
        config.vm.define <span class="token string">&quot;master&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span>master<span class="token operator">|</span>
            master.vm.box <span class="token operator">=</span> <span class="token string">&quot;centos70&quot;</span>
            master.vm.box_check_update <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token assign-left variable">master.vm.hostname</span><span class="token operator">=</span><span class="token string">&quot;master&quot;</span>
            master.vm.disk :disk, size: <span class="token string">&quot;100GB&quot;</span>, primary: <span class="token boolean">true</span>
            <span class="token comment"># 设置虚拟机的IP(public_network：桥接 private_network：仅主机)、bridge 桥接适配器</span>
            master.vm.network <span class="token string">&quot;public_network&quot;</span>, ip: <span class="token string">&quot;192.168.101.120&quot;</span>, netmask: <span class="token string">&quot;255.255.255.0&quot;</span>
            <span class="token comment">#docker, hyperv, virtualbox, vmware_desktop, vmware_workstation，vmware_fusion</span>
            master.vm.provider <span class="token string">&quot;vmware_workstation&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span><span class="token function">v</span><span class="token operator">|</span>
                <span class="token assign-left variable">v.gui</span><span class="token operator">=</span>false
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;master&quot;</span>
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;memsize&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;8192&quot;</span>
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;numvcpus&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;4&quot;</span>
                v.vmx<span class="token punctuation">[</span><span class="token string">&quot;cpuid.coresPerSocket&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;2&quot;</span>
                <span class="token comment">#cpu总处理器内核数：numvcpus = &quot;4&quot;，</span>
                <span class="token comment"># numvcpus=处理器数量*cpuid.coresPerSocket</span>
                <span class="token comment"># 处理器数量=numvcpus/cpuid.coresPerSocket（4/2=2）</span>
                <span class="token comment">#cpu每个处理器内核数：cpuid.coresPerSocket = &quot;2&quot;</span>
            end
            master.vm.provision <span class="token string">&quot;shell&quot;</span>, inline: <span class="token operator">&lt;&lt;-</span><span class="token environment constant">SHELL</span>
                <span class="token builtin class-name">echo</span> <span class="token string">&quot;=================  #{i} =========================&quot;</span>
            <span class="token environment constant">SHELL</span>
        end
    end
end
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、" tabindex="-1"><a class="header-anchor" href="#_3、" aria-hidden="true">#</a> 3、</h3><p>安装kernel-devel,需要安装VBOX的增强包，就必须安装这个</p><p>安装增强包：就是vm-tool（在vm安装目录里的 xx.iso）</p><h3 id="vagrant-box-打包" tabindex="-1"><a class="header-anchor" href="#vagrant-box-打包" aria-hidden="true">#</a> Vagrant Box 打包</h3><h3 id="权限配置公钥" tabindex="-1"><a class="header-anchor" href="#权限配置公钥" aria-hidden="true">#</a> 权限配置公钥</h3><p>为vagrant添加sudo权限</p><h3 id="配置网卡" tabindex="-1"><a class="header-anchor" href="#配置网卡" aria-hidden="true">#</a> 配置网卡</h3><p>此步骤时候我很郁闷的一步，就是当你直接把这个镜像打包后，以后如果在同一台机器上面使用同一个box虚拟多台机器，配置就会出问题。因此这步骤还是比较关键的。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#第一步：把网卡中的MAC地址注释</span>
<span class="token comment">#HWADDR=XX:XX------------</span>
<span class="token comment">#第二步：删除</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/udev/rules.d/70-persistent-ipoib.rules
<span class="token comment">#安装新的虚拟机后，建议改一下MAC地址，如果还遇到其他问题，建议看看这里</span>
<span class="token comment">#虚拟机克隆CentOS7 出现的网络问题解决办法http://www.bubuko.com/infodetail-1483490.html</span>
poweroff
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="打包box" tabindex="-1"><a class="header-anchor" href="#打包box" aria-hidden="true">#</a> 打包BOX</h3><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token preprocessor property">#进入vagrant的目录</span>
<span class="token punctuation">[</span>E<span class="token punctuation">:</span>\\vagrant<span class="token punctuation">]</span>$ vagrant package <span class="token operator">--</span>output <span class="token punctuation">.</span><span class="token operator">/</span>tzfcentos73<span class="token punctuation">.</span>box <span class="token operator">--</span><span class="token keyword">base</span> CentOS73
<span class="token operator">==</span><span class="token operator">&gt;</span> CentOS73<span class="token punctuation">:</span> Exporting VM<span class="token range operator">..</span><span class="token punctuation">.</span>
<span class="token operator">==</span><span class="token operator">&gt;</span> CentOS73<span class="token punctuation">:</span> Compressing <span class="token class-name">package</span> to<span class="token punctuation">:</span> E<span class="token punctuation">:</span><span class="token operator">/</span>vagrant<span class="token operator">/</span>tzfcentos73<span class="token punctuation">.</span>box
<span class="token preprocessor property">#解释output是指box的名字，--base是指基于VBOX里面的哪个虚拟机打包，这的名字一定要争取</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、vmrun" tabindex="-1"><a class="header-anchor" href="#二、vmrun" aria-hidden="true">#</a> 二、vmrun</h2>`,36),bn={href:"https://docs.vmware.com/cn/",target:"_blank",rel:"noopener noreferrer"},gn=s("h3",{id:"格式-vmrun-身份验证标志-命令-参数",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#格式-vmrun-身份验证标志-命令-参数","aria-hidden":"true"},"#"),n(" 格式：vmrun [身份验证标志] 命令 [参数]")],-1),hn={href:"https://www.vmware.com/pdf/vix162_vmrun_command.pdf",target:"_blank",rel:"noopener noreferrer"},fn={href:"https://docs.vmware.com/cn/search/#/vmrun",target:"_blank",rel:"noopener noreferrer"},_n=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>身份验证标志
--------------
这些必须出现在命令和任何命令参数之前。
   <span class="token parameter variable">-T</span> <span class="token operator">&lt;</span>主机类型<span class="token operator">&gt;</span> <span class="token punctuation">(</span>ws<span class="token operator">|</span>fusion<span class="token operator">||</span>player<span class="token punctuation">)</span>
   <span class="token parameter variable">-vp</span> <span class="token operator">&lt;</span>加密虚拟机的密码<span class="token operator">&gt;</span>
   <span class="token parameter variable">-gu</span> <span class="token operator">&lt;</span>来宾操作系统中的用户名<span class="token operator">&gt;</span>
   <span class="token parameter variable">-gp</span> <span class="token operator">&lt;</span>guest OS 中的密码<span class="token operator">&gt;</span>

电源命令          			参数          			描述
--------------           ----------           -----------
start                    .vmx 文件的路径     		启动虚拟机或团队
                         <span class="token punctuation">[</span>gui<span class="token operator">|</span>nogui<span class="token punctuation">]</span>
stop                     .vmx 文件的路径     		停止虚拟机或团队
                         <span class="token punctuation">[</span>hard<span class="token operator">|</span>soft<span class="token punctuation">]</span>
reset                    .vmx 文件的路径     		重置 VM 或团队
                         <span class="token punctuation">[</span>hard<span class="token operator">|</span>soft<span class="token punctuation">]</span>
<span class="token function">suspend</span>                  .vmx 文件的路径     		暂停 VM 或团队
                         <span class="token punctuation">[</span>hard<span class="token operator">|</span>soft<span class="token punctuation">]</span>
pause                    .vmx 文件的路径     		暂停虚拟机
unpause                  .vmx 文件的路径     		取消暂停虚拟机

快照命令		        	参数         			  描述
-----------------        ----------           -----------
listSnapshots            .vmx 文件的路径     		列出 VM 中的所有快照
                         <span class="token punctuation">[</span>showTree<span class="token punctuation">]</span>
snapshot                 .vmx 文件的路径     		创建 VM 的快照
                         Snapshot name
deleteSnapshot           .vmx 文件的路径     		从 VM 中删除快照
                         Snapshot name
                         <span class="token punctuation">[</span>andDeleteChildren<span class="token punctuation">]</span>
revertToSnapshot         .vmx 文件的路径     		将 VM 状态设置为快照
                         快照名称

主机网络命令   				 参数        		  		 描述
---------------------    ----------           -----------
listHostNetworks                              	列出主机中的所有网络
listPortForwardings      主机网络名称    			列出主机网络上所有可用的端口转发
setPortForwarding        主机网络名称    			在主机网络上添加或更新端口转发
                         Protocol
                         Host port
                         Guest <span class="token function">ip</span>
                         Guest port
                         <span class="token punctuation">[</span>Description<span class="token punctuation">]</span>
deletePortForwarding     Host network name   	删除主机网络上的端口转发
                         Protocol
                         Host port

嘉宾命令   				 参数        		  		 描述
-----------------        ----------           -----------
runProgramInGuest        .vmx 文件的路径     	在来宾操作系统中运行程序
                         <span class="token punctuation">[</span>-noWait<span class="token punctuation">]</span>
                         <span class="token punctuation">[</span>-activeWindow<span class="token punctuation">]</span>
                         <span class="token punctuation">[</span>-interactive<span class="token punctuation">]</span>
                         完整路径到程序
                         <span class="token punctuation">[</span>程序参数<span class="token punctuation">]</span>
runScriptInGuest         .vmx 文件的路径     	在来宾操作系统中运行脚本
                         <span class="token punctuation">[</span>-noWait<span class="token punctuation">]</span>
                         <span class="token punctuation">[</span>-activeWindow<span class="token punctuation">]</span>
                         <span class="token punctuation">[</span>-interactive<span class="token punctuation">]</span>
                         解释器路径
                         脚本文本
fileExistsInGuest        .vmx 文件的路径     	检查来宾操作系统中是否存在文件
                         来宾中的文件路径
directoryExistsInGuest   .vmx 文件的路径    		检查来宾操作系统中是否存在目录
                         来宾目录的路径
setSharedFolderState     .vmx 文件的路径     	修改主客共享文件夹
                         共享名称
                         Host path
                         writable <span class="token operator">|</span> <span class="token builtin class-name">readonly</span>
addSharedFolder          .vmx 文件的路径     	添加主客共享文件夹
                         共享名称
                         新主机路径
removeSharedFolder       .vmx 文件的路径     	删除主客共享文件夹
                         共享名称
enableSharedFolders      .vmx 文件的路径     	在来宾系统中启用共享文件夹
                         <span class="token punctuation">[</span>runtime<span class="token punctuation">]</span>
disableSharedFolders     .vmx 文件的路径     	禁用来宾系统中的共享文件夹
                         <span class="token punctuation">[</span>runtime<span class="token punctuation">]</span>
listProcessesInGuest     .vmx 文件的路径     	列出来宾操作系统中正在运行的进程
killProcessInGuest       .vmx 文件的路径     	在来宾操作系统中终止进程
                         进程号
deleteFileInGuest        .vmx 文件的路径     	删除来宾操作系统中的文件
                         Path <span class="token keyword">in</span> guest
createDirectoryInGuest   .vmx 文件的路径     	在来宾操作系统中创建目录
                         Directory path <span class="token keyword">in</span> guest
deleteDirectoryInGuest   .vmx 文件的路径     	删除来宾操作系统中的目录
                         Directory path <span class="token keyword">in</span> guest
CreateTempfileInGuest    .vmx 文件的路径     	在来宾操作系统中创建临时文件
listDirectoryInGuest     .vmx 文件的路径     	在来宾操作系统中列出一个目录
                         Directory path <span class="token keyword">in</span> guest
CopyFileFromHostToGuest  .vmx 文件的路径     	将文件从主机操作系统复制到来宾操作系统
                         Path on <span class="token function">host</span>
                         Path <span class="token keyword">in</span> guest
CopyFileFromGuestToHost  .vmx 文件的路径     	将文件从来宾操作系统复制到主机操作系统
                         Path <span class="token keyword">in</span> guest
                         Path on <span class="token function">host</span>
renameFileInGuest        .vmx 文件的路径     	在来宾操作系统中重命名文件
                         Original name
                         New name
typeKeystrokesInGuest    .vmx 文件的路径     	在来宾操作系统中键入击键
                         keystroke string
connectNamedDevice       .vmx 文件的路径     	连接来宾操作系统中的命名设备
                         device name
disconnectNamedDevice    .vmx 文件的路径     	断开来宾操作系统中的命名设备
                         device name
captureScreen            .vmx 文件的路径     	将虚拟机的屏幕捕获到本地文件
                         Path on <span class="token function">host</span>
writeVariable            .vmx 文件的路径     	在VM状态下写入一个变量
                         <span class="token punctuation">[</span>runtimeConfig<span class="token operator">|</span>guestEnv<span class="token operator">|</span>guestVar<span class="token punctuation">]</span>
                         variable name
                         variable value
readVariable             .vmx 文件的路径     	读取处于VM状态的变量
                         <span class="token punctuation">[</span>runtimeConfig<span class="token operator">|</span>guestEnv<span class="token operator">|</span>guestVar<span class="token punctuation">]</span>
                         variable name
getGuestIPAddress        .vmx 文件的路径     	获取来宾的IP地址
                         <span class="token punctuation">[</span>-wait<span class="token punctuation">]</span>

常规命令选项	   				 参数        		  		 描述
----------------         ----------           -----------
list                                          	列出所有运行的虚拟机。 
upgradevm                .vmx 文件的路径     	将虚拟机升级到当前虚拟硬件版本
installTools             .vmx 文件的路径     	安装 VMware Tools <span class="token keyword">in</span> Guest
checkToolsState          .vmx 文件的路径     	检查客户机中的 VMware Tools 的状态。
												可能的状态为 unknown、installed和running
deleteVM                 .vmx 文件的路径     	删除虚拟机
clone                    .vmx 文件的路径     	创建 VM 的副本
                         目标 .vmx 文件的路径
                         full（完全克隆）<span class="token operator">|</span>linked（链接克隆）
                         <span class="token punctuation">[</span>-snapshot<span class="token operator">=</span>克隆的快照名称 <span class="token keyword">if</span> linked时<span class="token punctuation">]</span>
                         <span class="token punctuation">[</span>-cloneName<span class="token operator">=</span>名称<span class="token punctuation">]</span>

VM模板命令   				 参数        		  		 描述
---------------------    ----------           -----------
downloadPhotonVM         新虚拟机的路径     	 下载光子虚拟机
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="示例" tabindex="-1"><a class="header-anchor" href="#示例" aria-hidden="true">#</a> 示例</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 启动虚拟机</span>
vmrun <span class="token parameter variable">-T</span> ws start <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span>
vmrun <span class="token parameter variable">-T</span> ws stop <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span>

<span class="token comment"># 克隆虚拟机</span>
/d/rj-win/vm16/vmrun.exe <span class="token parameter variable">-T</span> ws clone <span class="token string">&quot;/f/vm/k8s/centos7_vmware_workstation/centos7_vmware_workstation.vmx&quot;</span> <span class="token string">&quot;/f/vm/k8s/centos7/master-cluster/master-120/master-120.vmx&quot;</span>  full <span class="token parameter variable">-cloneName</span><span class="token operator">=</span>master-120

<span class="token comment"># 在 Windows 主机上使用 Workstation 在虚拟机中运行程序</span>
vmrun <span class="token parameter variable">-T</span> ws <span class="token parameter variable">-gu</span> guestUser <span class="token parameter variable">-gp</span> guestPassword runProgramInGuest <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span> <span class="token string">&quot;c:\\Program Files\\myProgram.exe&quot;</span>

<span class="token comment"># 在Windows上登录虚拟机，并执行虚拟机脚本</span>
D:<span class="token punctuation">\\</span>rj-win<span class="token punctuation">\\</span>vm16<span class="token punctuation">\\</span>vmrun.exe <span class="token parameter variable">-T</span> ws <span class="token parameter variable">-gu</span> root <span class="token parameter variable">-gp</span> 123456a runProgramInGuest <span class="token string">&quot;F:<span class="token entity" title="\\v">\\v</span>m\\k8s<span class="token entity" title="\\n">\\n</span>ode-cluster<span class="token entity" title="\\n">\\n</span>ode-121<span class="token entity" title="\\n">\\n</span>ode-121.vmx&quot;</span> /bin/bash /root/first.sh <span class="token number">121</span> node-121


<span class="token comment"># 创建虚拟机的快照</span>
vmrun <span class="token parameter variable">-T</span> ws snapshot <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span> mySnapshot

<span class="token comment"># 获取快照列表</span>
vmrun <span class="token parameter variable">-T</span> ws listSnapshots <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span>

<span class="token comment"># 还原快照</span>
vmrun <span class="token parameter variable">-T</span> ws revertToSnapshot <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span> mySnapshot

<span class="token comment"># 删除快照</span>
vmrun <span class="token parameter variable">-T</span> ws deleteSnapshot <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span> mySnapshot

<span class="token comment"># 启用工作站共享文件夹</span>
vmrun <span class="token parameter variable">-T</span> ws enableSharedFolders <span class="token string">&quot;c:\\myVMs\\myVM.vmx&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="步骤-1" tabindex="-1"><a class="header-anchor" href="#步骤-1" aria-hidden="true">#</a> 步骤</h3>`,4),qn=s("li",null,"cd D:\\rj-win\\vm16\\vmrun.exe 程序",-1),wn=s("li",null,"git 软件",-1),xn={href:"http://auto.sh",target:"_blank",rel:"noopener noreferrer"},yn=s("li",null,"sh auto_VM.sh create",-1),$n=s("li",null,"sh auto_VM.sh start | sh auto_VM.sh",-1),En=s("li",null,"设置IP的脚本 set_ip.bat",-1),Mn=t(`<blockquote><p>执行流程：create》start》set_ip》window下运行set_ip.bat脚本</p></blockquote><h3 id="脚本-auto-vm-sh" tabindex="-1"><a class="header-anchor" href="#脚本-auto-vm-sh" aria-hidden="true">#</a> 脚本：auto_VM.sh</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">host_master</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span>
<span class="token assign-left variable">host_node</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">121</span> <span class="token number">122</span> <span class="token number">123</span><span class="token punctuation">)</span>
<span class="token assign-left variable">gu</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span>
<span class="token assign-left variable">gp</span><span class="token operator">=</span><span class="token string">&quot;123456a&quot;</span>

<span class="token comment">#模板镜像位置</span>
<span class="token assign-left variable">VMX_FILE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/CentOS7/CentOS7.vmx&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-e</span> <span class="token variable">\${VMX_FILE}</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 没有模板镜像 &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment"># vmrun.exe 位置</span>
<span class="token assign-left variable">VMRUN_EXE</span><span class="token operator">=</span><span class="token string">&quot;/d/rj-win/vm16/vmrun.exe&quot;</span>
<span class="token assign-left variable">PATH_VMRUN_EXE_CMD</span><span class="token operator">=</span><span class="token string">&quot;D:<span class="token entity" title="\\\\">\\\\</span>rj-win<span class="token entity" title="\\\\">\\\\</span>vm16<span class="token entity" title="\\\\">\\\\</span>vmrun.exe&quot;</span>
<span class="token comment"># 集群机器位置</span>
<span class="token assign-left variable">K8S_CENTOS7</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>&quot;</span>
<span class="token assign-left variable">K8S_CENTOS7_CMD</span><span class="token operator">=</span><span class="token string">&quot;F:<span class="token entity" title="\\\\">\\\\</span>vm<span class="token entity" title="\\\\">\\\\</span>k8s&quot;</span>
<span class="token comment">#集群名称</span>
<span class="token assign-left variable">MASTER_CLUSTER_NAME</span><span class="token operator">=</span><span class="token string">&quot;master-cluster&quot;</span>
<span class="token assign-left variable">NODE_CLUSTER_NAME</span><span class="token operator">=</span><span class="token string">&quot;node-cluster&quot;</span>
<span class="token comment">#服务器名称</span>
<span class="token assign-left variable">MASTER_NAME</span><span class="token operator">=</span><span class="token string">&quot;master&quot;</span>
<span class="token assign-left variable">NODE_NAME</span><span class="token operator">=</span><span class="token string">&quot;node&quot;</span>
<span class="token comment">#创建快照的名称</span>
<span class="token assign-left variable">SHOT_NAME</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$2</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;=====&gt;  sh 参数[<span class="token variable">$1</span>,<span class="token variable">$2</span>,<span class="token variable">$3</span>]&quot;</span>
<span class="token assign-left variable">v2</span><span class="token operator">=</span><span class="token number">120</span>

<span class="token function-name function">clone_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#    for i in $(cat host-node.txt)</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始克隆 master-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws clone <span class="token string">&quot;<span class="token variable">\${VMX_FILE}</span>&quot;</span> <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> full <span class="token parameter variable">-cloneName</span><span class="token operator">=</span><span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token function-name function">clone_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">#  for i in $(cat host-node.txt)</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始克隆 node-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws clone <span class="token string">&quot;<span class="token variable">\${VMX_FILE}</span>&quot;</span> <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> full <span class="token parameter variable">-cloneName</span><span class="token operator">=</span><span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment"># 创建克隆链接的虚拟机</span>
<span class="token function-name function">VM_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
clone_master
<span class="token function">sleep</span> <span class="token number">6</span>
clone_node
<span class="token function">sleep</span> <span class="token number">8</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    克隆虚拟机完成     &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token function-name function">start_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始启动: <span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws start <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token function-name function">start_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始启动: <span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws start <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment"># 启动创建好的虚拟机</span>
<span class="token function-name function">VM_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
start_master
<span class="token function">sleep</span> <span class="token number">6</span>
start_node
<span class="token function">sleep</span> <span class="token number">3</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    启动虚拟机完成    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># 修改IP地址</span>
<span class="token function-name function">set_ip_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token operator">&gt;</span>  <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">\${PATH_VMRUN_EXE_CMD}</span> -T ws -gu <span class="token variable">\${gu}</span> -gp <span class="token variable">\${gp}</span> runProgramInGuest <span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span><span class="token variable">\${MASTER_CLUSTER_NAME}</span><span class="token entity" title="\\\\">\\\\</span><span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span><span class="token entity" title="\\\\">\\\\</span><span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx<span class="token entity" title="\\&quot;">\\&quot;</span> /bin/bash /root/first.sh <span class="token variable">\${i}</span> <span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>&quot;</span> <span class="token operator">&gt;&gt;</span>  <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
    <span class="token comment"># ping -n 5(发送5次请求)|在Linux端使用 -c</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ping -n 3 192.168.101.<span class="token variable">\${i}</span> &gt;<span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span>ping<span class="token variable">\${i}</span>.log&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
  <span class="token keyword">done</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;修改IP脚本生成路径: <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span>set_ip_<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.bat&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;exit&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;运行命令:<span class="token entity" title="\\n">\\n</span>1.打开cmd.exe<span class="token entity" title="\\n">\\n</span>2.输入: <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span>set_ip<span class="token variable">\${i}</span>.bat&quot;</span>
<span class="token punctuation">}</span>
<span class="token function-name function">set_ip_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token operator">&gt;</span>  <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
    <span class="token comment">#登录系统</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">\${PATH_VMRUN_EXE_CMD}</span> -T ws -gu <span class="token variable">\${gu}</span> -gp <span class="token variable">\${gp}</span> runProgramInGuest <span class="token entity" title="\\&quot;">\\&quot;</span><span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span><span class="token variable">\${NODE_CLUSTER_NAME}</span><span class="token entity" title="\\\\">\\\\</span><span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span><span class="token entity" title="\\\\">\\\\</span><span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx<span class="token entity" title="\\&quot;">\\&quot;</span> /bin/bash /root/first.sh <span class="token variable">\${i}</span> <span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>&quot;</span> <span class="token operator">&gt;&gt;</span>  <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
    <span class="token comment"># ping -n 5(发送5次请求)|在Linux端使用 -c</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;ping -n 3 192.168.101.<span class="token variable">\${i}</span> &gt;<span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span>ping<span class="token variable">\${i}</span>.log&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;exit&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token punctuation">\\</span><span class="token punctuation">\\</span>set_ip<span class="token variable">\${i}</span>.bat
  <span class="token keyword">done</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;修改IP脚本生成路径: <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span>set_ip_<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.bat&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;运行命令:<span class="token entity" title="\\n">\\n</span>1.打开cmd.exe<span class="token entity" title="\\n">\\n</span>2.输入: <span class="token variable">\${K8S_CENTOS7_CMD}</span><span class="token entity" title="\\\\">\\\\</span>set_ip_<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.bat&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment"># -T ws -gu -gp runProgramInGuest &quot;xxx.vmx&quot; &quot;vm.exe&quot;</span>
<span class="token comment">#登录系统就行设置：</span>
<span class="token comment"># runProgramInGuest xx.vmx [程序参数]</span>
<span class="token comment"># runScriptInGuest xx.vmx [解释器路径] [脚本文本]</span>
<span class="token function-name function">VM_set_IP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  set_ip_master
  set_ip_node
<span class="token punctuation">}</span>

<span class="token function-name function">stop_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始关闭: <span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws stop <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span>
    <span class="token function">sleep</span> <span class="token number">2</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token function-name function">stop_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始关闭: <span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws stop <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span>
    <span class="token function">sleep</span> <span class="token number">2</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment">#批量关机</span>
<span class="token function-name function">VM_stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
stop_master
stop_node
<span class="token function">sleep</span> <span class="token number">6</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    批量关机完成    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token function-name function">snapshot_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始创建快照: <span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i ...}</span>&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws snapshot <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> <span class="token variable">\${SHOT_NAME}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token function-name function">snapshot_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始创建快照: <span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws snapshot <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> <span class="token variable">\${SHOT_NAME}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment"># 创建快照</span>
<span class="token function-name function">VM_snapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
snapshot_master
<span class="token function">sleep</span> <span class="token number">6</span>
snapshot_node
<span class="token function">sleep</span> <span class="token number">6</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    创建快照完成    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token function-name function">shot_list_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;获取快照列表: <span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws listSnapshots <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token function-name function">shot_list_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;获取快照列表: <span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws listSnapshots <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment"># 获取快照列表</span>
<span class="token function-name function">VM_shot_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
shot_list_master
<span class="token function">sleep</span> <span class="token number">6</span>
shot_list_node
<span class="token function">sleep</span> <span class="token number">6</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   获取快照列表    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token function-name function">shot_back_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始恢复快照: <span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span> <span class="token variable">\${SHOT_NAME}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws revertToSnapshot <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> <span class="token variable">\${SHOT_NAME}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token function-name function">shot_back_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始恢复快照: <span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span> <span class="token variable">\${SHOT_NAME}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws revertToSnapshot <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> <span class="token variable">\${SHOT_NAME}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment"># 恢复快照</span>
<span class="token function-name function">VM_shot_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
shot_back_master
<span class="token function">sleep</span> <span class="token number">6</span>
shot_back_node
<span class="token function">sleep</span> <span class="token number">6</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   恢复快照完成：<span class="token variable">\${SHOT_NAME}</span>    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># 删除快照</span>
<span class="token function-name function">shot_del_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_master<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始删除快照: <span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span> <span class="token variable">\${SHOT_NAME}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws deleteSnapshot <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${MASTER_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> <span class="token variable">\${SHOT_NAME}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment"># 删除快照</span>
<span class="token function-name function">shot_del_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">\${host_node<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开始删除快照: <span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span> <span class="token variable">\${SHOT_NAME}</span> ...&quot;</span>
    <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws deleteSnapshot <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>/<span class="token variable">\${NODE_NAME}</span>-<span class="token variable">\${i}</span>.vmx&quot;</span> <span class="token variable">\${SHOT_NAME}</span>
    <span class="token function">sleep</span> <span class="token number">6</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
<span class="token comment"># 删除快照</span>
<span class="token function-name function">VM_shot_del</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
shot_del_master
<span class="token function">sleep</span> <span class="token number">6</span>
shot_del_node
<span class="token function">sleep</span> <span class="token number">6</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    批量删除快照完成:<span class="token variable">\${SHOT_NAME}</span>    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token function-name function">clone_del_master</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token string">&quot;<span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    批量删除克隆完成   <span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${MASTER_CLUSTER_NAME}</span>/ &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>
<span class="token function-name function">clone_del_node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    批量删除克隆完成  <span class="token variable">\${K8S_CENTOS7}</span>/<span class="token variable">\${NODE_CLUSTER_NAME}</span>/  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token function-name function">VM_clone_del</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
clone_del_master
clone_del_node
<span class="token function">sleep</span> <span class="token number">6</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    批量删除克隆完成    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># 获取当前正在运行的虚拟机</span>
<span class="token function-name function">VM_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;当前正在运行的虚拟机:&quot;</span>
  <span class="token variable">\${VMRUN_EXE}</span> <span class="token parameter variable">-T</span> ws list
<span class="token punctuation">}</span>

<span class="token keyword">case</span> <span class="token variable">$1</span> <span class="token keyword">in</span>
    c<span class="token punctuation">)</span>
        VM_create
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    c1<span class="token punctuation">)</span>
        clone_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    c2<span class="token punctuation">)</span>
        clone_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    start<span class="token punctuation">)</span>
        VM_start
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    start1<span class="token punctuation">)</span>
        start_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    start2<span class="token punctuation">)</span>
        start_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    stop<span class="token punctuation">)</span>
        VM_stop
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    stop1<span class="token punctuation">)</span>
        stop_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    stop2<span class="token punctuation">)</span>
        stop_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot<span class="token punctuation">)</span>
        VM_snapshot
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot1<span class="token punctuation">)</span>
        snapshot_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot2<span class="token punctuation">)</span>
        snapshot_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    set_ip<span class="token punctuation">)</span>
        VM_set_IP
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    set_ip1<span class="token punctuation">)</span>
        set_ip_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    set_ip2<span class="token punctuation">)</span>
        set_ip_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_back<span class="token punctuation">)</span>
        VM_shot_back
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_back1<span class="token punctuation">)</span>
        shot_back_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_back2<span class="token punctuation">)</span>
        shot_back_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_del<span class="token punctuation">)</span>
        VM_shot_del
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_del1<span class="token punctuation">)</span>
        shot_del_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_del2<span class="token punctuation">)</span>
        shot_del_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    clone_del<span class="token punctuation">)</span>
        VM_clone_del
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    clone_del1<span class="token punctuation">)</span>
        clone_del_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    clone_del2<span class="token punctuation">)</span>
        clone_del_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_list<span class="token punctuation">)</span>
        VM_shot_list
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_list1<span class="token punctuation">)</span>
        shot_list_node
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    shot_list2<span class="token punctuation">)</span>
        shot_list_master
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    list<span class="token punctuation">)</span>
        VM_list
        <span class="token punctuation">;</span><span class="token punctuation">;</span>

    *<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;bash <span class="token variable">$0</span> { c | start | set_ip | stop | shot | shot_list | shot_back | clone_del | shot_del | list }&quot;</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;bash <span class="token variable">$0</span> 每个参数后面都可以添加:1(master)|2(node)，如(c1,stop2,shot_list1)&quot;</span>
<span class="token keyword">esac</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="脚本-first-sh" tabindex="-1"><a class="header-anchor" href="#脚本-first-sh" aria-hidden="true">#</a> 脚本：<a href="#first.sh">first.sh</a></h3><h3 id="start-后-通过-嘉宾-set-ip1-bat-的方式来设置虚拟机-ip、hostname" tabindex="-1"><a class="header-anchor" href="#start-后-通过-嘉宾-set-ip1-bat-的方式来设置虚拟机-ip、hostname" aria-hidden="true">#</a> start 后，通过 嘉宾（set_ip1.bat） 的方式来设置虚拟机（ip、hostname）<a name="使用first.sh"></a></h3><p>脚本：<a href="#first.sh">first.sh</a></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>D:<span class="token punctuation">\\</span>rj-win<span class="token punctuation">\\</span>vm16<span class="token punctuation">\\</span>vmrun.exe <span class="token parameter variable">-T</span> ws <span class="token parameter variable">-gu</span> root <span class="token parameter variable">-gp</span> 123456a runProgramInGuest <span class="token string">&quot;F:<span class="token entity" title="\\v">\\v</span>m\\k8s\\master-cluster\\master-120\\master-120.vmx&quot;</span> /bin/bash /root/first.sh <span class="token number">120</span> master-120
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="三、" tabindex="-1"><a class="header-anchor" href="#三、" aria-hidden="true">#</a> 三、</h2><h2 id="四、" tabindex="-1"><a class="header-anchor" href="#四、" aria-hidden="true">#</a> 四、</h2><h2 id="五、" tabindex="-1"><a class="header-anchor" href="#五、" aria-hidden="true">#</a> 五、</h2><h2 id="六、" tabindex="-1"><a class="header-anchor" href="#六、" aria-hidden="true">#</a> 六、</h2>`,11);function Sn(Nn,An){const a=c("ExternalLinkIcon");return i(),p("div",null,[o(" more "),d,s("p",null,[s("a",v,[n("阿里镜像站"),e(a)])]),s("p",null,[s("a",k,[n("华为镜像站"),e(a)])]),m,s("p",null,[s("a",b,[n("https://mirrors.huaweicloud.com/home"),e(a)]),n(" 搜索 epel")]),g,h,f,_,q,s("blockquote",null,[w,x,s("p",null,[n('sed -i "s@https?😕/download.fedoraproject.org/pub@'),s("a",y,[n("https://repo.huaweicloud.com@g"),e(a)]),n('" /etc/yum.repos.d/epel.repo')])]),$,s("p",null,[s("a",E,[n("https://developer.aliyun.com/mirror/epel"),e(a)])]),M,S,N,A,s("p",null,[n("3 wget -O /etc/yum.repos.d/epel.repo "),s("a",T,[n("http://mirrors.aliyun.com/repo/epel-7.repo"),e(a)])]),V,s("p",null,[s("a",O,[n("https://kernel.org/"),e(a)])]),s("table",null,[s("thead",null,[s("tr",null,[D,C,P,s("th",null,[n("["),s("a",R,[n("tarball"),e(a)]),n("]")]),L,s("th",null,[n("["),s("a",I,[n("patch"),e(a)]),n("]")]),s("th",null,[n("["),s("a",U,[n("inc. patch"),e(a)]),n("]")]),s("th",null,[n("["),s("a",G,[n("view diff"),e(a)]),n("]")]),s("th",null,[n("["),s("a",F,[n("browse"),e(a)]),n("]")]),B])]),s("tbody",null,[s("tr",null,[z,W,H,s("td",null,[n("["),s("a",K,[n("tarball"),e(a)]),n("]")]),s("td",null,[n("["),s("a",X,[n("pgp"),e(a)]),n("]")]),s("td",null,[n("["),s("a",j,[n("patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Y,[n("inc. patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Z,[n("view diff"),e(a)]),n("]")]),s("td",null,[n("["),s("a",J,[n("browse"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Q,[n("changelog"),e(a)]),n("]")])]),s("tr",null,[ss,ns,as,s("td",null,[n("["),s("a",es,[n("tarball"),e(a)]),n("]")]),s("td",null,[n("["),s("a",ts,[n("pgp"),e(a)]),n("]")]),s("td",null,[n("["),s("a",ls,[n("patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",is,[n("inc. patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",ps,[n("view diff"),e(a)]),n("]")]),s("td",null,[n("["),s("a",os,[n("browse"),e(a)]),n("]")]),s("td",null,[n("["),s("a",cs,[n("changelog"),e(a)]),n("]")])]),s("tr",null,[rs,us,ds,s("td",null,[n("["),s("a",vs,[n("tarball"),e(a)]),n("]")]),s("td",null,[n("["),s("a",ks,[n("pgp"),e(a)]),n("]")]),s("td",null,[n("["),s("a",ms,[n("patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",bs,[n("inc. patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",gs,[n("view diff"),e(a)]),n("]")]),s("td",null,[n("["),s("a",hs,[n("browse"),e(a)]),n("]")]),s("td",null,[n("["),s("a",fs,[n("changelog"),e(a)]),n("]")])]),s("tr",null,[_s,qs,ws,s("td",null,[n("["),s("a",xs,[n("tarball"),e(a)]),n("]")]),s("td",null,[n("["),s("a",ys,[n("pgp"),e(a)]),n("]")]),s("td",null,[n("["),s("a",$s,[n("patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Es,[n("inc. patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Ms,[n("view diff"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Ss,[n("browse"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Ns,[n("changelog"),e(a)]),n("]")])]),s("tr",null,[As,Ts,Vs,s("td",null,[n("["),s("a",Os,[n("tarball"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Ds,[n("pgp"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Cs,[n("patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Ps,[n("inc. patch"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Rs,[n("view diff"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Ls,[n("browse"),e(a)]),n("]")]),s("td",null,[n("["),s("a",Is,[n("changelog"),e(a)]),n("]")])])])]),Us,s("p",null,[s("a",Gs,[n("http://www.elrepo.org/"),e(a)])]),Fs,s("p",null,[n("安装 VirtualBox ："),s("a",Bs,[n("https://download.virtualbox.org/virtualbox/6.1.34/VirtualBox-6.1.34-150636-Win.exe"),e(a)])]),s("p",null,[n("下载 vagrantfile："),s("a",zs,[n("https://releases.hashicorp.com/vagrant/2.2.19/"),e(a)])]),s("p",null,[n("查找下载centos7："),s("a",Ws,[n("https://app.vagrantup.com/boxes/search?utf8=✓&sort=downloads&provider=&q=centos"),e(a)])]),Hs,s("p",null,[s("a",Ks,[n("https://www.vagrantup.com/docs/disks"),e(a)])]),Xs,s("p",null,[js,n(),s("a",Ys,[n("vagrant"),e(a)]),n("、 "),s("a",Zs,[n("vmware-utility"),e(a)])]),Js,s("p",null,[Qs,n(),s("a",sn,[n("centos-box"),e(a)])]),nn,s("blockquote",null,[s("p",null,[s("a",an,[n("https://app.vagrantup.com/generic/boxes/centos7"),e(a)]),n(" (675 MB)")]),s("p",null,[s("a",en,[n("https://app.vagrantup.com/dds/boxes/vagrant-base-centos7"),e(a)]),n(" (:995MB)")])]),tn,s("blockquote",null,[s("p",null,[s("a",ln,[n("https://app.vagrantup.com/dds/boxes/vagrant-base-centos7"),e(a)]),n(" (:995MB)")])]),pn,s("p",null,[n("1、"),s("a",on,[n("clear.sh"),e(a)])]),cn,s("p",null,[n("2、"),s("a",rn,[n("init.sh"),e(a)])]),un,s("p",null,[n("3、"),s("a",dn,[n("install.sh"),e(a)])]),vn,s("p",null,[n("5、"),s("a",kn,[n("cp.sh"),e(a)]),n(" 虚拟机到新目录")]),mn,s("p",null,[s("a",bn,[n("https://docs.vmware.com/cn/"),e(a)])]),gn,s("p",null,[s("a",hn,[n("https://www.vmware.com/pdf/vix162_vmrun_command.pdf"),e(a)])]),s("p",null,[s("a",fn,[n("https://docs.vmware.com/cn/search/#/vmrun"),e(a)])]),_n,s("ol",null,[qn,wn,s("li",null,[n("编写脚本 "),s("a",xn,[n("auto.sh"),e(a)])]),yn,$n,En]),Mn])}const Vn=l(u,[["render",Sn],["__file","vagrant-vmware.html.vue"]]);export{Vn as default};
