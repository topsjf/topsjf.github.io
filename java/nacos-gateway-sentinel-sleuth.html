<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://topjf.github.io/java/nacos-gateway-sentinel-sleuth.html"><meta property="og:site_name" content="topjf"><meta property="og:title" content="nacos-gateway-sentinel-sleuth"><meta property="og:description" content="1ã€Nacos å®˜æ–¹åœ°å€ï¼šhttps://nacos.io githubåœ°å€ï¼šhttps://github.com/alibaba/nacos https://nacos.io/zh-cn/docs/quick-start-spring-boot.html é¢è¯•é¢˜ï¼šå¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼Ÿ 1. å…ˆå»æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æœåŠ¡çš„æœåŠ¡å™¨åœ°å€ 2. è°ƒç”¨æ–¹ç»™å¯¹æ–¹å‘é€..."><meta property="og:type" content="article"><meta property="og:image" content="https://topjf.github.io/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2022-12-16T06:02:03.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="nacos-gateway-sentinel-sleuth"><meta property="article:tag" content="Cloud"><meta property="article:published_time" content="2020-01-01T00:00:00.000Z"><meta property="article:modified_time" content="2022-12-16T06:02:03.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"nacos-gateway-sentinel-sleuth","image":["https://topjf.github.io/"],"datePublished":"2020-01-01T00:00:00.000Z","dateModified":"2022-12-16T06:02:03.000Z","author":[]}</script><script type="text/javascript" src="/script/demo.js"></script><link rel="stylesheet" href="/iconfont/iconfont.css"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>nacos-gateway-sentinel-sleuth | topjf</title><meta name="description" content="1ã€Nacos å®˜æ–¹åœ°å€ï¼šhttps://nacos.io githubåœ°å€ï¼šhttps://github.com/alibaba/nacos https://nacos.io/zh-cn/docs/quick-start-spring-boot.html é¢è¯•é¢˜ï¼šå¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼Ÿ 1. å…ˆå»æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æœåŠ¡çš„æœåŠ¡å™¨åœ°å€ 2. è°ƒç”¨æ–¹ç»™å¯¹æ–¹å‘é€...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-41a36a5c.css" as="style"><link rel="stylesheet" href="/assets/style-41a36a5c.css">
    <link rel="modulepreload" href="/assets/app-30d3d221.js"><link rel="modulepreload" href="/assets/framework-ed4f969a.js"><link rel="modulepreload" href="/assets/nacos-gateway-sentinel-sleuth.html-6519fe88.js"><link rel="modulepreload" href="/assets/nacos-gateway-sentinel-sleuth.html-12f97f23.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="topjf"><!----><span class="site-name hide-in-pad">topjf</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="é¦–é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/home.html" class="nav-link" aria-label="å¿«é€Ÿå¯¼èˆª"><span class="font-icon icon iconfont icon-arrow" style=""></span>å¿«é€Ÿå¯¼èˆª<!----></a></div><div class="nav-item hide-in-mobile"><a href="/all/all.html" class="nav-link" aria-label="é¢è¯•å®å…¸"><span class="font-icon icon iconfont icon-overflow" style=""></span>é¢è¯•å®å…¸<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ä¸ªäººä¸­å¿ƒ"><span class="title"><span class="font-icon icon iconfont icon-anonymous" style=""></span>ä¸ªäººä¸­å¿ƒ</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/article" class="nav-link" aria-label="æ–‡ç« "><span class="font-icon icon iconfont icon-note" style=""></span>æ–‡ç« <!----></a></li><li class="dropdown-item"><a href="/category" class="nav-link" aria-label="åˆ†ç±»"><span class="font-icon icon iconfont icon-categoryselected" style=""></span>åˆ†ç±»<!----></a></li><li class="dropdown-item"><a href="/tag" class="nav-link" aria-label="æ ‡ç­¾"><span class="font-icon icon iconfont icon-list" style=""></span>æ ‡ç­¾<!----></a></li><li class="dropdown-item"><a href="/encrypted" class="nav-link" aria-label="åŠ å¯†æ–‡ç« "><span class="font-icon icon iconfont icon-command" style=""></span>åŠ å¯†æ–‡ç« <!----></a></li><li class="dropdown-item"><a href="/star" class="nav-link" aria-label="æ”¶è—æ–‡ç« "><span class="font-icon icon iconfont icon-like" style=""></span>æ”¶è—æ–‡ç« <!----></a></li><li class="dropdown-item"><a href="/timeline" class="nav-link" aria-label="æ—¶é—´çº¿"><span class="font-icon icon iconfont icon-time" style=""></span>æ—¶é—´çº¿<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç½‘ç«™ç›¸å…³"><span class="title"><span class="font-icon icon iconfont icon-info" style=""></span>ç½‘ç«™ç›¸å…³</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/about/about-this.html" class="nav-link" aria-label="å…³äºæœ¬ç«™"><span class="font-icon icon iconfont icon-people" style=""></span>å…³äºæœ¬ç«™<!----></a></li><li class="dropdown-item"><a href="/history/history.html" class="nav-link" aria-label="ç½‘ç«™å†å²"><span class="font-icon icon iconfont icon-time" style=""></span>ç½‘ç«™å†å²<!----></a></li><li class="dropdown-item"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress Theme Hope æ–‡æ¡£" class="nav-link"><span class="font-icon icon iconfont icon-creative" style=""></span>VuePress Theme Hope æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/topjf/topjf" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">åŸºç¡€</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/java/basis/arraylist.html" class="nav-link sidebar-link sidebar-page" aria-label="ArrayListé›†åˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>ArrayListé›†åˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/basic-grammar.html" class="nav-link sidebar-link sidebar-page" aria-label="é¢å‘å¯¹è±¡åŸºç¡€"><span class="font-icon icon iconfont icon-edit" style=""></span>é¢å‘å¯¹è±¡åŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/data-structure.html" class="nav-link sidebar-link sidebar-page" aria-label="æ•°æ®ç»“æ„"><span class="font-icon icon iconfont icon-edit" style=""></span>æ•°æ®ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/exception.html" class="nav-link sidebar-link sidebar-page" aria-label="å¼‚å¸¸"><span class="font-icon icon iconfont icon-edit" style=""></span>å¼‚å¸¸<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/io-note.html" class="nav-link sidebar-link sidebar-page" aria-label="IOæ–‡ä»¶æµ"><span class="font-icon icon iconfont icon-edit" style=""></span>IOæ–‡ä»¶æµ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/mysql-setting.html" class="nav-link sidebar-link sidebar-page" aria-label="æ•°æ®åº“è®¾è®¡éœ€è¦æ³¨æ„ä»€ä¹ˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>æ•°æ®åº“è®¾è®¡éœ€è¦æ³¨æ„ä»€ä¹ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/oop.html" class="nav-link sidebar-link sidebar-page" aria-label="OOPæ ¸å¿ƒ"><span class="font-icon icon iconfont icon-edit" style=""></span>OOPæ ¸å¿ƒ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/string.html" class="nav-link sidebar-link sidebar-page" aria-label="å­—ç¬¦ä¸²ç»ƒä¹ "><span class="font-icon icon iconfont icon-edit" style=""></span>å­—ç¬¦ä¸²ç»ƒä¹ <!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/basis/web-servlet-jsp.html" class="nav-link sidebar-link sidebar-page" aria-label="servletåŸºç¡€"><span class="font-icon icon iconfont icon-edit" style=""></span>servletåŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><!--[--><a href="/java/test.html" class="nav-link sidebar-link sidebar-page" aria-label="æµ‹è¯•md"><span class="font-icon icon iconfont icon-edit" style=""></span>æµ‹è¯•md<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/java-log.html" class="nav-link sidebar-link sidebar-page" aria-label="Javaæ—¥å¿—æ¡†æ¶"><span class="font-icon icon iconfont icon-edit" style=""></span>Javaæ—¥å¿—æ¡†æ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/java-jsr303.html" class="nav-link sidebar-link sidebar-page" aria-label="JSR303æ ¡éªŒ"><span class="font-icon icon iconfont icon-edit" style=""></span>JSR303æ ¡éªŒ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/java-exception.html" class="nav-link sidebar-link sidebar-page" aria-label="å¼‚å¸¸å¤„ç†"><span class="font-icon icon iconfont icon-edit" style=""></span>å¼‚å¸¸å¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/PreventDuplicateSubmissions.html" class="nav-link sidebar-link sidebar-page" aria-label="session+redisé˜²æ­¢é‡å¤æäº¤"><span class="font-icon icon iconfont icon-edit" style=""></span>session+redisé˜²æ­¢é‡å¤æäº¤<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/23-design-patterns.html" class="nav-link sidebar-link sidebar-page" aria-label="23ç§è®¾è®¡æ¨¡å¼æ•´ç†"><span class="font-icon icon iconfont icon-edit" style=""></span>23ç§è®¾è®¡æ¨¡å¼æ•´ç†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm.html" class="nav-link sidebar-link sidebar-page" aria-label="jvm"><span class="font-icon icon iconfont icon-edit" style=""></span>jvm<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="nacos-gateway-sentinel-sleuth"><span class="font-icon icon iconfont icon-edit" style=""></span>nacos-gateway-sentinel-sleuth<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_1ã€nacos" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1ã€Nacos"><!---->1ã€Nacos<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#é¢è¯•é¢˜-å¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é¢è¯•é¢˜ï¼šå¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼Ÿ"><!---->é¢è¯•é¢˜ï¼šå¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#å¯ä»¥å¹²ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¯ä»¥å¹²ä»€ä¹ˆ"><!---->å¯ä»¥å¹²ä»€ä¹ˆ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#aã€spring-cloud" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Aã€spring cloud"><!---->Aã€spring cloud<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#bã€spring-boot" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Bã€spring boot"><!---->Bã€spring boot<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_2ã€-æœåŠ¡ç½‘å…³-gateway" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2ã€ æœåŠ¡ç½‘å…³ Gateway"><!---->2ã€ æœåŠ¡ç½‘å…³ Gateway<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label><!----><!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_3ã€openfeign-è¿œç¨‹è°ƒç”¨æœåŠ¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3ã€openfeign è¿œç¨‹è°ƒç”¨æœåŠ¡"><!---->3ã€openfeign è¿œç¨‹è°ƒç”¨æœåŠ¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-sentinel" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4. Sentinel"><!---->4. Sentinel<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_1ã€å®‰è£…-é…ç½®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1ã€å®‰è£…+é…ç½®"><!---->1ã€å®‰è£…+é…ç½®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_2ã€è‡ªå®šä¹‰æµæ§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2ã€è‡ªå®šä¹‰æµæ§"><!---->2ã€è‡ªå®šä¹‰æµæ§<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_3ã€ç†”æ–­ã€é™çº§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3ã€ç†”æ–­ã€é™çº§"><!---->3ã€ç†”æ–­ã€é™çº§<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº"><!---->4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-1-sentinel-æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.1. Sentinel æ˜¯ä»€ä¹ˆï¼Ÿ"><!---->4.1. Sentinel æ˜¯ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-2-åŸºæœ¬æ¦‚å¿µåŠä½œç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.2. åŸºæœ¬æ¦‚å¿µåŠä½œç”¨"><!---->4.2. åŸºæœ¬æ¦‚å¿µåŠä½œç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-3-å¿«é€Ÿå¼€å§‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.3. å¿«é€Ÿå¼€å§‹"><!---->4.3. å¿«é€Ÿå¼€å§‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-4-æ•´åˆfeignç»„ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.4. æ•´åˆFeignç»„ä»¶"><!---->4.4. æ•´åˆFeignç»„ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-5-æµé‡æ§åˆ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.5. æµé‡æ§åˆ¶"><!---->4.5. æµé‡æ§åˆ¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-6-ç†”æ–­é™çº§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.6. ç†”æ–­é™çº§"><!---->4.6. ç†”æ–­é™çº§<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-7-è§„åˆ™æŒä¹…åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.7. è§„åˆ™æŒä¹…åŒ–"><!---->4.7. è§„åˆ™æŒä¹…åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5ã€ç½‘å…³æµæ§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5ã€ç½‘å…³æµæ§"><!---->5ã€ç½‘å…³æµæ§<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-sleuth" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5. Sleuth"><!---->5. Sleuth<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-1-zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1. zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯"><!---->5.1. zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-2-æ”¹é€ consumer-providerå·¥ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2. æ”¹é€ consumer/providerå·¥ç¨‹"><!---->5.2. æ”¹é€ consumer/providerå·¥ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-3-åŸºæœ¬æ¦‚å¿µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.3. åŸºæœ¬æ¦‚å¿µ"><!---->5.3. åŸºæœ¬æ¦‚å¿µ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_6ã€sleuth-zipkin" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6ã€sleuth+zipkin"><!---->6ã€sleuth+zipkin<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_1ã€ä»‹ç»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1ã€ä»‹ç»"><!---->1ã€ä»‹ç»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_2ã€é…ç½®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2ã€é…ç½®"><!---->2ã€é…ç½®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_3ã€zipkinå¯è§†åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3ã€zipkinå¯è§†åŒ–"><!---->3ã€zipkinå¯è§†åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4ã€zipkin-æ•°æ®ä¿å­˜es" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4ã€zipkin æ•°æ®ä¿å­˜ES"><!---->4ã€zipkin æ•°æ®ä¿å­˜ES<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/java/nacos-note.html" class="nav-link sidebar-link sidebar-page" aria-label="Nacosç¬”è®°"><span class="font-icon icon iconfont icon-edit" style=""></span>Nacosç¬”è®°<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/oss.html" class="nav-link sidebar-link sidebar-page" aria-label="OSS"><span class="font-icon icon iconfont icon-edit" style=""></span>OSS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/spring-cloud-alibaba-note-basis.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringCloud-Alibabaé¡¹ç›®ç¬”è®°-åŸºç¡€ç¯‡"><span class="font-icon icon iconfont icon-edit" style=""></span>SpringCloud-Alibabaé¡¹ç›®ç¬”è®°-åŸºç¡€ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/spring-cloud-alibaba-note-high-level.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringCloud-Alibabaé¡¹ç›®ç¬”è®°-é«˜çº§ç¯‡"><span class="font-icon icon iconfont icon-edit" style=""></span>SpringCloud-Alibabaé¡¹ç›®ç¬”è®°-é«˜çº§ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/swagger.html" class="nav-link sidebar-link sidebar-page" aria-label="swagger"><span class="font-icon icon iconfont icon-edit" style=""></span>swagger<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/spring-cloud-core-components.html" class="nav-link sidebar-link sidebar-page" aria-label="spring cloud çš„å‡ å¤§ç»„ä»¶"><span class="font-icon icon iconfont icon-edit" style=""></span>spring cloud çš„å‡ å¤§ç»„ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/cloud-session.html" class="nav-link sidebar-link sidebar-page" aria-label="åˆ†å¸ƒå¼session"><span class="font-icon icon iconfont icon-edit" style=""></span>åˆ†å¸ƒå¼session<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/cloud-lock-cache.html" class="nav-link sidebar-link sidebar-page" aria-label="åˆ†å¸ƒå¼é”ã€ç¼“å­˜"><span class="font-icon icon iconfont icon-edit" style=""></span>åˆ†å¸ƒå¼é”ã€ç¼“å­˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/local-cloud-affairs-seata.html" class="nav-link sidebar-link sidebar-page" aria-label="æœ¬åœ°äº‹åŠ¡ã€åˆ†å¸ƒå¼äº‹åŠ¡åŠseata"><span class="font-icon icon iconfont icon-edit" style=""></span>æœ¬åœ°äº‹åŠ¡ã€åˆ†å¸ƒå¼äº‹åŠ¡åŠseata<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/single-sign-on.html" class="nav-link sidebar-link sidebar-page" aria-label="å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰"><span class="font-icon icon iconfont icon-edit" style=""></span>å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/timed-task.html" class="nav-link sidebar-link sidebar-page" aria-label="å®šæ—¶ä»»åŠ¡"><span class="font-icon icon iconfont icon-edit" style=""></span>å®šæ—¶ä»»åŠ¡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/asynchronous.html" class="nav-link sidebar-link sidebar-page" aria-label="å¼‚æ­¥"><span class="font-icon icon iconfont icon-edit" style=""></span>å¼‚æ­¥<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/mybatis-plus.html" class="nav-link sidebar-link sidebar-page" aria-label="æ•´åˆmybatis-plus"><span class="font-icon icon iconfont icon-edit" style=""></span>æ•´åˆmybatis-plus<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/permission-management.html" class="nav-link sidebar-link sidebar-page" aria-label="æƒé™ç®¡ç†"><span class="font-icon icon iconfont icon-edit" style=""></span>æƒé™ç®¡ç†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jmeter.html" class="nav-link sidebar-link sidebar-page" aria-label="jmeteræ€§èƒ½å‹æµ‹"><span class="font-icon icon iconfont icon-edit" style=""></span>jmeteræ€§èƒ½å‹æµ‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/template-engine-thymeleaf.html" class="nav-link sidebar-link sidebar-page" aria-label="æ¨¡æ¿å¼•æ“-Thymeleaf"><span class="font-icon icon iconfont icon-edit" style=""></span>æ¨¡æ¿å¼•æ“-Thymeleaf<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-featured" style=""></span><span class="title">æ–°ç‰¹æ€§</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/java/new-features/java8-common-new-features.html" class="nav-link sidebar-link sidebar-page" aria-label="Java8 æ–°ç‰¹æ€§å®æˆ˜"><span class="font-icon icon iconfont icon-edit" style=""></span>Java8 æ–°ç‰¹æ€§å®æˆ˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/new-features/java8-tutorial-translate.html" class="nav-link sidebar-link sidebar-page" aria-label="Java8 æŒ‡å—ä¸­æ–‡ç¿»è¯‘"><span class="font-icon icon iconfont icon-edit" style=""></span>Java8 æŒ‡å—ä¸­æ–‡ç¿»è¯‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/new-features/java9.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 9 æ–°ç‰¹æ€§æ¦‚è§ˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>Java 9 æ–°ç‰¹æ€§æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/new-features/java10.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 10 æ–°ç‰¹æ€§æ¦‚è§ˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>Java 10 æ–°ç‰¹æ€§æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/new-features/java11.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 11 æ–°ç‰¹æ€§æ¦‚è§ˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>Java 11 æ–°ç‰¹æ€§æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/new-features/java12-13.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 12 ~ 13 æ–°ç‰¹æ€§æ¦‚è§ˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>Java 12 ~ 13 æ–°ç‰¹æ€§æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/new-features/java14-15.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 14 ~ 15 æ–°ç‰¹æ€§æ¦‚è§ˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>Java 14 ~ 15 æ–°ç‰¹æ€§æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/new-features/java16.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 16 æ–°ç‰¹æ€§æ¦‚è§ˆ"><span class="font-icon icon iconfont icon-edit" style=""></span>Java 16 æ–°ç‰¹æ€§æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-edit" style=""></span>nacos-gateway-sentinel-sleuth</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="/article" target="_blank" rel="noopener noreferrer">topjf</a></span><span property="author" content="topjf"></span></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category2 clickable" role="navigation">Cloud</span><meta property="articleSection" content="Cloud"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag2 clickable" role="navigation">Cloud</span><meta property="keywords" content="Cloud"></span><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2020-01-01T00:00:00.000Z"></span><!----><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 8812 å­—</span><meta property="wordCount" content="8812"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 29 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT29M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_1ã€nacos" class="router-link-active router-link-exact-active toc-link level2">1ã€Nacos</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#é¢è¯•é¢˜-å¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">é¢è¯•é¢˜ï¼šå¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#å¯ä»¥å¹²ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">å¯ä»¥å¹²ä»€ä¹ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#aã€spring-cloud" class="router-link-active router-link-exact-active toc-link level3">Aã€spring cloud</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#bã€spring-boot" class="router-link-active router-link-exact-active toc-link level3">Bã€spring boot</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_2ã€-æœåŠ¡ç½‘å…³-gateway" class="router-link-active router-link-exact-active toc-link level2">2ã€ æœåŠ¡ç½‘å…³ Gateway</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#" class="router-link-active router-link-exact-active toc-link level3"></a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_3ã€openfeign-è¿œç¨‹è°ƒç”¨æœåŠ¡" class="router-link-active router-link-exact-active toc-link level2">3ã€openfeign è¿œç¨‹è°ƒç”¨æœåŠ¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-sentinel" class="router-link-active router-link-exact-active toc-link level2">4. Sentinel</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_1ã€å®‰è£…-é…ç½®" class="router-link-active router-link-exact-active toc-link level3">1ã€å®‰è£…+é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_2ã€è‡ªå®šä¹‰æµæ§" class="router-link-active router-link-exact-active toc-link level3">2ã€è‡ªå®šä¹‰æµæ§</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_3ã€ç†”æ–­ã€é™çº§" class="router-link-active router-link-exact-active toc-link level3">3ã€ç†”æ–­ã€é™çº§</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº" class="router-link-active router-link-exact-active toc-link level3">4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-1-sentinel-æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">4.1. Sentinel æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-2-åŸºæœ¬æ¦‚å¿µåŠä½œç”¨" class="router-link-active router-link-exact-active toc-link level3">4.2. åŸºæœ¬æ¦‚å¿µåŠä½œç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-3-å¿«é€Ÿå¼€å§‹" class="router-link-active router-link-exact-active toc-link level3">4.3. å¿«é€Ÿå¼€å§‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-4-æ•´åˆfeignç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">4.4. æ•´åˆFeignç»„ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-5-æµé‡æ§åˆ¶" class="router-link-active router-link-exact-active toc-link level3">4.5. æµé‡æ§åˆ¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-6-ç†”æ–­é™çº§" class="router-link-active router-link-exact-active toc-link level3">4.6. ç†”æ–­é™çº§</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4-7-è§„åˆ™æŒä¹…åŒ–" class="router-link-active router-link-exact-active toc-link level3">4.7. è§„åˆ™æŒä¹…åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5ã€ç½‘å…³æµæ§" class="router-link-active router-link-exact-active toc-link level3">5ã€ç½‘å…³æµæ§</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-sleuth" class="router-link-active router-link-exact-active toc-link level2">5. Sleuth</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-1-zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯" class="router-link-active router-link-exact-active toc-link level3">5.1. zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-2-æ”¹é€ consumer-providerå·¥ç¨‹" class="router-link-active router-link-exact-active toc-link level3">5.2. æ”¹é€ consumer/providerå·¥ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_5-3-åŸºæœ¬æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level3">5.3. åŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_6ã€sleuth-zipkin" class="router-link-active router-link-exact-active toc-link level2">6ã€sleuth+zipkin</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_1ã€ä»‹ç»" class="router-link-active router-link-exact-active toc-link level3">1ã€ä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_2ã€é…ç½®" class="router-link-active router-link-exact-active toc-link level3">2ã€é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_3ã€zipkinå¯è§†åŒ–" class="router-link-active router-link-exact-active toc-link level3">3ã€zipkinå¯è§†åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/nacos-gateway-sentinel-sleuth.html#_4ã€zipkin-æ•°æ®ä¿å­˜es" class="router-link-active router-link-exact-active toc-link level3">4ã€zipkin æ•°æ®ä¿å­˜ES</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!-- more --><h2 id="_1ã€nacos" tabindex="-1"><a class="header-anchor" href="#_1ã€nacos" aria-hidden="true">#</a> 1ã€Nacos</h2><p>å®˜æ–¹åœ°å€ï¼š<a href="https://nacos.io" target="_blank" rel="noopener noreferrer">https://nacos.io<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>githubåœ°å€ï¼š<a href="https://github.com/alibaba/nacos" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://nacos.io/zh-cn/docs/quick-start-spring-boot.html" target="_blank" rel="noopener noreferrer">https://nacos.io/zh-cn/docs/quick-start-spring-boot.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="é¢è¯•é¢˜-å¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#é¢è¯•é¢˜-å¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹" aria-hidden="true">#</a> é¢è¯•é¢˜ï¼šå¾®æœåŠ¡é—´è¿œç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼Ÿ</h3><ol><li>å…ˆå»æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æœåŠ¡çš„æœåŠ¡å™¨åœ°å€</li><li>è°ƒç”¨æ–¹ç»™å¯¹æ–¹å‘é€httpè¯·æ±‚</li></ol><h3 id="å¯ä»¥å¹²ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#å¯ä»¥å¹²ä»€ä¹ˆ" aria-hidden="true">#</a> å¯ä»¥å¹²ä»€ä¹ˆ</h3><p>Nacosæ˜¯ä»¥æœåŠ¡ä¸ºä¸»è¦æœåŠ¡å¯¹è±¡çš„ä¸­é—´ä»¶ï¼ŒNacosæ”¯æŒæ‰€æœ‰ä¸»æµçš„æœåŠ¡å‘ç°ã€é…ç½®å’Œç®¡ç†ã€‚</p><p>Nacosä¸»è¦æä¾›ä»¥ä¸‹å››å¤§åŠŸèƒ½ï¼š</p><ol><li>æœåŠ¡å‘ç°å’ŒæœåŠ¡å¥åº·ç›‘æµ‹</li><li>åŠ¨æ€é…ç½®æœåŠ¡</li><li>åŠ¨æ€DNSæœåŠ¡</li><li>æœåŠ¡åŠå…¶å…ƒæ•°æ®ç®¡ç†</li></ol><h3 id="aã€spring-cloud" tabindex="-1"><a class="header-anchor" href="#aã€spring-cloud" aria-hidden="true">#</a> Aã€spring cloud</h3><table><thead><tr><th>ç‰ˆæœ¬</th><th>spring cloud</th><th>springboot</th></tr></thead><tbody><tr><td>Spring Cloud Greenwich</td><td>2.1.x. RELEASE</td><td>2.1 x.RELEASE</td></tr><tr><td>Spring Cloud Finchley</td><td>2.0.x. RELEASE</td><td>2.0.x.RELEASE</td></tr><tr><td>Spring Cloud Edgware</td><td>1.5.x.RELEASE</td><td>1.5.x.REL EASE</td></tr></tbody></table><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>commenï¼š    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
æ¨¡å—ï¼š
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-cloud.version</span><span class="token punctuation">&gt;</span></span>Greenwich.SR3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-cloud.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${spring-cloud.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="nacos-æ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#nacos-æ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> nacos æ³¨å†Œä¸­å¿ƒ</h4><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>commonï¼š
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>nacos-config-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.2.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨åº”ç”¨çš„ application.properties é…ç½®æ–‡ä»¶ä¸­é…ç½® Nacos Server åœ°å€</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code> spring.cloud.nacos.discovery.server-addr<span class="token operator">=</span><span class="token number">127.0</span>.0.1:8848
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Aã€éœ€è¦ä¸‹è½½nacosï¼š<a href="https://github.com/alibaba/nacos/releases" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos/releases<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mvn -Prelease-nacos clean <span class="token function">install</span> <span class="token parameter variable">-U</span>
./startup.sh <span class="token parameter variable">-m</span> standalone
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Bã€docker å®‰è£…nacosï¼š docker pull nacos/nacos-mysql:5.7ï¼ˆdocker pull nacos/nacos-serverï¼‰</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> pull nacos/nacos-mysql:5.7
<span class="token function">docker</span> pull nacos/nacos-server
<span class="token function">docker</span> run <span class="token parameter variable">--env</span> <span class="token assign-left variable">MODE</span><span class="token operator">=</span>standalone <span class="token parameter variable">--name</span> nacos <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8848</span>:8848 nacos/nacos-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="nacos-é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#nacos-é…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> nacos é…ç½®ä¸­å¿ƒ</h4><h5>æ‰‹åŠ¨åŠ è½½</h5><p>common</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code> <span class="token comment">&lt;!--        é…ç½®ä¸­å¿ƒæ¥åšé…ç½®ç®¡ç†--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>yumall-coupon</p><p>åˆ›å»ºbootstrapï¼Œä¼˜å…ˆäºxxxx.properties</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code>bootstrap.propertiesï¼šï¼šï¼šï¼šï¼šï¼šï¼š
<span class="token key attr-name">	spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">yumall-coupon</span>
<span class="token comment">	#é…ç½®ä¸­å¿ƒ		</span>
<span class="token key attr-name">	spring.cloud.nacos.config.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>
--------------------------
application.propertiesï¼šï¼šï¼šï¼šï¼šï¼š
<span class="token key attr-name">	coupon.user.name</span><span class="token punctuation">=</span><span class="token value attr-value">zhangsan2</span>
<span class="token key attr-name">	coupon.user.age</span><span class="token punctuation">=</span><span class="token value attr-value">20</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯• <a href="http://localhost:8400/coupon/coupon/test" target="_blank" rel="noopener noreferrer">http://localhost:8400/coupon/coupon/test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;coupon/coupon&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponController</span> <span class="token punctuation">{</span>
<span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${coupon.user.name}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${coupon.user.age}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;zhangsan2&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5>è‡ªåŠ¨åŠ è½½é…ç½®æ–‡ä»¶</h5><p>nacos--ã€‹é…ç½®åˆ—è¡¨-ã€‹æ–°å»ºï¼šyumall-coupon.properties</p><div class="language-Java line-numbers-mode" data-ext="Java"><pre class="language-Java"><code>@RefreshScope //è‡ªåŠ¨åŠ è½½é…ç½®æ–‡ä»¶
@RestController
@RequestMapping(&quot;coupon/coupon&quot;)
public class CouponController {....}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>http<span class="token operator">:</span><span class="token comment">//localhost:8400/coupon/coupon/test</span>
<span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;zhangsan2&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">}</span>
####ä¿®æ”¹ yumall-coupon.properties
<span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;zhang&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h4><p>ä¼˜å…ˆä½¿ç”¨é…ç½®ä¸­å¿ƒçš„é…ç½®</p><div class="language-Java line-numbers-mode" data-ext="Java"><pre class="language-Java"><code>/**
 * 1ã€å¦‚ä½•ä½¿ç”¨Nacosä½œä¸ºé…ç½®ä¸­å¿ƒç»Ÿä¸€ç®¡ç†é…ç½®
 *
 * 1ï¼‰ã€å¼•å…¥ä¾èµ–ï¼Œ
 *         &lt;dependency&gt;
 *             &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
 *             &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
 *         &lt;/dependency&gt;
 * 2ï¼‰ã€åˆ›å»ºä¸€ä¸ªbootstrap.propertiesã€‚
 *      spring.application.name=yumall-coupon
 *      spring.cloud.nacos.config.server-addr=127.0.0.1:8848
 * 3ï¼‰ã€éœ€è¦ç»™é…ç½®ä¸­å¿ƒé»˜è®¤æ·»åŠ ä¸€ä¸ªå« æ•°æ®é›†ï¼ˆData Idï¼‰gulimall-coupon.propertiesã€‚é»˜è®¤è§„åˆ™ï¼Œåº”ç”¨å.properties
 * 4ï¼‰ã€ç»™ åº”ç”¨å.properties æ·»åŠ ä»»ä½•é…ç½®
 * 5ï¼‰ã€åŠ¨æ€è·å–é…ç½®ã€‚
 *      @RefreshScopeï¼šåŠ¨æ€è·å–å¹¶åˆ·æ–°é…ç½®
 *      @Value(&quot;${é…ç½®é¡¹çš„å}&quot;)ï¼šè·å–åˆ°é…ç½®ã€‚
 *      å¦‚æœé…ç½®ä¸­å¿ƒå’Œå½“å‰åº”ç”¨çš„é…ç½®æ–‡ä»¶ä¸­éƒ½é…ç½®äº†ç›¸åŒçš„é¡¹ï¼Œä¼˜å…ˆä½¿ç”¨é…ç½®ä¸­å¿ƒçš„é…ç½®ã€‚
 *
 * 2ã€ç»†èŠ‚
 *  
 *
 * 3ã€åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®é›†
 * 1)ã€å¾®æœåŠ¡ä»»ä½•é…ç½®ä¿¡æ¯ï¼Œä»»ä½•é…ç½®æ–‡ä»¶éƒ½å¯ä»¥æ”¾åœ¨é…ç½®ä¸­å¿ƒä¸­
 * 2ï¼‰ã€åªéœ€è¦åœ¨bootstrap.propertiesè¯´æ˜åŠ è½½é…ç½®ä¸­å¿ƒä¸­å“ªäº›é…ç½®æ–‡ä»¶å³å¯
 * 3ï¼‰ã€@Valueï¼Œ@ConfigurationPropertiesã€‚ã€‚ã€‚
 * ä»¥å‰SpringBootä»»ä½•æ–¹æ³•ä»é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ï¼Œéƒ½èƒ½ä½¿ç”¨ã€‚
 * é…ç½®ä¸­å¿ƒæœ‰çš„ä¼˜å…ˆä½¿ç”¨é…ç½®ä¸­å¿ƒä¸­çš„ï¼Œ
 */
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#ç»†èŠ‚" aria-hidden="true">#</a> ç»†èŠ‚</h4><h5>å‘½åç©ºé—´ã€é…ç½®é›†ã€é…ç½®é›†IDã€é…ç½®åˆ†ç»„</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 1ï¼‰ã€å‘½åç©ºé—´ï¼šé…ç½®éš”ç¦»ï¼›
 *      é»˜è®¤ï¼špublic(ä¿ç•™ç©ºé—´)ï¼›é»˜è®¤æ–°å¢çš„æ‰€æœ‰é…ç½®éƒ½åœ¨publicç©ºé—´ã€‚
 *      1ã€å¼€å‘ï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ï¼šåˆ©ç”¨å‘½åç©ºé—´æ¥åšç¯å¢ƒéš”ç¦»ã€‚
 *         æ³¨æ„ï¼šåœ¨bootstrap.propertiesï¼›é…ç½®ä¸Šï¼Œéœ€è¦ä½¿ç”¨å“ªä¸ªå‘½åç©ºé—´ä¸‹çš„é…ç½®ï¼Œ
 *         spring.cloud.nacos.config.namespace=9de62e44-cd2a-4a82-bf5c-95878bd5e871
 *      2ã€æ¯ä¸€ä¸ªå¾®æœåŠ¡ä¹‹é—´äº’ç›¸éš”ç¦»é…ç½®ï¼Œæ¯ä¸€ä¸ªå¾®æœåŠ¡éƒ½åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ï¼ŒåªåŠ è½½è‡ªå·±å‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰é…ç½®
 * 2ï¼‰ã€é…ç½®é›†ï¼šæ‰€æœ‰çš„é…ç½®çš„é›†åˆ
 * 3ï¼‰ã€é…ç½®é›†IDï¼šç±»ä¼¼æ–‡ä»¶åã€‚
 *      Data IDï¼šç±»ä¼¼æ–‡ä»¶å
 * 4ï¼‰ã€é…ç½®åˆ†ç»„ï¼š
 *      é»˜è®¤æ‰€æœ‰çš„é…ç½®é›†éƒ½å±äºï¼šDEFAULT_GROUPï¼›
 *      1111ï¼Œ618ï¼Œ1212
 *
 * é¡¹ç›®ä¸­çš„ä½¿ç”¨ï¼šæ¯ä¸ªå¾®æœåŠ¡åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ï¼Œä½¿ç”¨é…ç½®åˆ†ç»„åŒºåˆ†ç¯å¢ƒï¼Œdevï¼Œtestï¼Œprod
 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6>åˆ›å»ºå‘½åç©ºé—´</h6><p>åœ¨prodç©ºé—´åˆ›å»º yumall-coupon.properties</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">coupon.user.name</span><span class="token punctuation">=</span><span class="token value attr-value">zzz</span>
<span class="token key attr-name">coupon.user.age</span><span class="token punctuation">=</span><span class="token value attr-value">222</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®æ–‡ä»¶ä½¿ç”¨</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">#æŒ‡å®šå‘½åç©ºé—´</span>
<span class="token key attr-name">spring.cloud.nacos.config.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">d1ed6f76-3248-4166-ae01-13ab72eaea60</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>http<span class="token operator">:</span><span class="token comment">//localhost:8400/coupon/coupon/test</span>

<span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;zzz&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token number">222</span><span class="token punctuation">}</span>
ä¿®æ”¹prod---yumall-coupon.properties
<span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;zzz222&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token number">2022</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯ä¸€ä¸ªå¾®æœåŠ¡ä¹‹é—´äº’ç›¸éš”ç¦»é…ç½®ï¼Œæ¯ä¸€ä¸ªå¾®æœåŠ¡éƒ½åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ï¼ŒåªåŠ è½½è‡ªå·±å‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰é…ç½®</p><table><thead><tr><th style="text-align:left;">å‘½åç©ºé—´åç§°</th><th style="text-align:left;">å‘½åç©ºé—´ID</th><th style="text-align:left;">é…ç½®æ•°</th><th style="text-align:left;">æ“ä½œ</th></tr></thead><tbody><tr><td style="text-align:left;">public(ä¿ç•™ç©ºé—´)</td><td style="text-align:left;"></td><td style="text-align:left;">1</td><td style="text-align:left;">è¯¦æƒ…åˆ é™¤ç¼–è¾‘</td></tr><tr><td style="text-align:left;">coupon</td><td style="text-align:left;">ce7e5c1c-645e-460f-b486-bc4659d2207b</td><td style="text-align:left;">0</td><td style="text-align:left;">è¯¦æƒ…åˆ é™¤ç¼–è¾‘</td></tr><tr><td style="text-align:left;">product</td><td style="text-align:left;">9b620b25-6af6-46b3-a430-2f5e9fd79e5a</td><td style="text-align:left;">0</td><td style="text-align:left;">è¯¦æƒ…åˆ é™¤ç¼–è¾‘</td></tr><tr><td style="text-align:left;">ware</td><td style="text-align:left;">aa5b7425-7db2-4ed9-a608-e84163837478</td><td style="text-align:left;">0</td><td style="text-align:left;">è¯¦æƒ…åˆ é™¤ç¼–è¾‘</td></tr><tr><td style="text-align:left;">member</td><td style="text-align:left;">acce6cd5-2d58-412f-903a-7d22ab41d7ea</td><td style="text-align:left;">0</td><td style="text-align:left;">è¯¦æƒ…åˆ é™¤ç¼–è¾‘</td></tr><tr><td style="text-align:left;">order</td><td style="text-align:left;">afdf7969-5d7b-460f-8e53-f4c35da8c060</td><td style="text-align:left;">0</td><td style="text-align:left;">è¯¦æƒ…åˆ é™¤ç¼–è¾‘</td></tr><tr><td style="text-align:left;">coupon</td><td style="text-align:left;">ce7e5c1c-645e-460f-b486-bc4659d2207b</td><td style="text-align:left;">0</td><td style="text-align:left;">è¯¦æƒ…åˆ é™¤ç¼–è¾‘</td></tr></tbody></table><p>æŠŠå…‹éš†åˆ°è‡ªå·±çš„å‘½åç©ºé—´å†…ï¼Œå¹¶é¡¹ç›®æ›´æ–°é…ç½®æ–‡ä»¶</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.cloud.nacos.config.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">ce7e5c1c-645e-460f-b486-bc4659d2207b</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åˆ·æ–°OK</p><h6>é…ç½®åˆ†ç»„</h6><ul><li><pre><code> é»˜è®¤æ‰€æœ‰çš„é…ç½®é›†éƒ½å±äºï¼šDEFAULT_GROUPï¼›
</code></pre></li><li><pre><code> testï¼Œ618ï¼Œ1212
</code></pre></li></ul><p>couponç©ºé—´æ–°å»ºé…ç½® yumall-coupon.properties</p><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;">Data Id</th><th style="text-align:left;">Group</th><th style="text-align:left;">æ“ä½œ</th><th></th></tr></thead><tbody><tr><td style="text-align:left;"></td><td style="text-align:left;">yumall-coupon.properties</td><td style="text-align:left;">DEFAULT_GROUP</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">yumall-coupon.properties</td><td style="text-align:left;">test</td><td style="text-align:left;"></td><td></td></tr></tbody></table><p>æŒ‡å®šç»„</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.cloud.nacos.config.group</span><span class="token punctuation">=</span><span class="token value attr-value">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ¯ä¸ªå¾®æœåŠ¡åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ï¼Œä½¿ç”¨é…ç½®åˆ†ç»„åŒºåˆ†ç¯å¢ƒï¼Œdevï¼Œtestï¼Œprod</p><p>yumall-coupon.properties</p><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;">Data Id</th><th style="text-align:left;">Group</th></tr></thead><tbody><tr><td style="text-align:left;"></td><td style="text-align:left;">yumall-coupon.properties</td><td style="text-align:left;">test</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">yumall-coupon.properties</td><td style="text-align:left;">prod</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">yumall-coupon.properties</td><td style="text-align:left;">dev</td></tr></tbody></table><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.cloud.nacos.config.group</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><a href="http://localhost:8400/coupon/coupon/test" target="_blank" rel="noopener noreferrer">http://localhost:8400/coupon/coupon/test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;dev00&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;age&quot;</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="å…¨éƒ¨åŠ è½½å¤šé…ç½®é›†" tabindex="-1"><a class="header-anchor" href="#å…¨éƒ¨åŠ è½½å¤šé…ç½®é›†" aria-hidden="true">#</a> å…¨éƒ¨åŠ è½½å¤šé…ç½®é›†</h4><h5>nacosåˆ›å»ºé…ç½®é›†</h5><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;">Data Id</th><th style="text-align:left;">Group</th><th style="text-align:left;">å½’å±åº”ç”¨:</th><th style="text-align:left;">æ“ä½œ</th></tr></thead><tbody><tr><td style="text-align:left;"></td><td style="text-align:left;">yumall-coupon.properties</td><td style="text-align:left;">prod</td><td style="text-align:left;"></td><td style="text-align:left;">è¯¦æƒ…|ç¤ºä¾‹ä»£ç |ç¼–è¾‘|åˆ é™¤|æ›´å¤š</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">datasource.yml</td><td style="text-align:left;">dev</td><td style="text-align:left;"></td><td style="text-align:left;">è¯¦æƒ…|ç¤ºä¾‹ä»£ç |ç¼–è¾‘|åˆ é™¤|æ›´å¤š</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">mybatis.yml</td><td style="text-align:left;">dev</td><td style="text-align:left;"></td><td style="text-align:left;">è¯¦æƒ…|ç¤ºä¾‹ä»£ç |ç¼–è¾‘|åˆ é™¤|æ›´å¤š</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">redis.yml</td><td style="text-align:left;">dev</td><td style="text-align:left;"></td><td style="text-align:left;">è¯¦æƒ…|ç¤ºä¾‹ä»£ç |ç¼–è¾‘|åˆ é™¤|æ›´å¤š</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">nacos.yml</td><td style="text-align:left;">dev</td><td style="text-align:left;"></td><td style="text-align:left;">è¯¦æƒ…|ç¤ºä¾‹ä»£ç |ç¼–è¾‘|åˆ é™¤|æ›´å¤š</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">yumall-coupon.properties</td><td style="text-align:left;">dev</td><td style="text-align:left;"></td><td style="text-align:left;">è¯¦æƒ…|ç¤ºä¾‹ä»£ç |ç¼–è¾‘|åˆ é™¤|æ›´å¤š</td></tr></tbody></table><h5>é…ç½®æ–‡ä»¶</h5><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">yumall-coupon</span>
<span class="token comment">#é…ç½®ä¸­å¿ƒ</span>
<span class="token key attr-name">spring.cloud.nacos.config.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>
<span class="token comment">##æŒ‡å®šå‘½åç©ºé—´</span>
<span class="token key attr-name">spring.cloud.nacos.config.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">bef46632-ac77-4fac-b493-ad31926761be</span>
<span class="token comment">##prod dev</span>
<span class="token key attr-name">spring.cloud.nacos.config.group</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
<span class="token comment">#refresh è‡ªåŠ¨åˆ·æ–°é…ç½®</span>
<span class="token comment">#åŸºæœ¬é…ç½®</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[0].data-id</span><span class="token punctuation">=</span><span class="token value attr-value">other.yml</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[0].group</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[0].refresh</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment">#æ•°æ®æº</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[1].data-id</span><span class="token punctuation">=</span><span class="token value attr-value">datasource.yml</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[1].group</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[1].refresh</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment">#mybatis-plus</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[2].data-id</span><span class="token punctuation">=</span><span class="token value attr-value">mybatis.yml</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[2].group</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[2].refresh</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment">#redis</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[3].data-id</span><span class="token punctuation">=</span><span class="token value attr-value">redis.yml</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[3].group</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
<span class="token key attr-name">spring.cloud.nacos.config.ext-config[3].refresh</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment">#å¤šæ•°æ®æº</span>
<span class="token comment">#spring.cloud.nacos.config.ext-config[4].data-id=dynamic.yml</span>
<span class="token comment">#spring.cloud.nacos.config.ext-config[4].group=dev</span>
<span class="token comment">#spring.cloud.nacos.config.ext-config[4].refresh=true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1" aria-hidden="true">#</a> æ€»ç»“</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">3</span>ã€åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®é›†
 <span class="token number">1</span><span class="token punctuation">)</span>ã€å¾®æœåŠ¡ä»»ä½•é…ç½®ä¿¡æ¯ï¼Œä»»ä½•é…ç½®æ–‡ä»¶éƒ½å¯ä»¥æ”¾åœ¨é…ç½®ä¸­å¿ƒä¸­
 <span class="token number">2</span>ï¼‰ã€åªéœ€è¦åœ¨bootstrap.propertiesè¯´æ˜åŠ è½½é…ç½®ä¸­å¿ƒä¸­å“ªäº›é…ç½®æ–‡ä»¶å³å¯
 <span class="token number">3</span>ï¼‰ã€@Valueï¼Œ@ConfigurationProperties
 ä»¥å‰SpringBootä»»ä½•æ–¹æ³•ä»é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ï¼Œéƒ½èƒ½ä½¿ç”¨ã€‚
 é…ç½®ä¸­å¿ƒæœ‰çš„ä¼˜å…ˆä½¿ç”¨é…ç½®ä¸­å¿ƒä¸­çš„
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…¨éƒ¨æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#å…¨éƒ¨æµ‹è¯•" aria-hidden="true">#</a> å…¨éƒ¨æµ‹è¯•:</h4><p><a href="http://localhost:8100/product/attr/test" target="_blank" rel="noopener noreferrer">http://localhost:8100/product/attr/test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="http://localhost:8200/order/order/test" target="_blank" rel="noopener noreferrer">http://localhost:8200/order/order/test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="http://localhost:8300/ware/wareinfo/test" target="_blank" rel="noopener noreferrer">http://localhost:8300/ware/wareinfo/test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="http://localhost:8400/coupon/coupon/test" target="_blank" rel="noopener noreferrer">http://localhost:8400/coupon/coupon/test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="http://localhost:8500/member/member/test" target="_blank" rel="noopener noreferrer">http://localhost:8500/member/member/test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="bã€spring-boot" tabindex="-1"><a class="header-anchor" href="#bã€spring-boot" aria-hidden="true">#</a> Bã€spring boot</h3><p>â€‹ é¡¹ç›®ä¸­æ²¡æœ‰ä½¿ç”¨nacoså®˜æ–¹æä¾›çš„æ–¹å¼ä½¿ç”¨SpringBootçš„é›†æˆæ–¹å¼æ¥è¿›è¡Œé›†æˆï¼Œè€Œæ˜¯ä½¿ç”¨äº†Alibaba Spring Cloudçš„ä¾èµ–åŒ…è¿›è¡Œé›†æˆã€‚</p><p>â€‹ åŸå› æ˜¯å› ä¸ºå®˜ç½‘æä¾›çš„SpringBooté›†æˆæ–¹å¼ä¸­ï¼ŒåŒæ—¶ä½¿ç”¨é…ç½®ä¸­å¿ƒå’ŒæœåŠ¡å‘ç°åŠŸèƒ½ï¼Œä¼šä½¿å¾—æœåŠ¡å‘ç°åŠŸèƒ½é…ç½®çš„éƒ¨åˆ†å±æ€§å†²çªä¸ç”Ÿæ•ˆã€‚æœ€ç›´æ¥çš„å°±æ˜¯é…ç½®ä¸­å¿ƒå’ŒæœåŠ¡å‘ç°åŠŸèƒ½ä¸å¯ä»¥é…ç½®2ä¸ªä¸åŒçš„namespaceï¼Œä¼šé»˜è®¤é€‰æ‹©ä½¿ç”¨é…ç½®ä¸­å¿ƒä¸­é…ç½®çš„namespaceä½œä¸ºæœåŠ¡å‘ç°çš„ namespaceã€‚</p><p>â€‹ <strong>ç”±äºspring cloud alibaba nacos configçš„åŠ è½½æœºåˆ¶é—®é¢˜ï¼Œé…ç½®ä¿¡æ¯å¦‚æœå†™åœ¨äº† application-{xx}.yml çš„é…ç½®æ–‡ä»¶ä¸­æ— æ³•è¢«è§£æã€‚æ‰€ä»¥å¦‚æœéœ€è¦åˆ†å¤šç¯å¢ƒåŠ¨æ€åŠ è½½ï¼Œå¯ä»¥å†™åœ¨ bootstrap-{xxx}.yml æ–‡ä»¶ä¸­ã€‚</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.12.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.5.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.5.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bootstrap-{xxx}.yml</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
        <span class="token key atrule">namespace</span><span class="token punctuation">:</span> ec067xxxxxxxxx
        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yml
        <span class="token key atrule">extension-configs</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> other.yml
            <span class="token key atrule">group</span><span class="token punctuation">:</span> dev
            <span class="token key atrule">refresh</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> redis.yml
            <span class="token key atrule">group</span><span class="token punctuation">:</span> dev
            <span class="token key atrule">refresh</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> oss.yml
            <span class="token key atrule">group</span><span class="token punctuation">:</span> dev
            <span class="token key atrule">refresh</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é—®é¢˜ï¼š</p><div class="language-ABAP line-numbers-mode" data-ext="ABAP"><pre class="language-ABAP"><code>com.alibaba.nacos.client.naming : [initializer namespace from System Property :null]
com.alibaba.nacos.client.naming : [initializer namespace from System Environment :null]
com.alibaba.nacos.client.naming : [initializer namespace from System Property :null]

Ignore the empty nacos configuration and get it based on dataId[codetools] &amp; group[DEFAULT_GROUP]
Ignore the empty nacos configuration and get it based on dataId[codetools.yml] &amp; group[DEFAULT_GROUP]
Ignore the empty nacos configuration and get it based on dataId[codetools-prod.yml] &amp; group[DEFAULT_GROUP]

Error creating bean with name &#39;testController&#39;: Injection of autowired dependencies failed; nested exception is java.lang.IllegalArgumentException: Could not resolve placeholder &#39;user1.name&#39; in value &quot;${user1.name}&quot;

è§£å†³åŠæ³•ï¼šapplication-*.yml æ¢æˆ bootstrap-*.yml
application-dev.yml		bootstrap-dev.yml
application-prod.yml	bootstrap-prod.yml
application-test.yml	bootstrap-test.yml
application.yml			bootstrap.yml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${user1.name}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${spring.redis.open}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> <span class="token keyword">open</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/log&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;name:&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;,open:&quot;</span> <span class="token operator">+</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;=====æµ‹è¯•æ—¥å¿— debug çº§åˆ«æ‰“å°====&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;======æµ‹è¯•æ—¥å¿— info çº§åˆ«æ‰“å°=====&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;=====æµ‹è¯•æ—¥å¿— error çº§åˆ«æ‰“å°====&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;======æµ‹è¯•æ—¥å¿— warn çº§åˆ«æ‰“å°=====&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> str<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2ã€-æœåŠ¡ç½‘å…³-gateway" tabindex="-1"><a class="header-anchor" href="#_2ã€-æœåŠ¡ç½‘å…³-gateway" aria-hidden="true">#</a> 2ã€ æœåŠ¡ç½‘å…³ Gateway</h2><h3 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h3><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>  
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> product_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//yumall<span class="token punctuation">-</span>product
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/api/product/<span class="token important">**</span>
          <span class="token key atrule">filters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> RewritePath=/api/(<span class="token punctuation">?</span>&lt;segment<span class="token punctuation">&gt;</span>.<span class="token important">*)</span><span class="token punctuation">,</span>/$\<span class="token punctuation">{</span>segment<span class="token punctuation">}</span>  
            
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> admin_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//renren<span class="token punctuation">-</span>fast 	lbï¼šè´Ÿè½½å‡è¡¡ï¼Œ//åˆ°å“ªä¸ªæœåŠ¡
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>				æ–­è¨€
            <span class="token punctuation">-</span> Path=/api/<span class="token important">**</span>
          <span class="token key atrule">filters</span><span class="token punctuation">:</span>					RewritePathé‡å†™è·¯å¾„
            <span class="token punctuation">-</span> RewritePath=/api/(<span class="token punctuation">?</span>&lt;segment<span class="token punctuation">&gt;</span>.<span class="token important">*)</span><span class="token punctuation">,</span>/renren<span class="token punctuation">-</span>fast/$\<span class="token punctuation">{</span>segment<span class="token punctuation">}</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºgatewayé¡¹ç›®ï¼Œå¼•å…¥gatewayä¾èµ–ï¼Œ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>kong<span class="token punctuation">.</span>yumall<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>yumall<span class="token operator">-</span>common<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">0.0</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>exclusions<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>baomidou<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mybatis<span class="token operator">-</span>plus<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>exclusion<span class="token punctuation">&gt;</span></span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>alibaba<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
                    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>druid<span class="token operator">-</span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>exclusion<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>exclusions<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>cloud<span class="token operator">-</span>starter<span class="token operator">-</span>gateway<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> 
<span class="token doc-comment comment">/**
 * 1ã€å¼€å¯æœåŠ¡æ³¨å†Œå‘ç°
 * (é…ç½®nacosçš„æ³¨å†Œä¸­å¿ƒåœ°å€)
 * 2ã€ç¼–å†™ç½‘å…³é…ç½®æ–‡ä»¶
 */</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YumallGatewayApplication</span> <span class="token punctuation">{</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>application.properties</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">yumall-gateway</span>
<span class="token key attr-name">spring.cloud.nacos.discovery.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">50000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bootstrap.properties</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">yumall-gateway</span>
<span class="token key attr-name">spring.cloud.nacos.config.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>
<span class="token key attr-name">spring.cloud.nacos.config.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">e8fdcd97-4d77-4da5-8b2b-bd70f36ffbc3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–­è¨€:application.yml</p><p><a href="https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.5.RELEASE/single/spring-cloud-gateway.html" target="_blank" rel="noopener noreferrer">https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.5.RELEASE/single/spring-cloud-gateway.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> query_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//example.org
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Query=foo<span class="token punctuation">,</span> ba

        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> test_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//www.baidu.com
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Query=url<span class="token punctuation">,</span> baidu

        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> qq_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//www.qq.com
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Query=url<span class="token punctuation">,</span> qq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯• <a href="http://localhost:50000/hello?foo=ba" target="_blank" rel="noopener noreferrer">http://localhost:50000/hello?foo=ba<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ---- <a href="http://localhost:50000/hello?url=baidu" target="_blank" rel="noopener noreferrer">http://localhost:50000/hello?url=baidu<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_3ã€openfeign-è¿œç¨‹è°ƒç”¨æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_3ã€openfeign-è¿œç¨‹è°ƒç”¨æœåŠ¡" aria-hidden="true">#</a> 3ã€openfeign è¿œç¨‹è°ƒç”¨æœåŠ¡</h2><ul><li>1ã€æƒ³è¦è¿œç¨‹è°ƒç”¨åˆ«çš„æœåŠ¡ <ul><li>1ï¼‰ã€å¼•å…¥open-feign</li><li>2ï¼‰ã€ç¼–å†™ä¸€ä¸ªæ¥å£ï¼Œå‘Šè¯‰SpringCloudè¿™ä¸ªæ¥å£éœ€è¦è°ƒç”¨è¿œç¨‹æœåŠ¡ <ul><li>1ã€å£°æ˜æ¥å£çš„æ¯ä¸€ä¸ªæ–¹æ³•éƒ½æ˜¯è°ƒç”¨å“ªä¸ªè¿œç¨‹æœåŠ¡çš„é‚£ä¸ªè¯·æ±‚</li></ul></li><li>3ï¼‰ã€å¼€å¯è¿œç¨‹è°ƒç”¨åŠŸèƒ½</li></ul></li></ul><p>memberè°ƒç”¨coupon</p><p>å‡†å¤‡</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>å¼•å…¥open-feign
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>coupon<span class="token operator">:</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;coupon/coupon&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponService</span> couponService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/member/list&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">membercoupons</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CouponEntity</span> couponEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CouponEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        couponEntity<span class="token punctuation">.</span><span class="token function">setCouponName</span><span class="token punctuation">(</span><span class="token string">&quot;æ»¡100å‡10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;coupons&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>couponEntity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å†™ä¸€ä¸ªæ¥å£ï¼Œå‘Šè¯‰SpringCloudè¿™ä¸ªæ¥å£éœ€è¦è°ƒç”¨è¿œç¨‹æœåŠ¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>member<span class="token operator">-</span>feign<span class="token operator">-&gt;</span><span class="token class-name">CouponFeignService</span>
<span class="token doc-comment comment">/**
 * è¿™æ˜¯ä¸€ä¸ªå£°æ˜å¼çš„è¿œç¨‹è°ƒç”¨
 */</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span><span class="token string">&quot;yumall-coupon&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CouponFeignService</span> <span class="token punctuation">{</span>
	<span class="token comment">//å£°æ˜æ¥å£çš„æ¯ä¸€ä¸ªæ–¹æ³•éƒ½æ˜¯è°ƒç”¨å“ªä¸ªè¿œç¨‹æœåŠ¡çš„é‚£ä¸ªè¯·æ±‚</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/coupon/coupon/member/list&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">membercoupons</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¼€å¯è¿œç¨‹è°ƒç”¨åŠŸèƒ½</p><div class="language-Java line-numbers-mode" data-ext="Java"><pre class="language-Java"><code>//memberï¼šYumallMemberApplicationå¯åŠ¨ç±»
    @EnableFeignClients(basePackages = &quot;com.kong.yumall.member.feign&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•</p><div class="language-Java line-numbers-mode" data-ext="Java"><pre class="language-Java"><code>member-MemberController
    @Autowired
    CouponFeignService couponFeignService;

    /**
     * è·å–ä¼˜æƒ åˆ¸ä¿¡æ¯
     * @return
     */
    @RequestMapping(&quot;/coupons&quot;)
    public R test(){
        MemberEntity memberEntity = new MemberEntity();
        memberEntity.setNickname(&quot;å¼ ä¸‰&quot;);
        R membercoupons = couponFeignService.membercoupons();
        return R.ok().put(&quot;member&quot;,memberEntity).put(&quot;coupons&quot;,membercoupons.get(&quot;coupons&quot;));
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="http://localhost:8500/member/member/coupons" target="_blank" rel="noopener noreferrer">http://localhost:8500/member/member/coupons<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">&quot;coupons&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;couponType&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;couponImg&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;couponName&quot;</span><span class="token operator">:</span><span class="token string">&quot;æ»¡100å‡10&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;num&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;amount&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;perLimit&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;minPoint&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;startTime&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;endTime&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;useType&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;note&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;publishCount&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;useCount&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;receiveCount&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;enableStartTime&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;enableEndTime&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;memberLevel&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;publish&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;member&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;levelId&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;username&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;nickname&quot;</span><span class="token operator">:</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mobile&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;email&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;header&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;gender&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;birth&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;city&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;job&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;sign&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;sourceType&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;integration&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;growth&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">,</span><span class="token property">&quot;createTime&quot;</span><span class="token operator">:</span><span class="token null keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_4-sentinel" tabindex="-1"><a class="header-anchor" href="#_4-sentinel" aria-hidden="true">#</a> 4. Sentinel</h2><p><img src="/assets/true-image-20211118143201690-43636ee5.png" alt="image-20211118143201690"></p><p>å®˜ç½‘ï¼š<a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_1ã€å®‰è£…-é…ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€å®‰è£…-é…ç½®" aria-hidden="true">#</a> 1ã€å®‰è£…+é…ç½®</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--è‡ªå®šä¹‰ sentinel æµæ§--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sentinel-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sentinel-web-servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Sentinelç•Œé¢ä¸‹è½½ï¼š<a href="https://github.com/alibaba/Sentinel/releases/tag/v1.8.0" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/releases/tag/v1.8.0<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>è¿è¡Œï¼š java -jar .\sentinel-dashboard-1.8.0.jar --server.port=8999</p><p><a href="http://127.0.0.1:8999" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8999<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> sentinel</p><p>é…ç½®æ§åˆ¶å°ä¿¡æ¯ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">cloud</span><span class="token punctuation">:</span>
<span class="token key attr-name">  sentinel</span><span class="token punctuation">:</span>
<span class="token key attr-name">    transport</span><span class="token punctuation">:</span>
<span class="token comment">      #é…ç½®sentinel dashboardåœ°å€</span>
<span class="token key attr-name">      dashboard</span><span class="token punctuation">:</span> <span class="token value attr-value">localhost:8999</span>
<span class="token comment">      #é»˜è®¤8719ç«¯å£ï¼Œå‡å¦‚è¢«å ç”¨ä¼šè‡ªåŠ¨ä»8719å¼€å§‹ä¾æ¬¡+1æ‰«æï¼Œç›´è‡³æ‰¾åˆ°æœªè¢«å ç”¨çš„ç«¯å£</span>
<span class="token key attr-name">      port</span><span class="token punctuation">:</span> <span class="token value attr-value">8719</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯• <a href="http://localhost:8700/getCurrentSeckillSkus" target="_blank" rel="noopener noreferrer">http://localhost:8700/getCurrentSeckillSkus<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="http://seckill.yumall.com/getCurrentSeckillSkus" target="_blank" rel="noopener noreferrer">http://seckill.yumall.com/getCurrentSeckillSkus<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="/assets/true-image-20211118150210630-fc54973b.png" alt="image-20211118150210630"></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 1ã€æ•´åˆSentinel
 * 1ï¼‰ã€å¯¼å…¥ä¾èµ– spring-cloud-starter-alibaba-sentinel
 * 2ï¼‰ã€ä¸‹è½½sentinelæ§åˆ¶å°
 * 3ï¼‰ã€é…ç½® sentinel æ§åˆ¶å°åœ°å€ä¿¡æ¯
 * 4ï¼‰ã€åœ¨æ§åˆ¶å°è°ƒæ•´å‚æ•°ã€ã€é»˜è®¤æ‰€æœ‰çš„æµæ§è§„åˆ™ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œé‡å¯å¤±æ•ˆã€‘
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * 2ã€æ¯ä¸€ä¸ªå¾®æœåŠ¡éƒ½å¯¼å…¥ actuator ï¼šå¹¶é…åˆ management.endpoints.web.exposure.include=*
 * 3ã€è‡ªå®šä¹‰ sentinel æµæ§è¿”å›çš„æ•°æ®
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * 4ã€ä½¿ç”¨Sentinelæ¥ä¿æŠ¤feignè¿œç¨‹è°ƒç”¨ï¼Œç†”æ–­ï¼›
 * 1ï¼‰ã€è°ƒç”¨æ–¹çš„ç†”æ–­ä¿æŠ¤ï¼šfeign.sentinel.enable=true
 * 2ï¼‰ã€è°ƒç”¨æ–¹æ‰‹åŠ¨æŒ‡å®šè¿œç¨‹æœåŠ¡çš„é™çº§ç­–ç•¥ã€‚è¿œç¨‹æœåŠ¡è¢«é™çº§å¤„ç†ã€‚è§¦å‘æˆ‘ä»¬çš„ç†”æ–­å›è°ƒæ–¹æ³•
 * 3ï¼‰ã€è¶…å¤§æµè§ˆçš„æ—¶å€™ï¼Œå¿…é¡»ç‰ºç‰²ä¸€äº›è¿œç¨‹æœåŠ¡ã€‚åœ¨æœåŠ¡çš„æä¾›æ–¹ï¼ˆè¿œç¨‹æœåŠ¡ï¼‰æŒ‡å®šé™çº§ç­–ç•¥ï¼›
 * æä¾›æ–¹æ˜¯åœ¨è¿è¡Œï¼Œä½†æ˜¯ä¸å…è®¸è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿”å›çš„æ˜¯é»˜è®¤çš„é™çº§æ•°æ®ï¼ˆé™æµçš„æ•°æ®ï¼‰
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * 5ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº
 * 1ï¼‰ã€ä»£ç 
 * try (Entry entry = SphU.entry(&quot;seckillSkus&quot;)) <span class="token punctuation">{</span>
 * //ä¸šåŠ¡é€»è¾‘
 * <span class="token punctuation">}</span> catch(Exception e) <span class="token punctuation">{</span><span class="token punctuation">}</span>
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * 2ï¼‰ã€åŸºäºæ³¨è§£
 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2ã€è‡ªå®šä¹‰æµæ§" tabindex="-1"><a class="header-anchor" href="#_2ã€è‡ªå®šä¹‰æµæ§" aria-hidden="true">#</a> 2ã€è‡ªå®šä¹‰æµæ§</h3><p>å¯¼å…¥spring-boot-starter-actuator</p><p>é…ç½®ï¼Œæš´éœ²æ‰€æœ‰ç«¯ç‚¹ï¼šmanagement.endpoints.web.exposure.include=*</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySentinelConfig</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">MySentinelConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">WebCallbackManager</span><span class="token punctuation">.</span><span class="token function">setUrlBlockHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UrlBlockHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">blocked</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">R</span> error <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">BizCodeEnum</span><span class="token punctuation">.</span><span class="token constant">TO_MANY_REQUEST</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">BizCodeEnum</span><span class="token punctuation">.</span><span class="token constant">TO_MANY_REQUEST</span><span class="token punctuation">.</span><span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3ã€ç†”æ–­ã€é™çº§" tabindex="-1"><a class="header-anchor" href="#_3ã€ç†”æ–­ã€é™çº§" aria-hidden="true">#</a> 3ã€ç†”æ–­ã€é™çº§</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token operator">*</span> <span class="token number">4</span>ã€ä½¿ç”¨<span class="token class-name">Sentinel</span>æ¥ä¿æŠ¤feignè¿œç¨‹è°ƒç”¨ï¼Œç†”æ–­ï¼›
 <span class="token operator">*</span> <span class="token number">1</span>ï¼‰ã€è°ƒç”¨æ–¹çš„ç†”æ–­ä¿æŠ¤ï¼šfeign<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>enable<span class="token operator">=</span><span class="token boolean">true</span>
 <span class="token operator">*</span> <span class="token number">2</span>ï¼‰ã€è°ƒç”¨æ–¹æ‰‹åŠ¨æŒ‡å®šè¿œç¨‹æœåŠ¡çš„é™çº§ç­–ç•¥ã€‚è¿œç¨‹æœåŠ¡è¢«é™çº§å¤„ç†ã€‚è§¦å‘æˆ‘ä»¬çš„ç†”æ–­å›è°ƒæ–¹æ³•
 <span class="token operator">*</span> <span class="token number">3</span>ï¼‰ã€è¶…å¤§æµè§ˆçš„æ—¶å€™ï¼Œå¿…é¡»ç‰ºç‰²ä¸€äº›è¿œç¨‹æœåŠ¡ã€‚åœ¨æœåŠ¡çš„æä¾›æ–¹ï¼ˆè¿œç¨‹æœåŠ¡ï¼‰æŒ‡å®šé™çº§ç­–ç•¥ï¼›
 <span class="token operator">*</span> æä¾›æ–¹æ˜¯åœ¨è¿è¡Œï¼Œä½†æ˜¯ä¸å…è®¸è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿”å›çš„æ˜¯é»˜è®¤çš„é™çº§æ•°æ®ï¼ˆé™æµçš„æ•°æ®ï¼‰
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SeckillFeignService</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;yumall-seckill&quot;</span><span class="token punctuation">,</span>fallback <span class="token operator">=</span> <span class="token class-name">SeckillFeignServiceFallBack</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SeckillFeignService</span> <span class="token punctuation">{</span>

   <span class="token doc-comment comment">/**
    * æ ¹æ®skuIdæŸ¥è¯¢å•†å“æ˜¯å¦å‚åŠ ç§’æ€æ´»åŠ¨
    * <span class="token keyword">@param</span> <span class="token parameter">skuId</span>
    * <span class="token keyword">@return</span>
    */</span>
   <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/sku/seckill/{skuId}&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">R</span> <span class="token function">getSkuSeckilInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;skuId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> skuId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeckillFeignServiceFallBack</span> <span class="token keyword">implements</span> <span class="token class-name">SeckillFeignService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span> <span class="token function">getSkuSeckilInfo</span><span class="token punctuation">(</span><span class="token class-name">Long</span> skuId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">BizCodeEnum</span><span class="token punctuation">.</span><span class="token constant">TO_MANY_REQUEST</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">BizCodeEnum</span><span class="token punctuation">.</span><span class="token constant">TO_MANY_REQUEST</span><span class="token punctuation">.</span><span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº" tabindex="-1"><a class="header-anchor" href="#_4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº" aria-hidden="true">#</a> 4ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> * 5ã€è‡ªå®šä¹‰å—ä¿æŠ¤çš„èµ„æº
 * 1ï¼‰ã€ä»£ç 
 * try (Entry entry = SphU.entry(&quot;seckillSkus&quot;)) {
 * //ä¸šåŠ¡é€»è¾‘
 * } catch(Exception e) {}
 * &lt;p&gt;
 * 2ï¼‰ã€åŸºäºæ³¨è§£
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;getCurrentSeckillSkusResource&quot;</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">&quot;blockHandler&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SeckillSkuRedisTo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getCurrentSeckillSkus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
    
    
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SeckillSkuRedisTo</span><span class="token punctuation">&gt;</span></span> <span class="token function">blockHandler</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;getCurrentSeckillSkusResourceè¢«é™æµäº†,{}&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-1-sentinel-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_4-1-sentinel-æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 4.1. Sentinel æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Sentinel ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚</p><p>Sentinel åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†:</p><ul><li>æ ¸å¿ƒåº“ï¼ˆJava å®¢æˆ·ç«¯ï¼‰ä¸ä¾èµ–ä»»ä½•æ¡†æ¶/åº“ï¼Œèƒ½å¤Ÿè¿è¡Œäºæ‰€æœ‰ Java è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŒæ—¶å¯¹ Dubbo / Spring Cloud ç­‰æ¡†æ¶ä¹Ÿæœ‰è¾ƒå¥½çš„æ”¯æŒã€‚</li><li>æ§åˆ¶å°ï¼ˆDashboardï¼‰åŸºäº Spring Boot å¼€å‘ï¼Œæ‰“åŒ…åå¯ä»¥ç›´æ¥è¿è¡Œï¼Œä¸éœ€è¦é¢å¤–çš„ Tomcat ç­‰åº”ç”¨å®¹å™¨ã€‚</li></ul><p>Sentinel å¯ä»¥ç®€å•çš„åˆ†ä¸º Sentinel æ ¸å¿ƒåº“å’Œ Dashboardã€‚æ ¸å¿ƒåº“ä¸ä¾èµ– Dashboardï¼Œä½†æ˜¯ç»“åˆ Dashboard å¯ä»¥å–å¾—æœ€å¥½çš„æ•ˆæœã€‚</p><h3 id="_4-2-åŸºæœ¬æ¦‚å¿µåŠä½œç”¨" tabindex="-1"><a class="header-anchor" href="#_4-2-åŸºæœ¬æ¦‚å¿µåŠä½œç”¨" aria-hidden="true">#</a> 4.2. åŸºæœ¬æ¦‚å¿µåŠä½œç”¨</h3><p>åŸºæœ¬æ¦‚å¿µï¼š</p><p><strong>èµ„æº</strong>ï¼šæ˜¯ Sentinel çš„å…³é”®æ¦‚å¿µã€‚å®ƒå¯ä»¥æ˜¯ Java åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•å†…å®¹ï¼Œä¾‹å¦‚ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›çš„æœåŠ¡ï¼Œæˆ–ç”±åº”ç”¨ç¨‹åºè°ƒç”¨çš„å…¶å®ƒåº”ç”¨æä¾›çš„æœåŠ¡ï¼Œç”šè‡³å¯ä»¥æ˜¯ä¸€æ®µä»£ç ã€‚åœ¨æ¥ä¸‹æ¥çš„æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šç”¨èµ„æºæ¥æè¿°ä»£ç å—ã€‚</p><p>åªè¦é€šè¿‡ Sentinel API å®šä¹‰çš„ä»£ç ï¼Œå°±æ˜¯èµ„æºï¼Œèƒ½å¤Ÿè¢« Sentinel ä¿æŠ¤èµ·æ¥ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•ç­¾åï¼ŒURLï¼Œç”šè‡³æœåŠ¡åç§°ä½œä¸ºèµ„æºåæ¥æ ‡ç¤ºèµ„æºã€‚</p><p><strong>è§„åˆ™</strong>ï¼šå›´ç»•èµ„æºçš„å®æ—¶çŠ¶æ€è®¾å®šçš„è§„åˆ™ï¼Œå¯ä»¥åŒ…æ‹¬æµé‡æ§åˆ¶è§„åˆ™ã€ç†”æ–­é™çº§è§„åˆ™ä»¥åŠç³»ç»Ÿä¿æŠ¤è§„åˆ™ã€‚æ‰€æœ‰è§„åˆ™å¯ä»¥åŠ¨æ€å®æ—¶è°ƒæ•´ã€‚</p><p>ä¸»è¦ä½œç”¨ï¼š</p><ol><li>æµé‡æ§åˆ¶</li><li>ç†”æ–­é™çº§</li><li>ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤</li></ol><p>æˆ‘ä»¬è¯´çš„èµ„æºï¼Œå¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼ŒæœåŠ¡ï¼ŒæœåŠ¡é‡Œçš„æ–¹æ³•ï¼Œç”šè‡³æ˜¯ä¸€æ®µä»£ç ã€‚ä½¿ç”¨ Sentinel æ¥è¿›è¡Œèµ„æºä¿æŠ¤ï¼Œä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤:</p><ol><li>å®šä¹‰èµ„æº</li><li>å®šä¹‰è§„åˆ™</li><li>æ£€éªŒè§„åˆ™æ˜¯å¦ç”Ÿæ•ˆ</li></ol><p>å…ˆæŠŠå¯èƒ½éœ€è¦ä¿æŠ¤çš„èµ„æºå®šä¹‰å¥½ï¼Œä¹‹åå†é…ç½®è§„åˆ™ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºï¼Œåªè¦æœ‰äº†èµ„æºï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»ä½•æ—¶å€™çµæ´»åœ°å®šä¹‰å„ç§æµé‡æ§åˆ¶è§„åˆ™ã€‚åœ¨ç¼–ç çš„æ—¶å€™ï¼Œåªéœ€è¦è€ƒè™‘è¿™ä¸ªä»£ç æ˜¯å¦éœ€è¦ä¿æŠ¤ï¼Œå¦‚æœéœ€è¦ä¿æŠ¤ï¼Œå°±å°†ä¹‹å®šä¹‰ä¸ºä¸€ä¸ªèµ„æºã€‚</p><h3 id="_4-3-å¿«é€Ÿå¼€å§‹" tabindex="-1"><a class="header-anchor" href="#_4-3-å¿«é€Ÿå¼€å§‹" aria-hidden="true">#</a> 4.3. å¿«é€Ÿå¼€å§‹</h3><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/spring-cloud-alibaba/wiki/Sentinel<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="_4-3-1-æ­å»ºdashboardæ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_4-3-1-æ­å»ºdashboardæ§åˆ¶å°" aria-hidden="true">#</a> 4.3.1. æ­å»ºDashboardæ§åˆ¶å°</h4><p>æ‚¨å¯ä»¥ä» release é¡µé¢ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„æ§åˆ¶å° jar åŒ…ã€‚</p><p><a href="https://github.com/alibaba/Sentinel/releases" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/releases<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ä¸‹è½½çš„jaråŒ…ï¼ˆè¯¾å‰èµ„æ–™å·²ä¸‹å‘ï¼‰ï¼Œcopyåˆ°ä¸€ä¸ªæ²¡æœ‰ç©ºæ ¼æˆ–è€…ä¸­æ–‡çš„è·¯å¾„ä¸‹ï¼Œæ‰“å¼€dosçª—å£åˆ‡æ¢åˆ°jaråŒ…æ‰€åœ¨ç›®å½•ã€‚</p><p>æ‰§è¡Œï¼šjava -jar sentinel-dashboard-xxx.jar</p><p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®sentinelæ§åˆ¶å°ï¼Œé»˜è®¤ç«¯å£å·æ˜¯8080ã€‚è¿›å…¥ç™»å½•é¡µé¢ï¼Œç®¡ç†é¡µé¢ç”¨æˆ·åå’Œå¯†ç ï¼šsentinel/sentinel</p><p>æ­¤æ—¶é¡µé¢ä¸ºç©ºï¼Œè¿™æ˜¯å› ä¸ºè¿˜æ²¡æœ‰ç›‘æ§ä»»ä½•æœåŠ¡ã€‚å¦å¤–ï¼Œsentinelæ˜¯æ‡’åŠ è½½çš„ï¼Œå¦‚æœæœåŠ¡æ²¡æœ‰è¢«è®¿é—®ï¼Œä¹Ÿçœ‹ä¸åˆ°è¯¥æœåŠ¡ä¿¡æ¯ã€‚</p><h4 id="_4-3-2-æ”¹é€ nacos-consumer" tabindex="-1"><a class="header-anchor" href="#_4-3-2-æ”¹é€ nacos-consumer" aria-hidden="true">#</a> 4.3.2. æ”¹é€ nacos-consumer</h4><ol><li>å¼•å…¥ sentinel ä¾èµ–</li></ol><p>ä½¿ç”¨ group ID ä¸º <code>com.alibaba.cloud</code> å’Œ artifact ID ä¸º <code>spring-cloud-starter-alibaba-sentinel</code> çš„ starterã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>åœ¨application.propertiesä¸­æ·»åŠ é…ç½®</li></ol><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">## æŒ‡å®šdashboardåœ°å€</span>
<span class="token key attr-name">spring.cloud.sentinel.transport.dashboard</span><span class="token punctuation">=</span><span class="token value attr-value">localhost:8080</span>
<span class="token comment">## å¯åŠ¨è¯¥æœåŠ¡ï¼Œä¼šåœ¨åº”ç”¨ç¨‹åºçš„ç›¸åº”æœåŠ¡å™¨ä¸Šå¯åŠ¨HTTP Serverï¼Œå¹¶ä¸”è¯¥æœåŠ¡å™¨å°†ä¸Sentinel dashboardè¿›è¡Œäº¤äº’</span>
<span class="token key attr-name">spring.cloud.sentinel.transport.port</span><span class="token punctuation">=</span><span class="token value attr-value">8719</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‡å¯nacos-consumerå·¥ç¨‹ï¼Œåœ¨æµè§ˆå™¨ä¸­åå¤è®¿é—®ï¼š<a href="http://localhost:18080/hi" target="_blank" rel="noopener noreferrer">http://localhost:18080/hi<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å†æ¬¡æŸ¥çœ‹sentinelæ§åˆ¶å°é¡µé¢ï¼š</p><h3 id="_4-4-æ•´åˆfeignç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_4-4-æ•´åˆfeignç»„ä»¶" aria-hidden="true">#</a> 4.4. æ•´åˆFeignç»„ä»¶</h3><p>Sentinel é€‚é…äº† Feign ç»„ä»¶ã€‚ä½¿ç”¨åˆ†ä¸‰æ­¥ï¼š</p><ol><li>å¼•å…¥ä¾èµ–ï¼š</li></ol><p>å¼•å…¥feignåŠsentinelçš„ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>å¼€å¯sentinelç›‘æ§åŠŸèƒ½</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>feign.sentinel.enabled=true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>ä»£ç å®ç°</li></ol><p>æ·»åŠ feignæ¥å£çš„ç†”æ–­ç±»ProviderFallbackï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProviderFallback</span> <span class="token keyword">implements</span> <span class="token class-name">ProviderClient</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ç°åœ¨æœåŠ¡å™¨å¿™ï¼Œè¯·ç¨åå†è¯•ï¼&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨feignæ¥å£ProviderClientä¸­æŒ‡å®šç†”æ–­ç±»ï¼š</p><p>æµ‹è¯•ä¹‹å‰ï¼Œå…ˆåœ¨æœåŠ¡æä¾›æ–¹çš„controlleræ–¹æ³•ä¸­æ·»åŠ å¼‚å¸¸ï¼š</p><p>å†é‡å¯nacos-providerå’Œnacos-consumeræœåŠ¡ã€‚åœ¨æµè§ˆå™¨ä¸­åœ°å€æ è®¿é—®æ¶ˆè´¹æ–¹æµ‹è¯•ï¼š</p><h3 id="_4-5-æµé‡æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#_4-5-æµé‡æ§åˆ¶" aria-hidden="true">#</a> 4.5. æµé‡æ§åˆ¶</h3><h4 id="_4-5-1-ä»€ä¹ˆæ˜¯æµé‡æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#_4-5-1-ä»€ä¹ˆæ˜¯æµé‡æ§åˆ¶" aria-hidden="true">#</a> 4.5.1. ä»€ä¹ˆæ˜¯æµé‡æ§åˆ¶</h4><p>æµé‡æ§åˆ¶åœ¨ç½‘ç»œä¼ è¾“ä¸­æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ¦‚å¿µï¼Œå®ƒç”¨äºè°ƒæ•´ç½‘ç»œåŒ…çš„å‘é€æ•°æ®ã€‚ç„¶è€Œï¼Œä»ç³»ç»Ÿç¨³å®šæ€§è§’åº¦è€ƒè™‘ï¼Œåœ¨å¤„ç†è¯·æ±‚çš„é€Ÿåº¦ä¸Šï¼Œä¹Ÿæœ‰éå¸¸å¤šçš„è®²ç©¶ã€‚ä»»æ„æ—¶é—´åˆ°æ¥çš„è¯·æ±‚å¾€å¾€æ˜¯éšæœºä¸å¯æ§çš„ï¼Œè€Œç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›æ˜¯æœ‰é™çš„ã€‚æˆ‘ä»¬éœ€è¦æ ¹æ®ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›å¯¹æµé‡è¿›è¡Œæ§åˆ¶ã€‚Sentinel ä½œä¸ºä¸€ä¸ªè°ƒé…å™¨ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æŠŠéšæœºçš„è¯·æ±‚è°ƒæ•´æˆåˆé€‚çš„å½¢çŠ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>æµé‡æ§åˆ¶æœ‰ä»¥ä¸‹å‡ ä¸ªè§’åº¦:</p><ul><li>èµ„æºçš„è°ƒç”¨å…³ç³»ï¼Œä¾‹å¦‚èµ„æºçš„è°ƒç”¨é“¾è·¯ï¼Œèµ„æºå’Œèµ„æºä¹‹é—´çš„å…³ç³»ï¼›</li><li>è¿è¡ŒæŒ‡æ ‡ï¼Œä¾‹å¦‚ QPSã€çº¿ç¨‹æ•°ç­‰ï¼›</li><li>æ§åˆ¶çš„æ•ˆæœï¼Œä¾‹å¦‚ç›´æ¥é™æµï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰ã€å†·å¯åŠ¨ï¼ˆWarm Upï¼‰ã€åŒ€é€Ÿæ’é˜Ÿï¼ˆæ’é˜Ÿç­‰å¾…ï¼‰ç­‰ã€‚</li></ul><p>Sentinel çš„è®¾è®¡ç†å¿µæ˜¯è®©æ‚¨è‡ªç”±é€‰æ‹©æ§åˆ¶çš„è§’åº¦ï¼Œå¹¶è¿›è¡Œçµæ´»ç»„åˆï¼Œä»è€Œè¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚</p><p>é…ç½®å¦‚ä¸‹ï¼š</p><h4 id="_4-5-2-qpsæµé‡æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#_4-5-2-qpsæµé‡æ§åˆ¶" aria-hidden="true">#</a> 4.5.2. QPSæµé‡æ§åˆ¶</h4><p>å½“ QPS è¶…è¿‡æŸä¸ªé˜ˆå€¼çš„æ—¶å€™ï¼Œåˆ™é‡‡å–æªæ–½è¿›è¡Œæµé‡æ§åˆ¶ã€‚æµé‡æ§åˆ¶çš„æ•ˆæœåŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š<strong>ç›´æ¥æ‹’ç»</strong>ã€<strong>Warm Up</strong>ã€<strong>åŒ€é€Ÿæ’é˜Ÿ</strong>ã€‚</p><h5>4.5.2.1. ç›´æ¥æ‹’ç»</h5><p><strong>ç›´æ¥æ‹’ç»</strong>ï¼ˆ<code>RuleConstant.CONTROL_BEHAVIOR_DEFAULT</code>ï¼‰æ–¹å¼æ˜¯é»˜è®¤çš„æµé‡æ§åˆ¶æ–¹å¼ï¼Œå½“QPSè¶…è¿‡ä»»æ„è§„åˆ™çš„é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚å°±ä¼šè¢«ç«‹å³æ‹’ç»ï¼Œæ‹’ç»æ–¹å¼ä¸ºæŠ›å‡º<code>FlowException</code>ã€‚è¿™ç§æ–¹å¼é€‚ç”¨äºå¯¹ç³»ç»Ÿå¤„ç†èƒ½åŠ›ç¡®åˆ‡å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚é€šè¿‡å‹æµ‹ç¡®å®šäº†ç³»ç»Ÿçš„å‡†ç¡®æ°´ä½æ—¶ã€‚</p><p>è¿™é‡Œåšä¸€ä¸ªæœ€ç®€å•çš„é…ç½®ï¼š</p><p>â€‹ é˜ˆå€¼ç±»å‹é€‰æ‹©ï¼šQPS</p><p>â€‹ å•æœºé˜ˆå€¼ï¼š2</p><p>ç»¼åˆèµ·æ¥çš„é…ç½®æ•ˆæœå°±æ˜¯ï¼Œè¯¥æ¥å£çš„é™æµç­–ç•¥æ˜¯æ¯ç§’æœ€å¤šå…è®¸2ä¸ªè¯·æ±‚è¿›å…¥ã€‚</p><p>ç‚¹å‡»æ–°å¢æŒ‰é’®ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š</p><p>åœ¨æµè§ˆå™¨è®¿é—®ï¼š<a href="http://localhost:18080/hi%EF%BC%8C%E5%B9%B6%E7%96%AF%E7%8B%82%E5%88%B7%E6%96%B0%EF%BC%8C%E5%87%BA%E7%8E%B0%E5%A6%82%E4%B8%8B%E4%BF%A1%E6%81%AF%EF%BC%9A" target="_blank" rel="noopener noreferrer">http://localhost:18080/hiï¼Œå¹¶ç–¯ç‹‚åˆ·æ–°ï¼Œå‡ºç°å¦‚ä¸‹ä¿¡æ¯ï¼š<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h5>4.5.2.2. Warm Upï¼ˆé¢„çƒ­ï¼‰</h5><p>Warm Upï¼ˆ<code>RuleConstant.CONTROL_BEHAVIOR_WARM_UP</code>ï¼‰æ–¹å¼ï¼Œå³é¢„çƒ­/å†·å¯åŠ¨æ–¹å¼ã€‚å½“ç³»ç»Ÿé•¿æœŸå¤„äºä½æ°´ä½çš„æƒ…å†µä¸‹ï¼Œå½“æµé‡çªç„¶å¢åŠ æ—¶ï¼Œç›´æ¥æŠŠç³»ç»Ÿæ‹‰å‡åˆ°é«˜æ°´ä½å¯èƒ½ç¬é—´æŠŠç³»ç»Ÿå‹å®ã€‚é€šè¿‡&quot;å†·å¯åŠ¨&quot;ï¼Œè®©é€šè¿‡çš„æµé‡ç¼“æ…¢å¢åŠ ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…é€æ¸å¢åŠ åˆ°é˜ˆå€¼ä¸Šé™ï¼Œç»™å†·ç³»ç»Ÿä¸€ä¸ªé¢„çƒ­çš„æ—¶é—´ï¼Œé¿å…å†·ç³»ç»Ÿè¢«å‹å®ã€‚</p><p>ç–¯ç‹‚è®¿é—®ï¼š<a href="http://localhost:18080/hi" target="_blank" rel="noopener noreferrer">http://localhost:18080/hi<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å¯ä»¥å‘ç°å‰å‡ ç§’ä¼šå‘ç”Ÿç†”æ–­ï¼Œå‡ ç§’é’Ÿä¹‹åå°±å®Œå…¨æ²¡æœ‰é—®é¢˜äº†</p><h5>4.5.2.3. åŒ€é€Ÿæ’é˜Ÿ</h5><p>åŒ€é€Ÿæ’é˜Ÿï¼ˆ<code>RuleConstant.CONTROL_BEHAVIOR_RATE_LIMITER</code>ï¼‰æ–¹å¼ä¼šä¸¥æ ¼æ§åˆ¶è¯·æ±‚é€šè¿‡çš„é—´éš”æ—¶é—´ï¼Œä¹Ÿå³æ˜¯è®©è¯·æ±‚ä»¥å‡åŒ€çš„é€Ÿåº¦é€šè¿‡ï¼Œå¯¹åº”çš„æ˜¯æ¼æ¡¶ç®—æ³•ã€‚</p><p>æµ‹è¯•é…ç½®å¦‚ä¸‹ï¼š1så¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œæ’é˜Ÿç­‰å¾…ï¼Œç­‰å¾…æ—¶é—´20sã€‚</p><p>åœ¨postmanä¸­ï¼Œæ–°å»ºä¸€ä¸ªcollectionï¼ˆè¿™é‡Œcollectionåç§°æ˜¯sentinelï¼‰ï¼Œå¹¶æŠŠä¸€ä¸ªè¯·æ±‚æ·»åŠ åˆ°è¯¥collection</p><p>è¯·æ±‚æ·»åŠ æˆåŠŸåï¼Œç‚¹å‡»runæŒ‰é’®ï¼š</p><p>é…ç½®æ¯éš”100mså‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œä¸€å…±å‘é€20ä¸ªè¯·æ±‚ï¼š</p><p>ç‚¹å‡»â€œrun sentinelâ€æŒ‰é’®</p><p>æŸ¥çœ‹æ§åˆ¶å°ï¼Œæ•ˆæœå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°åŸºæœ¬æ¯éš”1sæ‰“å°ä¸€æ¬¡</p><h4 id="_4-5-3-å…³è”é™æµ" tabindex="-1"><a class="header-anchor" href="#_4-5-3-å…³è”é™æµ" aria-hidden="true">#</a> 4.5.3. å…³è”é™æµ</h4><p>å…³è”é™æµï¼šå½“å…³è”çš„èµ„æºè¯·æ±‚è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œå°±é™æµè‡ªå·±ã€‚</p><p>é…ç½®å¦‚ä¸‹ï¼š/hi2çš„å…³è”èµ„æº/hiï¼Œå¹¶å‘æ•°è¶…è¿‡2æ—¶ï¼Œ/hi2å°±é™æµè‡ªå·±</p><p>ç»™æ¶ˆè´¹è€…æ·»åŠ ä¸€ä¸ªcontrolleræ–¹æ³•</p><p>æµ‹è¯•ï¼š</p><p>postmané…ç½®å¦‚ä¸‹ï¼šæ¯ä¸ª400mså‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œä¸€å…±å‘é€50ä¸ªã€‚æ¯ç§’é’Ÿè¶…è¿‡äº†2æ¬¡</p><p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®/hi2 å·²ç»è¢«é™æµã€‚</p><h4 id="_4-5-4-é“¾è·¯é™æµ" tabindex="-1"><a class="header-anchor" href="#_4-5-4-é“¾è·¯é™æµ" aria-hidden="true">#</a> 4.5.4. é“¾è·¯é™æµ</h4><p>ä¸€æ£µå…¸å‹çš„è°ƒç”¨æ ‘å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>     	          machine-root
                    /       \
                   /         \
             Entrance1     Entrance2
                /             \
               /               \
      DefaultNode(nodeA)   DefaultNode(nodeA)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šå›¾ä¸­æ¥è‡ªå…¥å£ <code>Entrance1</code> å’Œ <code>Entrance2</code> çš„è¯·æ±‚éƒ½è°ƒç”¨åˆ°äº†èµ„æº <code>NodeA</code>ï¼ŒSentinel å…è®¸åªæ ¹æ®æŸä¸ªå…¥å£çš„ç»Ÿè®¡ä¿¡æ¯å¯¹èµ„æºé™æµã€‚</p><p>é…ç½®å¦‚ä¸‹ï¼šè¡¨ç¤ºåªé’ˆå¯¹Entrance1è¿›æ¥çš„è¯·æ±‚åšé™æµé™åˆ¶</p><h4 id="_4-5-5-çº¿ç¨‹æ•°é™æµ" tabindex="-1"><a class="header-anchor" href="#_4-5-5-çº¿ç¨‹æ•°é™æµ" aria-hidden="true">#</a> 4.5.5. çº¿ç¨‹æ•°é™æµ</h4><p>**å¹¶å‘çº¿ç¨‹æ•°é™æµç”¨äºä¿æŠ¤ä¸šåŠ¡çº¿ç¨‹æ•°ä¸è¢«è€—å°½ã€‚**ä¾‹å¦‚ï¼Œå½“åº”ç”¨æ‰€ä¾èµ–çš„ä¸‹æ¸¸åº”ç”¨ç”±äºæŸç§åŸå› å¯¼è‡´æœåŠ¡ä¸ç¨³å®šã€å“åº”å»¶è¿Ÿå¢åŠ ï¼Œå¯¹äºè°ƒç”¨è€…æ¥è¯´ï¼Œæ„å‘³ç€ååé‡ä¸‹é™å’Œæ›´å¤šçš„çº¿ç¨‹æ•°å ç”¨ï¼Œæç«¯æƒ…å†µä¸‹ç”šè‡³å¯¼è‡´çº¿ç¨‹æ± è€—å°½ã€‚ä¸ºåº”å¯¹å¤ªå¤šçº¿ç¨‹å ç”¨çš„æƒ…å†µï¼Œä¸šå†…æœ‰ä½¿ç”¨éš”ç¦»çš„æ–¹æ¡ˆï¼Œæ¯”å¦‚é€šè¿‡ä¸åŒä¸šåŠ¡é€»è¾‘ä½¿ç”¨ä¸åŒçº¿ç¨‹æ± æ¥éš”ç¦»ä¸šåŠ¡è‡ªèº«ä¹‹é—´çš„èµ„æºäº‰æŠ¢ï¼ˆçº¿ç¨‹æ± éš”ç¦»ï¼‰ã€‚è¿™ç§éš”ç¦»æ–¹æ¡ˆè™½ç„¶éš”ç¦»æ€§æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯ä»£ä»·å°±æ˜¯çº¿ç¨‹æ•°ç›®å¤ªå¤šï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ overhead æ¯”è¾ƒå¤§ï¼Œç‰¹åˆ«æ˜¯å¯¹ä½å»¶æ—¶çš„è°ƒç”¨æœ‰æ¯”è¾ƒå¤§çš„å½±å“ã€‚Sentinel å¹¶å‘çº¿ç¨‹æ•°é™æµä¸è´Ÿè´£åˆ›å»ºå’Œç®¡ç†çº¿ç¨‹æ± ï¼Œè€Œæ˜¯ç®€å•ç»Ÿè®¡å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡çš„çº¿ç¨‹æ•°ç›®ï¼Œå¦‚æœè¶…å‡ºé˜ˆå€¼ï¼Œæ–°çš„è¯·æ±‚ä¼šè¢«ç«‹å³æ‹’ç»ï¼Œæ•ˆæœç±»ä¼¼äºä¿¡å·é‡éš”ç¦»ã€‚</p><p>é…ç½®å¦‚ä¸‹ï¼šå¦‚æœè¯·æ±‚çš„å¹¶å‘æ•°è¶…è¿‡ä¸€ä¸ªå°±é™æµ</p><p>æ”¹é€ controllerä¸­çš„hiæ–¹æ³•ï¼š</p><p><strong>æµ‹è¯•</strong></p><p>postmainé…ç½®å¦‚ä¸‹ï¼š</p><p>åŒæ—¶åœ¨æµè§ˆå™¨è®¿é—®ï¼š</p><h3 id="_4-6-ç†”æ–­é™çº§" tabindex="-1"><a class="header-anchor" href="#_4-6-ç†”æ–­é™çº§" aria-hidden="true">#</a> 4.6. ç†”æ–­é™çº§</h3><p>Sentinelé™¤äº†æµé‡æ§åˆ¶ä»¥å¤–ï¼Œå¯¹è°ƒç”¨é“¾è·¯ä¸­ä¸ç¨³å®šçš„èµ„æºè¿›è¡Œç†”æ–­é™çº§ä¹Ÿæ˜¯ä¿éšœé«˜å¯ç”¨çš„é‡è¦æªæ–½ä¹‹ä¸€ã€‚</p><p>Sentinel <strong>ç†”æ–­é™çº§</strong>ä¼šåœ¨è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçŠ¶æ€æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨è¶…æ—¶æˆ–å¼‚å¸¸æ¯”ä¾‹å‡é«˜ï¼‰ï¼Œå¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œè®©è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶å®ƒçš„èµ„æºè€Œå¯¼è‡´çº§è”é”™è¯¯ã€‚å½“èµ„æºè¢«é™çº§åï¼Œåœ¨æ¥ä¸‹æ¥çš„é™çº§æ—¶é—´çª—å£ä¹‹å†…ï¼Œå¯¹è¯¥èµ„æºçš„è°ƒç”¨éƒ½è‡ªåŠ¨ç†”æ–­ï¼ˆé»˜è®¤è¡Œä¸ºæ˜¯æŠ›å‡º <code>DegradeException</code>ï¼‰ã€‚</p><p>Sentinel å’Œ Hystrix çš„åŸåˆ™æ˜¯ä¸€è‡´çš„: å½“è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šï¼Œä¾‹å¦‚ï¼Œè¡¨ç°ä¸º timeoutï¼Œå¼‚å¸¸æ¯”ä¾‹å‡é«˜çš„æ—¶å€™ï¼Œåˆ™å¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œå¹¶è®©è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶å®ƒçš„èµ„æºï¼Œæœ€ç»ˆäº§ç”Ÿé›ªå´©çš„æ•ˆæœã€‚</p><p>é™æµé™çº§æŒ‡æ ‡æœ‰ä¸‰ä¸ªï¼Œå¦‚ä¸‹å›¾ï¼š</p><ol><li><p>å¹³å‡å“åº”æ—¶é—´ï¼ˆRTï¼‰</p></li><li><p>å¼‚å¸¸æ¯”ä¾‹</p></li><li><p>å¼‚å¸¸æ•°</p></li></ol><h4 id="_4-6-1-å¹³å‡å“åº”æ—¶é—´-rt" tabindex="-1"><a class="header-anchor" href="#_4-6-1-å¹³å‡å“åº”æ—¶é—´-rt" aria-hidden="true">#</a> 4.6.1. å¹³å‡å“åº”æ—¶é—´ï¼ˆRTï¼‰</h4><p><strong>å¹³å‡å“åº”æ—¶é—´</strong> (<code>DEGRADE_GRADE_RT</code>)ï¼š<strong>å½“èµ„æºçš„å¹³å‡å“åº”æ—¶é—´è¶…è¿‡é˜ˆå€¼</strong>ï¼ˆ<code>DegradeRule</code> ä¸­çš„ <code>count</code>ï¼Œä»¥ <strong>ms</strong> ä¸ºå•ä½ï¼Œé»˜è®¤ä¸Šé™æ˜¯4900msï¼‰ä¹‹åï¼Œèµ„æºè¿›å…¥å‡†é™çº§çŠ¶æ€ã€‚å¦‚æœ<strong>1sä¹‹å†…æŒç»­è¿›å…¥ 5 ä¸ªè¯·æ±‚</strong>ï¼Œå®ƒä»¬çš„ RT éƒ½æŒç»­è¶…è¿‡è¿™ä¸ªé˜ˆå€¼ï¼Œé‚£ä¹ˆåœ¨<strong>æ¥ä¸‹æ¥çš„æ—¶é—´çª—å£</strong>ï¼ˆ<code>DegradeRule</code> ä¸­çš„ <code>timeWindow</code>ï¼Œä»¥ s ä¸ºå•ä½ï¼‰ä¹‹å†…ï¼Œå¯¹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè‡ªåŠ¨åœ°è¿”å›ï¼ˆæŠ›å‡º <code>DegradeException</code>ï¼‰ã€‚åœ¨ä¸‹ä¸€ä¸ªæ—¶é—´çª—å£åˆ°æ¥æ—¶, ä¼šæ¥ç€å†æ”¾å…¥5ä¸ªè¯·æ±‚, å†é‡å¤ä¸Šé¢çš„åˆ¤æ–­ã€‚</p><p>é…ç½®å¦‚ä¸‹ï¼šè¶…æ—¶æ—¶é—´100msï¼Œç†”æ–­æ—¶é—´10s</p><p>ä»£ç ä¸­ä¾ç„¶ç¡äº†1s</p><p>ä¹Ÿå°±æ˜¯è¯´è¯·æ±‚è‚¯å®šéƒ½ä¼šè¶…æ—¶ã€‚</p><p>å…ˆæ‰§è¡Œpostmainï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><p>å†æ¬¡è§åˆ°äº†ç†Ÿæ‚‰çš„ç•Œé¢ï¼š</p><p>10sä¹‹å†…ï¼Œéƒ½æ˜¯ç†”æ–­ç•Œé¢</p><h4 id="_4-6-2-å¼‚å¸¸æ¯”ä¾‹" tabindex="-1"><a class="header-anchor" href="#_4-6-2-å¼‚å¸¸æ¯”ä¾‹" aria-hidden="true">#</a> 4.6.2. å¼‚å¸¸æ¯”ä¾‹</h4><p><strong>å¼‚å¸¸æ¯”ä¾‹</strong> (<code>DEGRADE_GRADE_EXCEPTION_RATIO</code>)ï¼š<strong>å½“èµ„æºçš„æ¯ç§’è¯·æ±‚é‡ &gt;= 5ï¼Œä¸”æ¯ç§’å¼‚å¸¸æ€»æ•°å é€šè¿‡é‡çš„æ¯”å€¼è¶…è¿‡é˜ˆå€¼</strong>ï¼ˆ<code>DegradeRule</code> ä¸­çš„ <code>count</code>ï¼‰ä¹‹åï¼Œèµ„æºè¿›å…¥é™çº§çŠ¶æ€ï¼Œå³åœ¨æ¥ä¸‹çš„æ—¶é—´çª—å£ï¼ˆ<code>DegradeRule</code>ä¸­çš„ <code>timeWindow</code>ï¼Œä»¥ s ä¸ºå•ä½ï¼‰ä¹‹å†…ï¼Œå¯¹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè‡ªåŠ¨åœ°è¿”å›ã€‚å¼‚å¸¸æ¯”ç‡çš„é˜ˆå€¼èŒƒå›´æ˜¯ <code>[0.0, 1.0]</code>ï¼Œä»£è¡¨ 0% - 100%ã€‚</p><h4 id="_4-6-3-å¼‚å¸¸æ•°" tabindex="-1"><a class="header-anchor" href="#_4-6-3-å¼‚å¸¸æ•°" aria-hidden="true">#</a> 4.6.3. å¼‚å¸¸æ•°</h4><p><strong>å¼‚å¸¸æ•°</strong> (<code>DEGRADE_GRADE_EXCEPTION_COUNT</code>)ï¼šå½“èµ„æºè¿‘ 1 åˆ†é’Ÿçš„å¼‚å¸¸æ•°ç›®è¶…è¿‡é˜ˆå€¼ä¹‹åä¼šè¿›è¡Œç†”æ–­ã€‚</p><h3 id="_4-7-è§„åˆ™æŒä¹…åŒ–" tabindex="-1"><a class="header-anchor" href="#_4-7-è§„åˆ™æŒä¹…åŒ–" aria-hidden="true">#</a> 4.7. è§„åˆ™æŒä¹…åŒ–</h3><p>æ— è®ºæ˜¯é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼æ¥æ›´æ–°è§„åˆ™ï¼Œè¿˜æ˜¯é€šè¿‡æ¥å…¥ Sentinel Dashboard åï¼Œåœ¨é¡µé¢ä¸Šæ“ä½œæ›´æ–°è§„åˆ™ï¼Œéƒ½æ— æ³•é¿å…ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æœåŠ¡é‡å¯åï¼Œè§„åˆ™å°±ä¸¢å¤±äº†ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹è§„åˆ™æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­çš„ã€‚</p><p>æˆ‘ä»¬åœ¨ Dashboard ä¸Šä¸ºå®¢æˆ·ç«¯é…ç½®å¥½äº†è§„åˆ™ï¼Œå¹¶æ¨é€ç»™äº†å®¢æˆ·ç«¯ã€‚è¿™æ—¶ç”±äºä¸€äº›å› ç´ å®¢æˆ·ç«¯å‡ºç°å¼‚å¸¸ï¼ŒæœåŠ¡ä¸å¯ç”¨äº†ï¼Œå½“å®¢æˆ·ç«¯æ¢å¤æ­£å¸¸å†æ¬¡è¿æ¥ä¸Š Dashboard åï¼Œè¿™æ—¶æ‰€æœ‰çš„è§„åˆ™éƒ½ä¸¢å¤±äº†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é‡æ–°é…ç½®ä¸€éè§„åˆ™ï¼Œè¿™è‚¯å®šä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p><p>æŒä¹…åŒ–é…ç½®åˆ†ä»¥ä¸‹3æ­¥ï¼š</p><ol><li>å¼•å…¥ä¾èµ–</li></ol><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sentinel-datasource-nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>æ·»åŠ é…ç½®ï¼š</li></ol><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">## è¿™é‡Œdatasourceåçš„consumeræ˜¯æ•°æ®æºåç§°ï¼Œå¯ä»¥éšä¾¿å†™ï¼Œæ¨èä½¿ç”¨æœåŠ¡å</span>
<span class="token key attr-name">spring.cloud.sentinel.datasource.consumer.nacos.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">localhost:8848</span>
<span class="token key attr-name">spring.cloud.sentinel.datasource.consumer.nacos.dataId</span><span class="token punctuation">=</span><span class="token value attr-value">${spring.application.name}-sentinel-rules</span>
<span class="token key attr-name">spring.cloud.sentinel.datasource.consumer.nacos.groupId</span><span class="token punctuation">=</span><span class="token value attr-value">SENTINEL_GROUP</span>
<span class="token key attr-name">spring.cloud.sentinel.datasource.consumer.nacos.data-type</span><span class="token punctuation">=</span><span class="token value attr-value">json</span>
<span class="token comment">## è§„åˆ™ç±»å‹ï¼Œå–å€¼è§ï¼šorg.springframework.cloud.alibaba.sentinel.datasource.RuleType</span>
<span class="token key attr-name">spring.cloud.sentinel.datasource.consumer.nacos.rule_type</span><span class="token punctuation">=</span><span class="token value attr-value">flow</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>nacosä¸­åˆ›å»ºæµæ§è§„åˆ™</li></ol><p>é…ç½®å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/hello&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;limitApp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;grade&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;count&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">&quot;strategy&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;controlBehavior&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;clusterMode&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>resourceï¼šèµ„æºåç§°</p><p>limitAppï¼šé™æµåº”ç”¨ï¼Œå°±æ˜¯ç”¨é»˜è®¤å°±å¯ä»¥</p><p>gradeï¼šé˜ˆå€¼ç±»å‹ï¼Œ0è¡¨ç¤ºçº¿ç¨‹æ•°ï¼Œ1è¡¨ç¤ºqps</p><p>countï¼šå•æœºé˜ˆå€¼</p><p>strategyï¼šæµæ§æ¨¡å¼ï¼Œ0-ç›´æ¥ï¼Œ1-å…³è”ï¼Œ 2-é“¾è·¯</p><p>controlBehaviorï¼šæµæ§æ•ˆæœã€‚0-å¿«é€Ÿå¤±è´¥ï¼Œ1-warm up 2-æ’é˜Ÿç­‰å¾…</p><p>clusterModeï¼šæ˜¯å¦é›†ç¾¤</p><p>é‡å¯consumserï¼Œå¹¶å¤šæ¬¡è®¿é—®ï¼š<a href="http://localhost:18080/hi%E3%80%82" target="_blank" rel="noopener noreferrer">http://localhost:18080/hiã€‚<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>æŸ¥çœ‹sentinelå®¢æˆ·ç«¯ï¼šå°±æœ‰äº†é™æµé…ç½®äº†</p><p>ç°åœ¨ä½ å¯ä»¥å°è¯•æµ‹è¯•ä¸€ä¸‹é™æµé…ç½®äº†</p><h3 id="_5ã€ç½‘å…³æµæ§" tabindex="-1"><a class="header-anchor" href="#_5ã€ç½‘å…³æµæ§" aria-hidden="true">#</a> 5ã€ç½‘å…³æµæ§</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-alibaba-sentinel-gateway&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SentinelGatewayConfig</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">SentinelGatewayConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">GatewayCallbackManager</span><span class="token punctuation">.</span><span class="token function">setBlockHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BlockRequestHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//ç½‘å…³é™æµäº†è¯·æ±‚ï¼Œå°±ä¼šè°ƒç”¨æ­¤å›è°ƒ</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServerResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token class-name">R</span> error <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">BizCodeEnum</span><span class="token punctuation">.</span><span class="token constant">TO_MANY_REQUEST</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">BizCodeEnum</span><span class="token punctuation">.</span><span class="token constant">TO_MANY_REQUEST</span><span class="token punctuation">.</span><span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> errorJson <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> <span class="token class-name">ServerResponse</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span>errorJson<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-sleuth" tabindex="-1"><a class="header-anchor" href="#_5-sleuth" aria-hidden="true">#</a> 5. Sleuth</h2><p>â€‹ Spring Cloud Sleuthä¸ºspringCloudå®ç°äº†ä¸€ä¸ªåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªè§£å†³æ–¹æ¡ˆï¼Œå¤§é‡å€Ÿé‰´äº†Dapperï¼ŒZipkinå’ŒHTraceç­‰é“¾è·¯è¿½è¸ªæŠ€æœ¯ã€‚å¯¹äºå¤§å¤šæ•°ç”¨æˆ·è€Œè¨€ï¼ŒSleuthåº”è¯¥æ˜¯ä¸å¯è§çš„ï¼Œå¹¶ä¸”æ‚¨ä¸å¤–éƒ¨ç³»ç»Ÿçš„æ‰€æœ‰äº¤äº’éƒ½åº”è‡ªåŠ¨è¿›è¡Œæ£€æµ‹ã€‚æ‚¨å¯ä»¥ç®€å•åœ°åœ¨æ—¥å¿—ä¸­æ•è·æ•°æ®ï¼Œä¹Ÿå¯ä»¥å°†å…¶å‘é€åˆ°è¿œç¨‹æ”¶é›†å™¨æœåŠ¡ã€‚</p><p>â€‹ éšç€åˆ†å¸ƒå¼ç³»ç»Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œä½ çš„ä¸€ä¸ªè¯·æ±‚å‘è¿‡å‘è¿‡å»ï¼Œå„ä¸ªå¾®æœåŠ¡ä¹‹é—´çš„è·³è½¬ï¼Œæœ‰å¯èƒ½æŸä¸ªè¯·æ±‚æŸä¸€å¤©å‹åŠ›å¤ªå¤§äº†ï¼Œä¸€ä¸ªè¯·æ±‚è¿‡å»æ²¡å“åº”ï¼Œä¸€ä¸ªè¯·æ±‚ä¸‹å»ä¾èµ–äº†ä¸‰å››ä¸ªæœåŠ¡ï¼Œä½†æ˜¯ä½ å»ä¸çŸ¥é“å“ªä¸€ä¸ªæœåŠ¡å‡ºæ¥é—®é¢˜ï¼Œè¿™æ—¶å€™æˆ‘æ˜¯ä¸æ˜¯éœ€è¦å¯¹å¾®æœåŠ¡è¿›è¡Œè¿½è¸ªå‘€ï¼Ÿç›‘æ§ä¸€ä¸ªè¯·æ±‚çš„å‘èµ·ï¼Œä»æœåŠ¡ä¹‹é—´ä¼ é€’ä¹‹é—´çš„è¿‡ç¨‹ï¼Œæˆ‘æœ€å¥½è®°å½•ä¸€ä¸‹ï¼Œè®°å½•æ¯ä¸€ä¸ªçš„è€—æ—¶å¤šä¹…ï¼Œä¸€æ—¦å‡ºäº†é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹æ€§çš„è¿›è¡Œä¼˜åŒ–ï¼Œæ˜¯è¦å¢åŠ èŠ‚ç‚¹ï¼Œå‡è½»å‹åŠ›ï¼Œè¿˜æ˜¯æœåŠ¡ç»§ç»­æ‹†åˆ†ï¼Œè®©é€»è¾‘æ›´åŠ ç®€å•ç‚¹å‘¢ï¼Ÿè¿™æ—¶å€™<strong>springcloud-sleuthé›†æˆzipkin</strong>èƒ½å¸®æˆ‘ä»¬è§£å†³è¿™äº›æœåŠ¡è¿½è¸ªé—®é¢˜ã€‚</p><h3 id="_5-1-zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯" tabindex="-1"><a class="header-anchor" href="#_5-1-zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯" aria-hidden="true">#</a> 5.1. zipkinåˆ†å¸ƒå¼ç›‘æ§å®¢æˆ·ç«¯</h3><p>Zipkinæ˜¯ä¸€ç§åˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿã€‚å®ƒæœ‰åŠ©äºæ”¶é›†è§£å†³å¾®æœåŠ¡æ¶æ„ä¸­çš„å»¶è¿Ÿé—®é¢˜æ‰€éœ€çš„æ—¶åºæ•°æ®ã€‚å®ƒç®¡ç†è¿™äº›æ•°æ®çš„æ”¶é›†å’ŒæŸ¥æ‰¾ã€‚Zipkinçš„è®¾è®¡åŸºäºGoogle Dapperè®ºæ–‡ã€‚åº”ç”¨ç¨‹åºç”¨äºå‘ZipkinæŠ¥å‘Šæ—¶åºæ•°æ®ã€‚Zipkin UIè¿˜æä¾›äº†ä¸€ä¸ªä¾èµ–å…³ç³»å›¾ï¼Œæ˜¾ç¤ºäº†æ¯ä¸ªåº”ç”¨ç¨‹åºé€šè¿‡çš„è·Ÿè¸ªè¯·æ±‚æ•°ã€‚å¦‚æœè¦è§£å†³å»¶è¿Ÿé—®é¢˜æˆ–é”™è¯¯ï¼Œå¯ä»¥æ ¹æ®åº”ç”¨ç¨‹åºï¼Œè·Ÿè¸ªé•¿åº¦ï¼Œæ³¨é‡Šæˆ–æ—¶é—´æˆ³å¯¹æ‰€æœ‰è·Ÿè¸ªè¿›è¡Œç­›é€‰æˆ–æ’åºã€‚é€‰æ‹©è·Ÿè¸ªåï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ¯ä¸ªè·¨åº¦æ‰€éœ€çš„æ€»è·Ÿè¸ªæ—¶é—´ç™¾åˆ†æ¯”ï¼Œä»è€Œå¯ä»¥è¯†åˆ«æœ‰é—®é¢˜çš„åº”ç”¨ç¨‹åºã€‚</p><p>é€šè¿‡dockerå®‰è£…ï¼šdocker run -d -p 9411:9411 openzipkin/zipkin</p><p>é€šè¿‡jaråŒ…å®‰è£…ï¼šjava -jar zipkin-server-*exec.jar</p><p>jaråŒ…ä¸‹è½½åœ°å€ï¼š<a href="https://search.maven.org/remote_content?g=io.zipkin&amp;a=zipkin-server&amp;v=LATEST&amp;c=exec" target="_blank" rel="noopener noreferrer">https://search.maven.org/remote_content?g=io.zipkin&amp;a=zipkin-server&amp;v=LATEST&amp;c=exec<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>è¯¾å‰èµ„æ–™æœ‰å·²ä¸‹è½½çš„jaråŒ…</p><p>åœ¨æµè§ˆå™¨ç«¯è®¿é—®ï¼š<a href="http://localhost:9411" target="_blank" rel="noopener noreferrer">http://localhost:9411<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_5-2-æ”¹é€ consumer-providerå·¥ç¨‹" tabindex="-1"><a class="header-anchor" href="#_5-2-æ”¹é€ consumer-providerå·¥ç¨‹" aria-hidden="true">#</a> 5.2. æ”¹é€ consumer/providerå·¥ç¨‹</h3><p>å¯¹consumerå’Œproviderå·¥ç¨‹åˆ†åˆ«åšå¦‚ä¸‹æ“ä½œï¼š</p><ol><li>å¼•å…¥sleuthçš„ä¾èµ–</li></ol><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-zipkin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>zipkinçš„å¯åŠ¨å™¨åŒ…å«äº†sleuthçš„ä¾èµ–ã€‚</p><ol start="2"><li>é…ç½®zipkinçš„ç›¸å…³ä¿¡æ¯</li></ol><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">## zipkinæœåŠ¡å™¨çš„åœ°å€</span>
<span class="token key attr-name">spring.zipkin.base-url</span><span class="token punctuation">=</span><span class="token value attr-value">http://localhost:9411</span>
<span class="token comment">## å…³é—­æœåŠ¡å‘ç°ï¼Œå¦åˆ™springCloudä¼šæŠŠzipkinçš„urlå½“ä½œæœåŠ¡åç§°</span>
<span class="token key attr-name">spring.zipkin.discovery-client-enabled</span><span class="token punctuation">=</span><span class="token value attr-value">false</span>
<span class="token comment">## æ•°æ®å‘é€çš„æ–¹å¼ï¼šACTIVEMQ RABBIT KAFKA WEB</span>
<span class="token key attr-name">spring.zipkin.sender.type</span><span class="token punctuation">=</span><span class="token value attr-value">web</span>
<span class="token comment">## è®¾ç½®æŠ½æ ·é‡‡é›†ç‡ï¼Œé»˜è®¤0.1ï¼ˆå³10%ï¼‰ï¼Œè¿™é‡Œè®¾ç½®ä¸º100%</span>
<span class="token key attr-name">spring.sleuth.sampler.probability</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>é‡å¯consumer/provideræœåŠ¡åï¼Œè®¿é—®æ¶ˆè´¹è€…ï¼š<a href="http://localhost:18080/hi%E3%80%82%E6%9F%A5%E7%9C%8Bzipkin%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%A6%82%E4%B8%8B" target="_blank" rel="noopener noreferrer">http://localhost:18080/hiã€‚æŸ¥çœ‹zipkinå®¢æˆ·ç«¯å¦‚ä¸‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ol><p>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨zipkinçš„uiæ§åˆ¶ç•Œé¢çœ‹çœ‹æ•ˆæœï¼Œå¯ä»¥å‘ç°ï¼ŒæœåŠ¡ä¹‹é—´çš„è°ƒç”¨å…³ç³»ï¼ŒæœåŠ¡åç§°å·²ç»æ¸…æ™°å±•ç°å‡ºæ¥äº†ï¼ŒåŒæ—¶åŒ…æ‹¬æœåŠ¡ä¹‹é—´çš„è°ƒç”¨æ—¶å¸¸ç­‰è¯¦ç»†ä¿¡æ¯ä»¥åŠæ›´ç»†çš„ä¿¡æ¯éƒ½å¯ä»¥é€šè¿‡æ§åˆ¶å°çœ‹åˆ°ã€‚</p><p>è¿˜å¯ä»¥æŸ¥çœ‹è°ƒç”¨å…³ç³»å›¾ï¼š</p><h3 id="_5-3-åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_5-3-åŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> 5.3. åŸºæœ¬æ¦‚å¿µ</h3><p>Spanï¼šåŸºæœ¬å·¥ä½œå•å…ƒã€‚å‘é€ä¸€ä¸ªè¿œç¨‹è¯·æ±‚å°±ä¼šäº§ç”Ÿä¸€ä¸ªspanï¼Œspané€šè¿‡ä¸€ä¸ª64ä½IDå”¯ä¸€æ ‡è¯†ï¼Œtraceä»¥å¦ä¸€ä¸ª64ä½IDè¡¨ç¤ºï¼Œspanè¿˜æœ‰å…¶ä»–æ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚æ‘˜è¦ã€æ—¶é—´æˆ³äº‹ä»¶ã€å…³é”®å€¼æ³¨é‡Š(tags)ã€spançš„IDã€ä»¥åŠè¿›åº¦ID(é€šå¸¸æ˜¯IPåœ°å€)ã€‚spanåœ¨ä¸æ–­çš„å¯åŠ¨å’Œåœæ­¢ï¼ŒåŒæ—¶è®°å½•äº†æ—¶é—´ä¿¡æ¯ï¼Œå½“ä½ åˆ›å»ºäº†ä¸€ä¸ªspanï¼Œä½ å¿…é¡»åœ¨æœªæ¥çš„æŸä¸ªæ—¶åˆ»åœæ­¢å®ƒã€‚</p><p>Traceï¼šä¸€ç³»åˆ—spansç»„æˆçš„ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚ä¾‹å¦‚ï¼šå‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œéœ€è¦è°ƒç”¨å¤šä¸ªå¾®æœåŠ¡ï¼Œæ¯è°ƒç”¨ä¸€ä¸ªå¾®æœåŠ¡éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªspanï¼Œè¿™äº›spanç»„æˆä¸€ä¸ªtrace</p><p>Annotationï¼šç”¨æ¥åŠæ—¶è®°å½•ä¸€ä¸ªäº‹ä»¶çš„å­˜åœ¨ï¼Œä¸€äº›æ ¸å¿ƒannotationsç”¨æ¥å®šä¹‰ä¸€ä¸ªè¯·æ±‚çš„å¼€å§‹å’Œç»“æŸ</p><ul><li>cs - Client Sent -å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªannotionæè¿°äº†è¿™ä¸ªspançš„å¼€å§‹</li><li>sr - Server Received -æœåŠ¡ç«¯è·å¾—è¯·æ±‚å¹¶å‡†å¤‡å¼€å§‹å¤„ç†å®ƒï¼Œå¦‚æœå°†å…¶srå‡å»csæ—¶é—´æˆ³ä¾¿å¯å¾—åˆ°ç½‘ç»œå»¶è¿Ÿ</li><li>ss - Server Sent -æ³¨è§£è¡¨æ˜è¯·æ±‚å¤„ç†çš„å®Œæˆ(å½“è¯·æ±‚è¿”å›å®¢æˆ·ç«¯)ï¼Œå¦‚æœsså‡å»sræ—¶é—´æˆ³ä¾¿å¯å¾—åˆ°æœåŠ¡ç«¯éœ€è¦çš„å¤„ç†è¯·æ±‚æ—¶é—´</li><li>cr - Client Received -è¡¨æ˜spançš„ç»“æŸï¼Œå®¢æˆ·ç«¯æˆåŠŸæ¥æ”¶åˆ°æœåŠ¡ç«¯çš„å›å¤ï¼Œå¦‚æœcrå‡å»csæ—¶é—´æˆ³ä¾¿å¯å¾—åˆ°å®¢æˆ·ç«¯ä»æœåŠ¡ç«¯è·å–å›å¤çš„æ‰€æœ‰æ‰€éœ€æ—¶é—´</li></ul><p>ä¾‹å¦‚ä¸€ä¸ªè¯·æ±‚å¦‚ä¸‹ï¼š</p><p>ä½¿ç”¨zipkinè·Ÿè¸ªæ•´ä¸ªè¯·æ±‚è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>ä¸Šå›¾è¡¨ç¤ºä¸€è¯·æ±‚é“¾è·¯ï¼Œä¸€æ¡é“¾è·¯é€šè¿‡<code>Trace Id</code>å”¯ä¸€æ ‡è¯†ï¼Œ<code>Span</code>æ ‡è¯†å‘èµ·çš„è¯·æ±‚ä¿¡æ¯ï¼Œå„<code>span</code>é€šè¿‡<code>parent id</code> å…³è”èµ·æ¥ï¼Œå¦‚å›¾</p><h2 id="_6ã€sleuth-zipkin" tabindex="-1"><a class="header-anchor" href="#_6ã€sleuth-zipkin" aria-hidden="true">#</a> 6ã€sleuth+zipkin</h2><h3 id="_1ã€ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_1ã€ä»‹ç»" aria-hidden="true">#</a> 1ã€ä»‹ç»</h3><p><strong>Spanï¼ˆè·¨åº¦ï¼‰</strong>ï¼šåŸºæœ¬å·¥ä½œå•å…ƒï¼Œå‘é€ä¸€ä¸ªè¿œç¨‹è°ƒåº¦ä»»åŠ¡å°±ä¼šäº§ç”Ÿä¸€ä¸ª Spanï¼ŒSpanæ˜¯ä¸€ä¸ª64ä½IDå”¯ä¸€æ ‡è¯†çš„,Traceæ˜¯ç”¨å¦ä¸€ä¸ª64ä½IDå”¯ä¸€æ ‡è¯†çš„,Spanè¿˜æœ‰å…¶ä»–æ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚æ‘˜è¦ã€æ—¶é—´æˆ³äº‹ä»¶ã€Span çš„ IDã€ä»¥åŠè¿›åº¦ IDã€‚</p><p><strong>Trace(è·Ÿè¸ª)</strong>ï¼šä¸€ç³»åˆ— Spanç»„æˆçš„ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚è¯·æ±‚ä¸€ä¸ªå¾®æœåŠ¡ç³»ç»Ÿçš„APIæ¥å£ï¼Œè¿™ä¸ªAPIæ¥å£,éœ€è¦è°ƒç”¨å¤šä¸ªå¾®æœåŠ¡ï¼Œè°ƒç”¨æ¯ä¸ªå¾®æœåŠ¡éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ Spanï¼Œæ‰€æœ‰ç”±è¿™ä¸ªè¯·æ±‚äº§ç”Ÿçš„ Spanç»„æˆäº†è¿™ä¸ªTraceã€‚</p><p><strong>Annotation(æ ‡æ³¨)</strong>ï¼šç”¨æ¥åŠæ—¶è®°å½•ä¸€ä¸ªäº‹ä»¶çš„ï¼Œä¸€äº›æ ¸å¿ƒæ³¨è§£ç”¨æ¥å®šä¹‰ä¸€ä¸ªè¯·æ±‚çš„å¼€å§‹å’Œç»“æŸã€‚è¿™äº›æ³¨è§£åŒ…æ‹¬ä»¥ä¸‹:</p><p><code>**cs** - Client Sent-å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªæ³¨è§£æè¿°äº†è¿™ä¸ª Span çš„å¼€å§‹ **sr** - Server Received -æœåŠ¡ç«¯è·å¾—è¯·æ±‚å¹¶å‡†å¤‡å¼€å§‹å¤„ç†å®ƒ,å¦‚æœå°†å…¶så‡å»csæ—¶é—´æˆ³ä¾¿å¯å¾—åˆ°ç½‘ç»œä¼ è¾“çš„æ—¶é—´ã€‚ **sr** - Server Sentï¼ˆæœåŠ¡ç«¯å‘é€å“åº”ï¼‰-è¯¥æ³¨è§£è¡¨æ˜è¯·æ±‚å¤„ç†çš„å®Œæˆ(å½“è¯·æ±‚è¿”å›å®¢æˆ·ç«¯),å¦‚æœ ssçš„æ—¶é—´æˆ³å‡å»sæ—¶é—´é»˜ï¼Œå°±å¯ä»¥å¾—åˆ°æœåŠ¡å™¨è¯·æ±‚çš„æ—¶é—´ã€‚ **cr** - Client Received(å®¢æˆ·ç«¯æ¥æ”¶å“åº”ï¼‰-æ­¤æ—¶Spançš„ç»“æŸï¼Œå¦‚æœc,çš„æ—¶é—´æˆ³å‡å»csæ—¶é—´è·µä¾¿å¯ä»¥å¾—åˆ°æ•´ä¸ªè¯·æ±‚æ‰€æ¶ˆè€—çš„æ—¶é—´ã€‚</code></p><h3 id="_2ã€é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2ã€é…ç½®" aria-hidden="true">#</a> 2ã€é…ç½®</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-sleuth&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>logging.level.org.springframework.cloud.openfeign=debug
logging.level.org.springframework.cloud.sleuth=debug
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3ã€zipkinå¯è§†åŒ–" tabindex="-1"><a class="header-anchor" href="#_3ã€zipkinå¯è§†åŒ–" aria-hidden="true">#</a> 3ã€zipkinå¯è§†åŒ–</h3><p>docker pull openzipkin/zipkin:latest</p><p>docker run -d --name=zipkin -p 9411:9411 openzipkin/zipkin:latest</p><p><a href="http://127.0.0.1:9411/" target="_blank" rel="noopener noreferrer">http://127.0.0.1:9411/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-zipkin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">#æœåŠ¡è¿½è¸ª</span>
<span class="token key attr-name">spring.zipkin.base-url</span><span class="token punctuation">=</span><span class="token value attr-value">http://192.168.101.7:9411/</span>
<span class="token comment">#å…³é—­æœåŠ¡å‘ç°</span>
<span class="token key attr-name">spring.zipkin.discovery-client-enabled</span><span class="token punctuation">=</span><span class="token value attr-value">false</span>
<span class="token key attr-name">spring.zipkin.sender.type</span><span class="token punctuation">=</span><span class="token value attr-value">web</span>
<span class="token comment">#é…ç½®é‡‡æ ·å™¨</span>
<span class="token key attr-name">spring.sleuth.sampler.probability</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨é¡¹ç›®ï¼Œ<a href="http://127.0.0.1:9411/" target="_blank" rel="noopener noreferrer">http://127.0.0.1:9411/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_4ã€zipkin-æ•°æ®ä¿å­˜es" tabindex="-1"><a class="header-anchor" href="#_4ã€zipkin-æ•°æ®ä¿å­˜es" aria-hidden="true">#</a> 4ã€zipkin æ•°æ®ä¿å­˜ES</h3><p>docker pull openzipkin/zipkin-dependencies:latest</p><p>docker run --env STORAGE_TYPE=elasticsearch --env ES_HOSTS=127.0.0.1:9200 openzipkin/zipkin-dependencies:latest</p><p>docker run --name=zipkin_dependencies --env STORAGE_TYPE=elasticsearch --env ES_HOSTS=127.0.0.1:9200 openzipkin/zipkin-dependencies:latest</p><p><img src="/assets/true-image-20211118192950674-fb4933f6.png" alt="image-20211118192950674"></p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/topjf/topjf/edit/main/docs/java/nacos-gateway-sentinel-sleuth.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: topjfk@163.com">jinfang</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/java/jvm.html" class="nav-link prev" aria-label="jvm"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon iconfont icon-edit" style=""></span>jvm</div></a><a href="/java/nacos-note.html" class="nav-link next" aria-label="Nacosç¬”è®°"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">Nacosç¬”è®°<span class="font-icon icon iconfont icon-edit" style=""></span></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"></div><div class="copyright">Copyright Â© 2023 topjf</div></footer></div><!--]--><!--]--><!----><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-30d3d221.js" defer></script>
  </body>
</html>
